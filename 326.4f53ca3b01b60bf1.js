"use strict";(self.webpackChunkbase_test=self.webpackChunkbase_test||[]).push([[326],{4326:(bs,me,P)=>{P.r(me),P.d(me,{TestGridModule:()=>Ge});var Q=P(177),n=P(483),le=P(8550),I=P(4438),Ae=P(8245);const Pe=n.iI.forChild([{path:"",component:(()=>{class D extends le.PJ{constructor(){super()}getEventGrid(O){}hookObservables(){}ngOnInit(){super.ngOnInit()}ngAfterViewInit(){super.ngAfterViewInit()}ngOnDestroy(){super.ngOnDestroy()}static{this.\u0275fac=function(H){return new(H||D)}}static{this.\u0275cmp=I.VBU({type:D,selectors:[["GridView"]],features:[I.Jv_([]),I.Vt3],decls:4,vars:0,template:function(H,ct){1&H&&(I.j41(0,"h1"),I.EFF(1,"Grid features - Test."),I.k0s(),I.nrm(2,"ul")(3,"BasicGrid"))},dependencies:[Ae.p],changeDetection:0})}}return D})()}]);let Ee=(()=>{class D extends le.of{constructor(O){super(),this.errorHelper=O}destroy(){}handleInitializionError(O){this.errorHelper.displayError(O)}hookObservables(){}static{this.\u0275fac=function(H){return new(H||D)(I.KVO(le.V_))}}static{this.\u0275prov=I.jDH({token:D,factory:D.\u0275fac})}}return D})();var Te=P(928),De=P(6160);let Ge=(()=>{class D{static{this.\u0275fac=function(H){return new(H||D)}}static{this.\u0275mod=I.$C({type:D})}static{this.\u0275inj=I.G2t({providers:[Ee],imports:[Q.MD,Pe,Te.G,De.$V]})}}return D})()},8245:(bs,me,P)=>{P.d(me,{p:()=>ud});var Q=P(3117),n=P(7137),Ae=class{constructor(e,t,s,i,r,o){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=t,this.eventService=s,this.funcColsService=i,this.beans=o,this.selectionService=r,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id="ROOT_NODE_ID",this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return(0,n.gpM)(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"==typeof e)return void(0,n.JT7)("rowData must be an array.");this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,s=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map((i,r)=>this.createNode(i,this.rootNode,0,r)):(t.allLeafChildren=[],t.childrenAfterGroup=[]),s&&(s.childrenAfterFilter=t.childrenAfterFilter,s.childrenAfterGroup=t.childrenAfterGroup,s.childrenAfterAggFilter=t.childrenAfterAggFilter,s.childrenAfterSort=t.childrenAfterSort,s.childrenMapped=t.childrenMapped,s.allLeafChildren=t.allLeafChildren)}updateRowData(e){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const t={rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},s=[];return this.executeRemove(e,t,s),this.executeUpdate(e,t,s),this.executeAdd(e,t),this.updateSelection(s,"rowDataChanged"),t}updateRowOrderFromRowData(e){const t=this.rootNode.allLeafChildren,s=t?.length??0,i=new Map;let r=-1,o=-1;for(let l=0;l<s;++l){const a=t[l],d=a.data;d!==e[l]&&(o<0&&(r=l),o=l,i.set(d,a))}if(r<0)return!1;for(let l=r;l<=o;++l){const a=i.get(e[l]);void 0!==a&&(t[l]=a,a.sourceRowIndex=l)}return!0}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){this.eventService.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}updateSelection(e,t){const s=e.length>0;s&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),s&&this.eventService.dispatchEvent({type:"selectionChanged",source:t})}executeAdd(e,t){const s=e.add;if((0,n.Wgl)(s))return;const i=this.rootNode.allLeafChildren;let r=i.length;if("number"==typeof e.addIndex&&(r=this.sanitizeAddIndex(e.addIndex),r>0&&this.gos.get("treeData")))for(let d=0;d<i.length;d++)if(i[d]?.rowIndex==r-1){r=d+1;break}const o=s.map((a,d)=>this.createNode(a,this.rootNode,0,r+d));if(r<i.length){const a=i.slice(0,r),d=i.slice(r,i.length),u=a.length+o.length;for(let h=0,c=d.length;h<c;++h)d[h].sourceRowIndex=u+h;this.rootNode.allLeafChildren=[...a,...o,...d],t.rowsInserted=!0}else this.rootNode.allLeafChildren=i.concat(o);const l=this.rootNode.sibling;l&&(l.allLeafChildren=i),t.rowNodeTransaction.add=o}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}executeRemove(e,{rowNodeTransaction:t},s){const{remove:i}=e;if((0,n.Wgl)(i))return;const r={};i.forEach(l=>{const a=this.lookupRowNode(l);a&&(a.isSelected()&&s.push(a),a.clearRowTopAndRowIndex(),r[a.id]=!0,delete this.allNodesMap[a.id],t.remove.push(a))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren?.filter(l=>!r[l.id])??null,this.rootNode.allLeafChildren?.forEach((l,a)=>{l.sourceRowIndex=a});const o=this.rootNode.sibling;o&&(o.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,{rowNodeTransaction:t},s){const{update:i}=e;(0,n.Wgl)(i)||i.forEach(r=>{const o=this.lookupRowNode(r);o&&(o.updateData(r),!o.selectable&&o.isSelected()&&s.push(o),this.setMasterForRow(o,r,0,!1),t.update.push(o))})}lookupRowNode(e){const t=(0,n.En5)(this.gos);let s;if(t){const i=t({data:e,level:0});if(s=this.allNodesMap[i],!s)return(0,n.D1O)(`could not find row id=${i}, data item was not found for this id`),null}else if(s=this.rootNode.allLeafChildren?.find(i=>i.data===e),!s)return(0,n.D1O)("could not find data item as object was not found",e),(0,n.D1O)("Consider using getRowId to help the Grid find matching row data"),null;return s||null}createNode(e,t,s,i){const r=new n.TUE(this.beans);return r.sourceRowIndex=i,r.group=!1,this.setMasterForRow(r,e,s,!0),t&&(r.parent=t),r.level=s,r.setDataAndId(e,this.nextId.toString()),this.allNodesMap[r.id]&&(0,n.JT7)(`duplicate node id '${r.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[r.id]=r,this.nextId++,r}setMasterForRow(e,t,s,i){if(this.gos.get("treeData"))e.setMaster(!1),i&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const l=this.gos.get("isRowMaster");e.setMaster(!l||l(t))}else e.setMaster(!1);if(i){const l=this.funcColsService.getRowGroupColumns();e.expanded=!!e.master&&this.isExpanded(s+(l?l.length:0))}}}isExpanded(e){const t=this.gos.get("groupDefaultExpanded");return-1===t||e<t}},Ie="32.3.3",ht=(0,n.n9N)({version:Ie,moduleName:`${n.zsj.ClientSideRowModelModule}-core`,rowModel:"clientSide",beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="rowModel",this.onRowHeightChanged_debounced=(0,n.pkA)(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.selectionService=e.selectionService,this.valueCache=e.valueCache,this.environment=e.environment,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggregationStage=e.aggregationStage,this.pivotStage=e.pivotStage,this.filterAggregatesStage=e.filterAggregatesStage}postConstruct(){const e=this.refreshModel.bind(this,{step:n.zOQ.EVERYTHING}),t=!this.gos.get("suppressAnimationFrame"),s=this.refreshModel.bind(this,{step:n.zOQ.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedEventListeners({newColumnsLoaded:s,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:n.zOQ.PIVOT}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new n.TUE(this.beans),this.nodeManager=new Ae(this.rootNode,this.gos,this.eventService,this.funcColsService,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),s=new Set(["excludeChildrenWhenTreeDataFiltering"]),i=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),r=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),o=new Set(["postSortRows","groupDisplayType","accentedSort"]),l=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),d=[...e,...t,...s,...i,...i,...r,...o,...l,...a];this.addManagedPropertyListeners(d,u=>{const h=u.changeSet?.properties;if(!h)return;const c=p=>h.some(g=>p.has(g));c(e)?this.setRowData(this.rootNode.allLeafChildren.map(p=>p.data)):c(t)?this.refreshModel({step:n.zOQ.EVERYTHING}):c(s)?this.refreshModel({step:n.zOQ.FILTER}):c(i)?this.refreshModel({step:n.zOQ.PIVOT}):c(r)?this.refreshModel({step:n.zOQ.AGGREGATE}):c(o)?this.refreshModel({step:n.zOQ.SORT}):c(l)?this.refreshModel({step:n.zOQ.FILTER_AGGREGATES}):c(a)&&this.refreshModel({step:n.zOQ.MAP})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,s,i){let r,o=!1;do{r=!1;const l=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),d=Math.max(l,s),u=Math.min(a,i);for(let h=d;h<=u;h++){const c=this.getRow(h);if(c.rowHeightEstimated){const p=(0,n.Syv)(this.gos,c);c.setRowHeight(p.height),r=!0,o=!0}}r&&this.setRowTopAndRowIndex()}while(r);return o}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const s=new Set,i=(0,n.yy7)(this.gos,"normal");for(let r=0;r<this.rowsToDisplay.length;r++){const o=this.rowsToDisplay[r];if(null!=o.id&&s.add(o.id),null==o.rowHeight){const l=(0,n.Syv)(this.gos,o,i,e);o.setRowHeight(l.height,l.estimated)}o.setRowTop(t),o.setRowIndex(r),t+=o.rowHeight}return s}clearRowTopAndRowIndex(e,t){const s=e.isActive(),i=o=>{o&&null!=o.id&&!t.has(o.id)&&o.clearRowTopAndRowIndex()},r=o=>{i(o),i(o.detailNode),i(o.sibling),o.hasChildren()&&o.childrenAfterGroup&&(s&&-1!=o.level&&!o.expanded||o.childrenAfterGroup.forEach(r))};r(this.rootNode)}ensureRowsAtPixel(e,t,s=0){const i=this.getRowIndexAtPixel(t),r=this.getRow(i),o=!this.gos.get("suppressAnimationFrame");if(r===e[0])return!1;const l=this.rootNode.allLeafChildren;return e.forEach(a=>{(0,n.$ii)(l,a)}),e.forEach((a,d)=>{(0,n.WFh)(l,a,Math.max(i+s,0)+d)}),e.forEach((a,d)=>{a.sourceRowIndex=d}),this.refreshModel({step:n.zOQ.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:o,rowNodesOrderChanged:!0}),!0}highlightRowAtPixel(e,t){const s=null!=t?this.getRowIndexAtPixel(t):null,i=null!=s?this.getRow(s):null;if(!i||!e||null==t)return void this.clearHighlightedRow();const r=this.getHighlightPosition(t,i),o=this.isHighlightingCurrentPosition(e,i,r);(o||null!=this.lastHighlightedRow&&this.lastHighlightedRow!==i)&&(this.clearHighlightedRow(),o)||(i.setHighlighted(r),this.lastHighlightedRow=i)}getHighlightPosition(e,t){if(!t){const r=this.getRowIndexAtPixel(e);if(!(t=this.getRow(r||0)))return n.m5s.Below}const{rowTop:s,rowHeight:i}=t;return e-s<i/2?n.m5s.Above:n.m5s.Below}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,s){return e===t||this.getRow(t.rowIndex+(s===n.m5s.Above?-1:1))===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(0===this.rowsToDisplay.length)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const t=this.rootNode.childrenAfterAggFilter;return(t?t.length:0)+(this.rootNode.sibling?1:0)}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let s=e;if(this.rowsToDisplay[0].footer){if(0===e)return 0;s-=1}const i=this.rowsToDisplay[this.rowsToDisplay.length-1];if(i.footer&&s>=this.rootNode.childrenAfterSort.length)return i.rowIndex;let o=this.rootNode.childrenAfterSort[s];if(this.gos.get("groupHideOpenParents"))for(;o.expanded&&o.childrenAfterSort&&o.childrenAfterSort.length>0;)o=o.childrenAfterSort[0];return o.rowIndex}getRowBounds(e){if((0,n.MWY)(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=(0,n.WkG)(this.gos);this.refreshModel({step:n.zOQ.MAP,keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=(0,n.WkG)(this.gos),i=0===e.columns.length||e.columns.some(r=>r.isPrimary())?n.zOQ.FILTER:n.zOQ.FILTER_AGGREGATES;this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=(0,n.WkG)(this.gos);this.refreshModel({step:n.zOQ.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:n.zOQ.PIVOT}):this.refreshModel({step:n.zOQ.AGGREGATE})}createChangePath(e){const t=(0,n.Wgl)(e),s=new n.k$d(!1,this.rootNode);return t&&s.setInactive(),s}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction")||null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter(i=>null!=i.add&&i.add.length>0||null!=i.remove&&i.remove.length>0);return null==t||0==t.length}buildRefreshModelParams(e){let t=n.zOQ.EVERYTHING;const s={everything:n.zOQ.EVERYTHING,group:n.zOQ.EVERYTHING,filter:n.zOQ.FILTER,map:n.zOQ.MAP,aggregate:n.zOQ.AGGREGATE,filter_aggregates:n.zOQ.FILTER_AGGREGATES,sort:n.zOQ.SORT,pivot:n.zOQ.PIVOT,nothing:n.zOQ.NOTHING};if((0,n.Qmv)(e)&&(t=s[e]),!(0,n.MWY)(t))return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gos.get("suppressAnimationFrame")};(0,n.D1O)(`invalid step ${e}, available steps are ${Object.keys(s).join(", ")}`)}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.isChangeEventsDispatching())return;const t="object"==typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t||this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const s=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case n.zOQ.EVERYTHING:this.doRowGrouping(t.rowNodeTransactions,s,!!t.rowNodesOrderChanged,!!t.afterColumnsChanged);case n.zOQ.FILTER:this.doFilter(s);case n.zOQ.PIVOT:this.doPivot(s);case n.zOQ.AGGREGATE:this.doAggregate(s);case n.zOQ.FILTER_AGGREGATES:this.doFilterAggregates(s);case n.zOQ.SORT:this.doSort(t.rowNodeTransactions,s);case n.zOQ.MAP:this.doRowsToDisplay()}const i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(s,i),this.isRefreshingModel=!1,this.eventService.dispatchEvent({type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack})}isEmpty(){const e=(0,n.MWY)(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return(0,n.MWY)(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return(0,n.Qmv)(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let s=!1,i=!1;const r=[],o=(0,n.wEz)(this.gos);return this.forEachNodeAfterFilterAndSort(l=>{if(!i)if(s&&(l===t||l===e)&&(i=!0,l.group&&o))r.push(...l.allLeafChildren);else{if(!s){if(l!==t&&l!==e)return;s=!0}l.group&&o||r.push(l)}}),r}setDatasource(e){(0,n.D1O)("should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let t=0,s=this.rowsToDisplay.length-1;if(e<=0)return 0;if((0,n.GXs)(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let r=-1,o=-1;for(;;){const l=Math.floor((t+s)/2),a=this.rowsToDisplay[l];if(this.isRowInPixel(a,e)||(a.rowTop<e?t=l+1:a.rowTop>e&&(s=l-1),r===t&&o===s))return l;r=t,o=s}}isRowInPixel(e,t){return e.rowTop<=t&&e.rowTop+e.rowHeight>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((t,s)=>e(t,s))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:s,recursionType:i,includeFooterNodes:r}=e;let{index:o}=e;const l=a=>{const d=t[0]?.parent;if(!d)return;const u=r&&(0,n.UcN)(this.gos),h=(0,n.MPk)(this.gos),c=r&&h({node:d});d!==this.rootNode?c===a&&(d.createFooter(),s(d.sibling,o++)):u===a&&(d.createFooter(),s(d.sibling,o++))};l("top");for(let a=0;a<t.length;a++){const d=t[a];if(s(d,o++),d.hasChildren()&&!d.footer){let u=null;switch(i){case 0:u=d.childrenAfterGroup;break;case 1:u=d.childrenAfterAggFilter;break;case 2:u=d.childrenAfterSort;break;case 3:u=d.leafGroup?null:d.childrenAfterSort}u&&(o=this.recursivelyWalkNodesAndCallback({nodes:[...u],callback:s,recursionType:i,index:o,includeFooterNodes:r}))}}return l("bottom"),o}doAggregate(e){this.aggregationStage?.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),s=this.columnModel.isPivotActive(),i=r=>{r&&r.forEach(o=>{const l=()=>{o.expanded=e,i(o.childrenAfterGroup)};t?(0,n.Qmv)(o.childrenAfterGroup)&&l():s?!o.leafGroup&&l():o.group&&l()})};this.rootNode&&i(this.rootNode.childrenAfterGroup),this.refreshModel({step:n.zOQ.MAP}),this.eventService.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,s,i){if(this.groupStage)this.groupStage.execute(e?{rowNode:this.rootNode,rowNodeTransactions:e,rowNodesOrderChanged:s,changedPath:t}:{rowNode:this.rootNode,changedPath:t,afterColumnsChanged:i}),(0,n.wEz)(this.gos)&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",t)&&this.eventService.dispatchEvent({type:"selectionChanged",source:"rowGroupChanged"});else{const r=this.rootNode,o=r.sibling;r.childrenAfterGroup=r.allLeafChildren,o&&(o.childrenAfterGroup=r.childrenAfterGroup),this.rootNode.updateHasChildren()}this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getNodeManager(){return this.nodeManager}getRowNode(e){if("string"==typeof e&&0==e.indexOf(n.TUE.ID_PREFIX_ROW_GROUP)){let s;return this.forEachNode(i=>{i.id===e&&(s=i)}),s}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:n.zOQ.EVERYTHING,newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const s=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.isAlive()&&this.executeBatchUpdateRowData()},s)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let s=!1;this.rowDataTransactionBatch?.forEach(i=>{const{rowNodeTransaction:r,rowsInserted:o}=this.nodeManager.updateRowData(i.rowDataTransaction);o&&(s=!0),t.push(r),i.callback&&e.push(i.callback.bind(null,r))}),this.commonUpdateRowData(t,s),e.length>0&&window.setTimeout(()=>{e.forEach(i=>i())},0),t.length>0&&this.eventService.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache.onDataChanged();const{rowNodeTransaction:t,rowsInserted:s}=this.nodeManager.updateRowData(e);return this.commonUpdateRowData([t],s),t}afterImmutableDataChange(e,t){this.commonUpdateRowData([e],t)}commonUpdateRowData(e,t){if(!this.hasStarted)return;const s=!this.gos.get("suppressAnimationFrame");this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:n.zOQ.EVERYTHING,rowNodeTransactions:e,rowNodesOrderChanged:t,keepRenderedRows:!0,keepEditingRows:!0,animate:s})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:n.zOQ.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const s=t.detailNode;s&&s.setRowHeight(s.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.columnModel.isAutoRowHeightActive())return;this.resetRowHeights()}}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow()}},class extends n.XQb{constructor(){super(...arguments),this.beanName="filterStage"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const s=(i,r)=>{i.childrenAfterFilter=i.hasChildren()&&e&&!r?i.childrenAfterGroup.filter(o=>{const l=o.childrenAfterFilter&&o.childrenAfterFilter.length>0,a=o.data&&this.filterManager.doesRowPassFilter({rowNode:o});return l||a}):i.childrenAfterGroup,i.sibling&&(i.sibling.childrenAfterFilter=i.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const i=(o,l)=>{if(o.childrenAfterGroup)for(let a=0;a<o.childrenAfterGroup.length;a++){const d=o.childrenAfterGroup[a],u=l||this.filterManager.doesRowPassFilter({rowNode:d});d.childrenAfterGroup?i(o.childrenAfterGroup[a],u):s(d,u)}s(o,l)};t.executeFromRootNode(o=>i(o,!1))}else t.forEachChangedNodeDepthFirst(r=>s(r,!1),!0)}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},class extends n.XQb{constructor(){super(...arguments),this.beanName="sortStage"}wireBeans(e){this.sortService=e.sortService,this.sortController=e.sortController}execute(e){const t=this.sortController.getSortOptions(),s=(0,n.Qmv)(t)&&t.length>0,i=s&&(0,n.Qmv)(e.rowNodeTransactions)&&this.gos.get("deltaSort"),r=t.some(o=>(0,n.hnU)(this.gos)?o.column.isPrimary()&&o.column.isRowGroupActive():!!o.column.getColDef().showRowGroup);this.sortService.sort(t,s,i,e.rowNodeTransactions,e.changedPath,r)}},class extends n.XQb{constructor(){super(...arguments),this.beanName="flattenStage"}wireBeans(e){this.beans=e,this.columnModel=e.columnModel}execute(e){const t=e.rowNode,s=[],i=this.columnModel.isPivotMode(),r=i&&t.leafGroup,o=r?[t]:t.childrenAfterSort,l=this.getFlattenDetails();return this.recursivelyAddToRowsToDisplay(l,o,s,i,0),!r&&s.length>0&&l.grandTotalRow&&(t.createFooter(),this.addRowNodeToRowsToDisplay(l,t.sibling,s,0,"top"===l.grandTotalRow)),s}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:(0,n.Njs)(this.gos),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:(0,n.UcN)(this.gos),groupTotalRow:(0,n.MPk)(this.gos)}}recursivelyAddToRowsToDisplay(e,t,s,i,r){if(!(0,n.Wgl)(t))for(let o=0;o<t.length;o++){const l=t[o],a=l.hasChildren(),u=e.groupRemoveSingleChildren&&a&&1===l.childrenAfterGroup.length,h=e.groupRemoveLowestSingleChildren&&a&&l.leafGroup&&1===l.childrenAfterGroup.length;if(!(i&&!a)&&!(e.hideOpenParents&&l.expanded&&!l.master&&(!i||!l.leafGroup))&&!u&&!h&&this.addRowNodeToRowsToDisplay(e,l,s,r),!i||!l.leafGroup)if(a){const f=u||h;if(l.expanded||f){const v=e.groupTotalRow({node:l});v||l.destroyFooter();const y=f?r:r+1;"top"===v&&(l.createFooter(),this.addRowNodeToRowsToDisplay(e,l.sibling,s,y)),this.recursivelyAddToRowsToDisplay(e,l.childrenAfterSort,s,i,y),"bottom"===v&&(l.createFooter(),this.addRowNodeToRowsToDisplay(e,l.sibling,s,y))}}else if(l.master&&l.expanded){const f=this.createDetailNode(l);this.addRowNodeToRowsToDisplay(e,f,s,r)}}}addRowNodeToRowsToDisplay(e,t,s,i,r){r?s.unshift(t):s.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:i)}createDetailNode(e){if((0,n.Qmv)(e.detailNode))return e.detailNode;const t=new n.TUE(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,(0,n.Qmv)(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}},class extends n.XQb{constructor(){super(...arguments),this.beanName="sortService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.rowNodeSorter=e.rowNodeSorter,this.showRowGroupColsService=e.showRowGroupColsService}sort(e,t,s,i,r,o){const l=this.gos.get("groupMaintainOrder"),a=this.columnModel.getCols().some(p=>p.isRowGroupActive());let d={};s&&i&&(d=this.calculateDirtyNodes(i));const u=this.columnModel.isPivotMode(),h=this.gos.getCallback("postSortRows");r&&r.forEachChangedNodeDepthFirst(p=>{this.pullDownGroupDataForHideOpenParents(p.childrenAfterAggFilter,!0);const g=u&&p.leafGroup;if(l&&a&&!p.leafGroup&&!o){const y=null===this.funcColsService.getRowGroupColumns()?.[p.level+1]?.getSort(),C=p.childrenAfterAggFilter.slice(0);if(p.childrenAfterSort&&!y){const S={};p.childrenAfterSort.forEach((w,x)=>{S[w.id]=x}),C.sort((w,x)=>(S[w.id]??0)-(S[x.id]??0))}p.childrenAfterSort=C}else p.childrenAfterSort=!t||g?p.childrenAfterAggFilter.slice(0):s?this.doDeltaSort(p,d,r,e):this.rowNodeSorter.doFullSort(p.childrenAfterAggFilter,e);p.sibling&&(p.sibling.childrenAfterSort=p.childrenAfterSort),this.updateChildIndexes(p),h&&h({nodes:p.childrenAfterSort})}),this.updateGroupDataForHideOpenParents(r)}calculateDirtyNodes(e){const t={},s=i=>{i&&i.forEach(r=>t[r.id]=!0)};return e&&e.forEach(i=>{s(i.add),s(i.update),s(i.remove)}),t}doDeltaSort(e,t,s,i){const r=e.childrenAfterAggFilter,o=e.childrenAfterSort;if(!o)return this.rowNodeSorter.doFullSort(r,i);const l={},a=[];r.forEach(c=>{t[c.id]||!s.canSkip(c)?a.push(c):l[c.id]=!0});const d=o.filter(c=>l[c.id]),u=(c,p)=>({currentPos:p,rowNode:c}),h=a.map(u).sort((c,p)=>this.rowNodeSorter.compareRowNodes(i,c,p));return this.mergeSortedArrays(i,h,d.map(u)).map(({rowNode:c})=>c)}mergeSortedArrays(e,t,s){const i=[];let r=0,o=0;for(;r<t.length&&o<s.length;)this.rowNodeSorter.compareRowNodes(e,t[r],s[o])<0?i.push(t[r++]):i.push(s[o++]);for(;r<t.length;)i.push(t[r++]);for(;o<s.length;)i.push(s[o++]);return i}updateChildIndexes(e){if((0,n.MWY)(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let s=0;s<t.length;s++){const i=t[s],o=s===e.childrenAfterSort.length-1;i.setFirstChild(0===s),i.setLastChild(o),i.setChildIndex(s)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return(0,n.JT7)("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=s=>{this.pullDownGroupDataForHideOpenParents(s.childrenAfterSort,!1),s.childrenAfterSort.forEach(i=>{i.hasChildren()&&t(i)})};e&&e.executeFromRootNode(s=>t(s))}pullDownGroupDataForHideOpenParents(e,t){!this.gos.get("groupHideOpenParents")||(0,n.MWY)(e)||e.forEach(s=>{(this.showRowGroupColsService?.getShowRowGroupCols()??[]).forEach(r=>{const o=r.getColDef().showRowGroup;if("string"!=typeof o)return void(0,n.D1O)("groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const a=this.columnModel.getColDefCol(o);if(a!==s.rowGroupColumn)if(t)s.setGroupValue(r.getId(),void 0);else{const u=this.getFirstChildOfFirstChild(s,a);u&&s.setGroupValue(r.getId(),u.key)}})})}getFirstChildOfFirstChild(e,t){let s=e;for(;s;){const i=s.parent;if(!i||!s.firstChild)return null;if(i.rowGroupColumn===t)return i;s=i}return null}},class extends n.XQb{constructor(){super(...arguments),this.beanName="immutableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){(0,n.dbY)(this.gos)&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const e=this.gos.exists("getRowId");return!this.gos.get("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const s=this.clientSideRowModel.getNodeManager(),{rowNodeTransaction:i,rowsInserted:r}=s.updateRowData(t);let o=!1;this.gos.get("suppressMaintainUnsortedOrder")||(o=s.updateRowOrderFromRowData(e)),this.clientSideRowModel.afterImmutableDataChange(i,o||r)}createTransactionForRowData(e){if(!(0,n.dbY)(this.gos))return(0,n.D1O)("ImmutableService only works with ClientSideRowModel"),null;const t=(0,n.En5)(this.gos);if(null==t)return(0,n.D1O)("ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!"),null;const s=this.clientSideRowModel.getNodeManager().getCopyOfNodesMap(),i=[],r=[],o=[];return(0,n.Qmv)(e)&&e.forEach(l=>{const a=t({data:l,level:0}),d=s[a];d?(d.data!==l&&r.push(l),s[a]=void 0):o.push(l)}),(0,n.RhE)(s,(l,a)=>{a&&i.push(a.data)}),{remove:i,update:r,add:o}}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}}]}),Ls=(0,n.n9N)({version:Ie,moduleName:`${n.zsj.ClientSideRowModelModule}-api`,beans:[n.$6i],apiFunctions:{onGroupExpandedOrCollapsed:function be(e){e.expansionService.onGroupExpandedOrCollapsed()},refreshClientSideRowModel:function Pe(e,t){e.rowModelHelperService?.getClientSideRowModel()?.refreshModel(t)},isRowDataEmpty:function Ee(e){return e.rowModelHelperService?.getClientSideRowModel()?.isEmpty()??!0},forEachLeafNode:function Te(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachLeafNode(t)},forEachNodeAfterFilter:function De(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilter(t)},forEachNodeAfterFilterAndSort:function Ge(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilterAndSort(t)},resetRowHeights:function D(e){e.columnModel.isAutoRowHeightActive()?(0,n.JT7)("calling gridApi.resetRowHeights() makes no sense when using Auto Row Height."):e.rowModelHelperService?.getClientSideRowModel()?.resetRowHeights()},applyTransaction:function Ps(e,t){return e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.updateRowData(t))},applyTransactionAsync:function O(e,t,s){e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.batchUpdateRowData(t,s))},flushAsyncTransactions:function H(e){e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.flushAsyncTransactions())},getBestCostNodeSelection:function ct(e){return e.selectionService.getBestCostNodeSelection()}},dependantModules:[ht,n.rzr]}),ks=(0,n.n9N)({version:Ie,moduleName:n.zsj.ClientSideRowModelModule,dependantModules:[ht,Ls]}),R=P(6901),q=P(467),pt=class extends n.XQb{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return(null==e||!e.length)&&(e=this.getDefaultFileName()),-1===e.indexOf(".")?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},gt=class{constructor(e){this.groupColumns=[];const{columnModel:t,funcColsService:s,columnNameService:i,valueService:r,gos:o,processCellCallback:l,processHeaderCallback:a,processGroupHeaderCallback:d,processRowGroupCallback:u}=e;this.columnModel=t,this.funcColsService=s,this.columnNameService=i,this.valueService=r,this.gos=o,this.processCellCallback=l,this.processHeaderCallback=a,this.processGroupHeaderCallback=d,this.processRowGroupCallback=u}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,s,i,r){const l=this.gos.get("groupHideOpenParents")&&!r.footer||!this.shouldRenderGroupSummaryCell(r,e,t)?this.valueService.getValue(e,r):this.createValueForGroupNode(e,r);return this.processCell({accumulatedRowIndex:s,rowNode:r,column:e,value:l,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,s){if(!e||!e.group)return!1;if(-1!==this.groupColumns.indexOf(t)){const l=e.groupData?.[t.getId()],a=this.gos.get("suppressGroupMaintainValueType");if(a&&null!=l||!a&&void 0!==l||(0,n.TiQ)(this.gos)&&e.group)return!0;if(e.footer&&-1===e.level){const d=t.getColDef();return null==d||!0===d.showRowGroup||d.showRowGroup===this.funcColsService.getRowGroupColumns()[0].getId()}}const o=(0,n.BNA)(this.gos,this.columnModel.isPivotMode());return 0===s&&o}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnNameService.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const s=this.gos.get("treeData"),i=this.gos.get("suppressGroupMaintainValueType"),r=d=>{if(s||i)return d.key;const u=d.groupData?.[e.getId()];return u&&d.rowGroupColumn&&!1!==d.rowGroupColumn.getColDef().useValueFormatterForExport?this.valueService.formatValue(d.rowGroupColumn,d,u)??u:u},o=t.footer,l=[r(t)];if(!(0,n.Njs)(this.gos))for(;t.parent;)l.push(r(t=t.parent));const a=l.reverse().join(" -> ");return o?`Total ${a}`:a}processCell(e){const{accumulatedRowIndex:t,rowNode:s,column:i,value:r,processCellCallback:o,type:l}=e;return o?{value:o(this.gos.addGridCommonParams({accumulatedRowIndex:t,column:i,node:s,value:r,type:l,parseValue:a=>this.valueService.parseValue(i,s,a,this.valueService.getValue(i,s)),formatValue:a=>this.valueService.formatValue(i,s,a)??a}))??""}:!1!==i.getColDef().useValueFormatterForExport?{value:r??"",valueFormatted:this.valueService.formatValue(i,s,r)}:{value:r??""}}},Le=class{static download(e,t){const s=document.defaultView||window;if(!s)return void(0,n.JT7)("There is no `window` associated with the current `document`");const i=document.createElement("a"),r=s.URL.createObjectURL(t);i.setAttribute("href",r),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:s})),document.body.removeChild(i),s.setTimeout(()=>{s.URL.revokeObjectURL(r)},0)}},Ns=class extends gt{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:s}=e;this.suppressQuotes=t,this.columnSeparator=s}addCustomContent(e){e&&("string"==typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((s,i)=>{0!==i&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(s.data.value||""),s.mergeAcross&&this.appendEmptyCells(s.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,s,i){0!=s&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,s){0!=t&&(this.result+=this.columnSeparator);const i=this.extractRowCellValue(e,t,t,"csv",s);this.result+=this.putInQuotes(i.valueFormatted??i.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null==e)return'""';let t;return"string"==typeof e?t=e:"function"==typeof e.toString?t=e.toString():((0,n.JT7)("unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}},Z=(e=>(e[e.HEADER_GROUPING=0]="HEADER_GROUPING",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY",e))(Z||{}),ke="32.3.3",Ne=(0,n.n9N)({version:ke,moduleName:`${n.zsj.CsvExportModule}-core`,beans:[class extends pt{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.gridSerializer=e.gridSerializer}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void(0,n.JT7)("Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),s=this.getData(t),i=new Blob(["\ufeff",s],{type:"text/plain"}),r="function"==typeof t.fileName?t.fileName(this.gos.getGridCommonParams()):t.fileName;Le.download(this.getFileName(r),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const s=t?Object.assign({},e):this.getMergedParams(e);return this.getData(s)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,columnNameService:s,funcColsService:i,valueService:r,gos:o}=this,{processCellCallback:l,processHeaderCallback:a,processGroupHeaderCallback:d,processRowGroupCallback:u,suppressQuotes:h,columnSeparator:c}=e;return new Ns({columnModel:t,columnNameService:s,funcColsService:i,valueService:r,gos:o,processCellCallback:l||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:d||void 0,processRowGroupCallback:u||void 0,suppressQuotes:h||!1,columnSeparator:c||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}},class extends n.XQb{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.selectionService=e.selectionService,this.rowNodeSorter=e.rowNodeSorter,this.sortController=e.sortController}serialize(e,t={}){const{allColumns:s,columnKeys:i,skipRowGroups:r}=t,o=this.getColumnsToExport(s,r,i);return(0,n.EAl)(this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t))(e).parse()}processRow(e,t,s,i){const r=t.shouldRowBeSkipped||(()=>!1),o=this.gos.get("groupRemoveSingleChildren"),l=this.gos.get("groupRemoveLowestSingleChildren"),d=null!=t.rowPositions||!!t.onlySelected,u=this.gos.get("groupHideOpenParents")&&!d,h=this.columnModel.isPivotMode()?i.leafGroup:!i.group,c=!!i.footer,p=l&&i.leafGroup;if(!h&&!c&&(t.skipRowGroups||1===i.allChildrenCount&&1===i.childrenAfterGroup?.length&&(o||p)||u)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&"top"===i.rowPinned||t.skipPinnedBottom&&"bottom"===i.rowPinned||-1===i.level&&!h&&!c||r(this.gos.addGridCommonParams({node:i})))return;const y=e.onNewBodyRow(i);if(s.forEach((C,S)=>{y.onColumn(C,S,i)}),t.getCustomContentBelowRow){const C=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:i}));C&&e.addCustomContent(C)}}appendContent(e){return t=>{const s=e.appendContent;return s&&t.addCustomContent(s),t}}prependContent(e){return t=>{const s=e.prependContent;return s&&t.addCustomContent(s),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return s=>{if(!e.skipColumnGroupHeaders){const i=new n.uf_,r=this.visibleColsService.createGroups({columns:t,idCreator:i,pinned:null,isStandaloneStructure:!0});this.recursivelyAddHeaderGroups(r,s,e.processGroupHeaderCallback)}return s}}exportHeaders(e,t){return s=>{if(!e.skipColumnHeaders){const i=s.onNewHeaderRow();t.forEach((r,o)=>{i.onColumn(r,o,void 0)})}return s}}processPinnedTopRows(e,t){return s=>{const i=this.processRow.bind(this,s,e,t);return e.rowPositions?e.rowPositions.filter(r=>"top"===r.rowPinned).sort((r,o)=>r.rowIndex-o.rowIndex).map(r=>this.pinnedRowModel.getPinnedTopRow(r.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedRow("top",i),s}}processRows(e,t){return s=>{const i=this.rowModel,r=(0,n.dbY)(this.gos),o=(0,n.TiQ)(this.gos),l=!r&&e.onlySelected,a=this.processRow.bind(this,s,e,t),{exportedRows:d="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(u=>null==u.rowPinned).sort((u,h)=>u.rowIndex-h.rowIndex).map(u=>i.getRow(u.rowIndex)).forEach(a);else if(this.columnModel.isPivotMode())r?i.forEachPivotNode(a,!0):o?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);else if(e.onlySelectedAllPages||l){const u=this.selectionService.getSelectedNodes();this.replicateSortedOrder(u),u.forEach(a)}else"all"===d?i.forEachNode(a):r||o?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);return s}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),s=(i,r)=>null!=i.rowIndex&&null!=r.rowIndex?i.rowIndex-r.rowIndex:i.level===r.level?i.parent?.id===r.parent?.id?this.rowNodeSorter.compareRowNodes(t,{rowNode:i,currentPos:i.rowIndex??-1},{rowNode:r,currentPos:r.rowIndex??-1}):s(i.parent,r.parent):i.level>r.level?s(i.parent,r):s(i,r.parent);e.sort(s)}processPinnedBottomRows(e,t){return s=>{const i=this.processRow.bind(this,s,e,t);return e.rowPositions?e.rowPositions.filter(r=>"bottom"===r.rowPinned).sort((r,o)=>r.rowIndex-o.rowIndex).map(r=>this.pinnedRowModel.getPinnedBottomRow(r.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedRow("bottom",i),s}}getColumnsToExport(e=!1,t=!1,s){const i=this.columnModel.isPivotMode();if(s&&s.length)return this.columnModel.getColsForKeys(s);const r=this.gos.get("treeData");let o=[];return o=e&&!i?this.columnModel.getCols():this.visibleColsService.getAllCols(),t&&!r&&(o=o.filter(l=>(0,n.dYA)(l)||(0,n.Ddx)(l))),o}recursivelyAddHeaderGroups(e,t,s){const i=[];e.forEach(r=>{r.getChildren&&r.getChildren().forEach(l=>i.push(l))}),e.length>0&&(0,n.Kzv)(e[0])&&this.doAddHeaderHeader(t,e,s),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,s)}doAddHeaderHeader(e,t,s){const i=e.onNewHeaderGroupingRow();let r=0;t.forEach(o=>{const l=o;let a;a=s?s(this.gos.addGridCommonParams({columnGroup:l})):this.columnNameService.getDisplayNameForColumnGroup(l,"header");const d=l.getLeafColumns().reduce((u,h,c,p)=>{let g=(0,n.GXs)(u);return"open"===h.getColumnGroupShow()?(!g||null!=g[1])&&(g=[c],u.push(g)):g&&null==g[1]&&(g[1]=c-1),c===p.length-1&&g&&null==g[1]&&(g[1]=c),u},[]);i.onColumn(l,a||"",r++,l.getLeafColumns().length-1,d)})}}]}),Us=(0,n.n9N)({version:ke,moduleName:`${n.zsj.CsvExportModule}-api`,apiFunctions:{getDataAsCsv:function Os(e,t){return e.csvCreator?.getDataAsCsv(t)},exportDataAsCsv:function Bs(e,t){e.csvCreator?.exportDataAsCsv(t)}},dependantModules:[Ne]}),_s=(0,n.n9N)({version:ke,moduleName:n.zsj.CsvExportModule,dependantModules:[Ne,Us]});function mt(e,t,s){if(!t&&""!==t&&0!==t)return"";let i=t;return"boolean"==typeof t&&s&&(i=s(t)),` ${e}="${i}"`}var Ct=class{static createHeader(e={}){const i=["version"];return e.version||(e.version="1.0"),e.encoding&&i.push("encoding"),e.standalone&&i.push("standalone"),`<?xml ${i.map(o=>`${o}="${e[o]}"`).join(" ")} ?>`}static createXml(e,t){let s="";e.properties&&(e.properties.prefixedAttributes&&e.properties.prefixedAttributes.forEach(r=>{Object.keys(r.map).forEach(o=>{s+=mt(r.prefix+o,r.map[o],t)})}),e.properties.rawMap&&Object.keys(e.properties.rawMap).forEach(r=>{s+=mt(r,e.properties.rawMap[r],t)}));let i="<"+e.name+s;return e.children||null!=e.textNode?null!=e.textNode?i+">"+e.textNode+"</"+e.name+">\r\n":(i+=">\r\n",e.children&&e.children.forEach(r=>{i+=this.createXml(r,t)}),i+"</"+e.name+">\r\n"):i+"/>\r\n"}},zs=function(){var e=(0,q.A)(function*(t){let s=0;const i=[],r=new WritableStream({write:a=>{i.push(a),s+=a.length}}),o=new ReadableStream({start:a=>{const d=new FileReader;d.onload=u=>{u.target?.result&&a.enqueue(u.target.result),a.close()},d.readAsArrayBuffer(t)}}),l=new window.CompressionStream("deflate-raw");return yield o.pipeThrough(l).pipeTo(r),{size:s,content:new Blob(i)}});return function(s){return e.apply(this,arguments)}}(),Ks=function(){var e=(0,q.A)(function*(t){const s=new Blob([t]),{size:i,content:r}=yield zs(s);return{size:i,content:new Uint8Array(yield r.arrayBuffer())}});return function(s){return e.apply(this,arguments)}}();function G(e,t){let s="";for(let i=0;i<t;i++)s+=String.fromCharCode(255&e),e>>>=8;return s}var St=e=>e.length?(e=>{if(!e.length)return 0;let t=-1,s=0,i=0,r=0;for(let o=0;o<e.length;o++)s=e[o],i=255&(t^s),r=js[i],t=t>>>8^r;return~t})("string"==typeof e?(new TextEncoder).encode(e):e):0,js=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),wt=(e,t,s,i,r,o)=>{const{content:l,path:a,created:d}=e,u=(e=>{let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t})(d),h=(e=>{let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t})(d),c=St(r),p=void 0!==o?o:i,g=(0,n.cHF)(a),f=g!==a;let v="";if(f){const w=G(1,1)+G(St(g),4)+g;v="up"+G(w.length,2)+w}const y="\x14\0"+(f?"\0\b":"\0\0")+G(t?8:0,2)+G(u,2)+G(h,2)+G(p?c:0,4)+G(o??i,4)+G(i,4)+G(g.length,2)+G(v.length,2),C="PK\x03\x04"+y+g+v,S="PK\x01\x02\x14\0"+y+"\0\0\0\0\0\0"+(l?"\0\0\0\0":"\x10\0\0\0")+G(s,4)+g+v;return{localFileHeader:Uint8Array.from(C,w=>w.charCodeAt(0)),centralDirectoryHeader:Uint8Array.from(S,w=>w.charCodeAt(0))}},yt=e=>{let t;if("string"==typeof e){const s=atob(e.split(";base64,")[1]);t=Uint8Array.from(s,i=>i.charCodeAt(0))}else t=e;return{size:t.length,content:t}},Xs=function(){var e=(0,q.A)(function*(t,s){const{content:i}=t,{size:r,content:o}=i?yt(i):{size:0,content:Uint8Array.from([])};let l,a,d=!1;if("file"===t.type&&o&&r>0){const c=yield Ks(o);l=c.content,a=c.size,d=!0}return{...wt(t,d,s,r,o,a),content:l||o,isCompressed:d}});return function(s,i){return e.apply(this,arguments)}}(),Ys=(e,t)=>{const{content:s}=e,{content:i}=s?yt(s):{content:Uint8Array.from([])};return{...wt(e,!1,t,i.length,i,void 0),content:i,isCompressed:!1}},A=(()=>{let e=class{static addFolders(t){t.forEach(this.addFolder.bind(this))}static addFolder(t){this.folders.push({path:t,created:new Date,isBase64:!1,type:"folder"})}static addFile(t,s,i=!1){this.files.push({path:t,created:new Date,content:i?s:(new TextEncoder).encode(s),isBase64:i,type:"file"})}static getZipFile(t="application/zip"){var s=this;return(0,q.A)(function*(){const i=yield s.buildCompressedFileStream();return s.clearStream(),new Blob([i],{type:t})})()}static getUncompressedZipFile(t="application/zip"){const s=this.buildFileStream();return this.clearStream(),new Blob([s],{type:t})}static clearStream(){this.folders=[],this.files=[]}static packageFiles(t){let s=0,i=0;for(const h of t){const{localFileHeader:c,centralDirectoryHeader:p,content:g}=h;s+=c.length+g.length,i+=p.length}const r=new Uint8Array(s),o=new Uint8Array(i);let l=0,a=0;for(const h of t){const{localFileHeader:c,centralDirectoryHeader:p,content:g}=h;r.set(c,l),l+=c.length,r.set(g,l),l+=g.length,o.set(p,a),a+=p.length}const d=((e,t,s)=>{const i="PK\x05\x06\0\0\0\0"+G(e,2)+G(e,2)+G(t,4)+G(s,4)+"\0\0";return Uint8Array.from(i,r=>r.charCodeAt(0))})(t.length,i,s),u=new Uint8Array(r.length+o.length+d.length);return u.set(r),u.set(o,r.length),u.set(d,r.length+o.length),u}static buildCompressedFileStream(){var t=this;return(0,q.A)(function*(){const s=[...t.folders,...t.files],i=[];let r=0;for(const o of s){const l=yield Xs(o,r),{localFileHeader:a,content:d}=l;i.push(l),r+=a.length+d.length}return t.packageFiles(i)})()}static buildFileStream(){const t=[...this.folders,...this.files],s=[];let i=0;for(const r of t){const o=Ys(r,i),{localFileHeader:l,content:a}=o;s.push(o),i+=l.length+a.length}return this.packageFiles(s)}};return e.folders=[],e.files=[],e})(),Ve="paste",Oe="dragCopy",Ft="clipboard",Rt=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,Be="32.3.3",xt=(0,n.n9N)({version:Be,moduleName:`${n.zsj.ClipboardModule}-core`,beans:[class Fs extends n.XQb{constructor(){super(...arguments),this.beanName="clipboardService",this.lastPasteOperationTime=0,this.navigatorApiFailed=!1}wireBeans(t){this.csvCreator=t.csvCreator,this.selectionService=t.selectionService,this.rowModel=t.rowModel,this.ctrlsService=t.ctrlsService,this.valueService=t.valueService,this.focusService=t.focusService,this.rowRenderer=t.rowRenderer,this.visibleColsService=t.visibleColsService,this.funcColsService=t.funcColsService,this.cellNavigationService=t.cellNavigationService,this.cellPositionUtils=t.cellPositionUtils,this.rowPositionUtils=t.rowPositionUtils,this.rangeService=t.rangeService}postConstruct(){(0,n.dbY)(this.gos)&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(this,t=>{this.gridCtrl=t.gridCtrl})}pasteFromClipboard(){!this.gos.get("suppressClipboardApi")&&!this.navigatorApiFailed&&navigator.clipboard&&navigator.clipboard.readText?navigator.clipboard.readText().then(this.processClipboardData.bind(this)).catch(s=>{(0,n.JT7)(`${s}\n${Rt("readText")}`),this.navigatorApiFailed=!0,this.pasteFromClipboardLegacy()}):this.pasteFromClipboardLegacy()}pasteFromClipboardLegacy(){let t=!1;const s=i=>{const r=(new Date).getTime();r-this.lastPasteOperationTime<50&&(t=!0,i.preventDefault()),this.lastPasteOperationTime=r};this.executeOnTempElement(i=>{i.addEventListener("paste",s),i.focus({preventScroll:!0})},i=>{const r=i.value;t?this.refocusLastFocusedCell():this.processClipboardData(r),i.removeEventListener("paste",s)})}refocusLastFocusedCell(){const t=this.focusService.getFocusedCell();t&&this.focusService.setFocusedCell({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0})}getClipboardDelimiter(){const t=this.gos.get("clipboardDelimiter");return(0,n.Qmv)(t)?t:"\t"}processClipboardData(t){if(null==t)return;let s=Fs.stringToArray(t,this.getClipboardDelimiter());const i=this.gos.getCallback("processDataFromClipboard");i&&(s=i({data:s})),null!=s&&(this.gos.get("suppressLastEmptyLineOnPaste")&&this.removeLastLineIfBlank(s),this.doPasteOperation((o,l,a,d)=>{this.rangeService?.isMoreThanOneCell()&&!this.hasOnlyOneValueToPaste(s)?this.pasteIntoActiveRange(this.rangeService,s,o,l,d):this.pasteStartingFromFocusedCell(s,o,l,a,d)}))}static stringToArray(t,s=","){const i=[],r=l=>"\r"===l||"\n"===l;let o=!1;if(""===t)return[[""]];for(let l=0,a=0,d=0;d<t.length;d++){const u=t[d-1],h=t[d],c=t[d+1],p=()=>{i[l]||(i[l]=[]),i[l][a]||(i[l][a]="")};if(p(),'"'===h&&(o?'"'===c?(i[l][a]+='"',d++):o=!1:(void 0===u||u===s||r(u))&&(o=!0)),!o&&'"'!==h){if(h===s){a++,p();continue}if(r(h)){a=0,l++,p(),"\r"===h&&"\n"===c&&d++;continue}}i[l][a]+=h}return i}doPasteOperation(t){const s="clipboard";let i;if(this.eventService.dispatchEvent({type:"pasteStart",source:s}),this.clientSideRowModel){const d=this.gos.get("aggregateOnlyChangedColumns");i=new n.k$d(d,this.clientSideRowModel.getRootNode())}const r={},o=[];t(r,o,this.focusService.getFocusedCell(),i);const a=[...o];i&&(this.clientSideRowModel.doAggregate(i),i.forEachChangedNodeDepthFirst(d=>{a.push(d)})),this.rowRenderer.refreshCells({rowNodes:a}),this.dispatchFlashCells(r),this.fireRowChanged(o),this.refocusLastFocusedCell(),this.eventService.dispatchEvent({type:"pasteEnd",source:s})}pasteIntoActiveRange(t,s,i,r,o){const l=this.getRangeSize(t)%s.length!=0;let a=0,d=0;this.iterateActiveRanges(!1,(h,c,p,g)=>{if(g-a>=s.length){if(l)return;a+=d,d=0}const v=s[g-a];r.push(c);const y=this.gos.getCallback("processCellFromClipboard");p.forEach((C,S)=>{if(!C.isCellEditable(c)||C.isSuppressPaste(c))return;S>=v.length&&(S%=v.length);const w=this.processCell(c,C,v[S],Oe,y,!0);c.setDataValue(C,w,Ve),o&&o.addParentNode(c.parent,[C]);const{rowIndex:x,rowPinned:M}=h,T=this.cellPositionUtils.createIdFromValues({rowIndex:x,column:C,rowPinned:M});i[T]=!0}),d++})}getDisplayedColumnsStartingAt(t){let s=t;const i=[];for(;null!=s;)i.push(s),s=this.visibleColsService.getColAfter(s);return i}pasteStartingFromFocusedCell(t,s,i,r,o){if(!r)return;const l={rowIndex:r.rowIndex,rowPinned:r.rowPinned},a=this.getDisplayedColumnsStartingAt(r.column);this.isPasteSingleValueIntoRange(t)?this.pasteSingleValueIntoRange(t,i,s,o):this.pasteMultipleValues(t,l,i,a,s,Ft,o)}isPasteSingleValueIntoRange(t){return this.hasOnlyOneValueToPaste(t)&&null!=this.rangeService&&!this.rangeService.isEmpty()}pasteSingleValueIntoRange(t,s,i,r){const o=t[0][0];this.iterateActiveRanges(!1,(a,d,u)=>{s.push(d),u.forEach(h=>this.updateCellValue(d,h,o,i,Ft,r))})}hasOnlyOneValueToPaste(t){return 1===t.length&&1===t[0].length}copyRangeDown(){if(!this.rangeService||this.rangeService.isEmpty())return;const t=[];this.doPasteOperation((i,r,o,l)=>{const a=this.gos.getCallback("processCellForClipboard"),d=this.gos.getCallback("processCellFromClipboard");this.iterateActiveRanges(!0,(h,c,p)=>{t.length?(r.push(c),p.forEach((g,f)=>{if(!g.isCellEditable(c)||g.isSuppressPaste(c))return;const v=this.processCell(c,g,t[f],Oe,d,!0);c.setDataValue(g,v,Ve),l&&l.addParentNode(c.parent,[g]);const{rowIndex:y,rowPinned:C}=h,S=this.cellPositionUtils.createIdFromValues({rowIndex:y,column:g,rowPinned:C});i[S]=!0})):p.forEach(g=>{const f=this.processCell(c,g,this.valueService.getValue(g,c),Oe,a,!1,!0);t.push(f)})})})}removeLastLineIfBlank(t){const s=(0,n.GXs)(t);if(s&&1===s.length&&""===s[0]){if(1===t.length)return;(0,n.$ii)(t,s)}}fireRowChanged(t){"fullRow"===this.gos.get("editType")&&t.forEach(s=>{this.eventService.dispatchEvent({type:"rowValueChanged",node:s,data:s.data,rowIndex:s.rowIndex,rowPinned:s.rowPinned})})}pasteMultipleValues(t,s,i,r,o,l,a){let d=s;const u=null!=this.clientSideRowModel&&!this.gos.get("enableGroupEdit")&&!this.gos.get("treeData"),h=()=>{for(;;){if(!d)return null;const c=this.rowPositionUtils.getRowNode(d);if(d=this.cellNavigationService.getRowBelow({rowPinned:d.rowPinned,rowIndex:d.rowIndex}),null==c)return null;if(!(c.detail||c.footer||u&&c.group))return c}};t.forEach(c=>{const p=h();p&&(c.forEach((g,f)=>this.updateCellValue(p,r[f],g,o,l,a)),i.push(p))})}updateCellValue(t,s,i,r,o,l){if(!t||!s||!s.isCellEditable(t)||s.isSuppressPaste(t))return;const a=this.processCell(t,s,i,o,this.gos.getCallback("processCellFromClipboard"),!0);t.setDataValue(s,a,Ve);const{rowIndex:d,rowPinned:u}=t;r[this.cellPositionUtils.createIdFromValues({rowIndex:d,column:s,rowPinned:u})]=!0,l&&l.addParentNode(t.parent,[s])}copyToClipboard(t={}){this.copyOrCutToClipboard(t)}cutToClipboard(t={},s="api"){this.gos.get("suppressCutToClipboard")||(this.eventService.dispatchEvent({type:"cutStart",source:s}),this.copyOrCutToClipboard(t,!0),this.eventService.dispatchEvent({type:"cutEnd",source:s}))}copyOrCutToClipboard(t,s){let{includeHeaders:i,includeGroupHeaders:r}=t;null==i&&(i=this.gos.get("copyHeadersToClipboard")),null==r&&(r=this.gos.get("copyGroupHeadersToClipboard"));const o={includeHeaders:i,includeGroupHeaders:r},l=this.gos.get("rowSelection"),a=this.gos.get("cellSelection");let d=null;this.shouldCopyCells(a,l)?(this.copySelectedRangeToClipboard(o),d=0):this.shouldCopyRows(l)?(this.copySelectedRowsToClipboard(o),d=1):this.focusService.isAnyCellFocused()&&(this.copyFocusedCellToClipboard(o),d=2),s&&null!==d&&this.clearCellsAfterCopy(d)}shouldCopyCells(t,s){if(!this.rangeService||this.rangeService.isEmpty())return!1;if(t)return!("object"==typeof s&&s.copySelectedRows&&!this.selectionService.isEmpty());{const i=this.gos.get("suppressCopySingleCellRanges");return!(!this.rangeService.isMoreThanOneCell()&&i)}}shouldCopyRows(t){return!this.selectionService.isEmpty()&&(t&&"string"!=typeof t?t.copySelectedRows??!1:!this.gos.get("suppressCopyRowsToClipboard"))}clearCellsAfterCopy(t){if(this.eventService.dispatchEvent({type:"keyShortcutChangedCellStart"}),0===t)this.rangeService.clearCellRangeCellValues({cellEventSource:"clipboardService"});else if(1===t)this.clearSelectedRows();else{const s=this.focusService.getFocusedCell();if(null==s)return;const i=this.rowPositionUtils.getRowNode(s);i&&this.clearCellValue(i,s.column)}this.eventService.dispatchEvent({type:"keyShortcutChangedCellEnd"})}clearSelectedRows(){const t=this.selectionService.getSelectedNodes(),s=this.visibleColsService.getAllCols();for(const i of t)for(const r of s)this.clearCellValue(i,r)}clearCellValue(t,s){if(!s.isCellEditable(t))return;const i=this.valueService.getDeleteValue(s,t);t.setDataValue(s,i,"clipboardService")}iterateActiveRanges(t,s,i){if(!this.rangeService||this.rangeService.isEmpty())return;const r=this.rangeService.getCellRanges();t?this.iterateActiveRange(r[0],s,i,!0):r.forEach((o,l)=>this.iterateActiveRange(o,s,i,l===r.length-1))}iterateActiveRange(t,s,i,r){if(!this.rangeService)return;let o=this.rangeService.getRangeStartRow(t);const l=this.rangeService.getRangeEndRow(t);i&&t.columns&&i(t.columns);let a=0,d=!1;for(;!d&&null!=o;){const u=this.rowPositionUtils.getRowNode(o);d=this.rowPositionUtils.sameRow(o,l),s(o,u,t.columns,a++,d&&r),o=this.cellNavigationService.getRowBelow(o)}}copySelectedRangeToClipboard(t={}){if(!this.rangeService||this.rangeService.isEmpty())return;const s=this.rangeService.areAllRangesAbleToMerge(),{data:i,cellsToFlash:r}=s?this.buildDataFromMergedRanges(this.rangeService,t):this.buildDataFromRanges(this.rangeService,t);this.copyDataToClipboard(i),this.dispatchFlashCells(r)}buildDataFromMergedRanges(t,s){const i=new Set,r=t.getCellRanges(),o=new Map,l=[],a={};r.forEach(c=>{c.columns.forEach(f=>i.add(f));const{rowPositions:p,cellsToFlash:g}=this.getRangeRowPositionsAndCellsToFlash(t,c);p.forEach(f=>{const v=`${f.rowIndex}-${f.rowPinned||"null"}`;o.get(v)||(o.set(v,!0),l.push(f))}),Object.assign(a,g)});const d=this.visibleColsService.getAllCols(),u=Array.from(i);return u.sort((c,p)=>d.indexOf(c)-d.indexOf(p)),{data:this.buildExportParams({columns:u,rowPositions:l,includeHeaders:s.includeHeaders,includeGroupHeaders:s.includeGroupHeaders}),cellsToFlash:a}}buildDataFromRanges(t,s){const i=t.getCellRanges(),r=[],o={};return i.forEach(l=>{const{rowPositions:a,cellsToFlash:d}=this.getRangeRowPositionsAndCellsToFlash(t,l);Object.assign(o,d),r.push(this.buildExportParams({columns:l.columns,rowPositions:a,includeHeaders:s.includeHeaders,includeGroupHeaders:s.includeGroupHeaders}))}),{data:r.join("\n"),cellsToFlash:o}}getRangeRowPositionsAndCellsToFlash(t,s){const i=[],r={},o=t.getRangeStartRow(s),l=t.getRangeEndRow(s);let a=o;for(;a&&(i.push(a),s.columns.forEach(d=>{const{rowIndex:u,rowPinned:h}=a,c=this.cellPositionUtils.createIdFromValues({rowIndex:u,column:d,rowPinned:h});r[c]=!0}),!this.rowPositionUtils.sameRow(a,l));)a=this.cellNavigationService.getRowBelow(a);return{rowPositions:i,cellsToFlash:r}}getCellsToFlashFromRowNodes(t){const s=this.visibleColsService.getAllCols(),i={};for(let r=0;r<t.length;r++){const{rowIndex:o,rowPinned:l}=t[r];if(null!=o)for(let a=0;a<s.length;a++)i[this.cellPositionUtils.createIdFromValues({rowIndex:o,column:s[a],rowPinned:l})]=!0}return i}copyFocusedCellToClipboard(t={}){const s=this.focusService.getFocusedCell();if(null==s)return;const i=this.cellPositionUtils.createId(s),l=this.buildExportParams({columns:[s.column],rowPositions:[{rowPinned:s.rowPinned,rowIndex:s.rowIndex}],includeHeaders:t.includeHeaders,includeGroupHeaders:t.includeGroupHeaders});this.copyDataToClipboard(l),this.dispatchFlashCells({[i]:!0})}copySelectedRowsToClipboard(t={}){const{columnKeys:s,includeHeaders:i,includeGroupHeaders:r}=t,o=this.buildExportParams({columns:s,includeHeaders:i,includeGroupHeaders:r});this.copyDataToClipboard(o);const l=this.selectionService.getSelectedNodes()||[];this.dispatchFlashCells(this.getCellsToFlashFromRowNodes(l))}buildExportParams(t){const{columns:s,rowPositions:i,includeHeaders:r=!1,includeGroupHeaders:o=!1}=t,l={columnKeys:s,rowPositions:i,skipColumnHeaders:!r,skipColumnGroupHeaders:!o,suppressQuotes:!0,columnSeparator:this.getClipboardDelimiter(),onlySelected:!i,processCellCallback:this.gos.getCallback("processCellForClipboard"),processRowGroupCallback:a=>this.processRowGroupCallback(a),processHeaderCallback:this.gos.getCallback("processHeaderForClipboard"),processGroupHeaderCallback:this.gos.getCallback("processGroupHeaderForClipboard")};return this.csvCreator.getDataAsCsv(l,!0)}processRowGroupCallback(t){const{node:s,column:i}=t,r=this.gos.get("treeData"),o=this.gos.get("suppressGroupMaintainValueType");let a=(()=>{if(r||o||!i)return s.key;const u=s.groupData?.[i.getId()];return u&&s.rowGroupColumn&&!1!==s.rowGroupColumn.getColDef().useValueFormatterForExport?this.valueService.formatValue(s.rowGroupColumn,s,u)??u:u})();if(t.node.footer){let u="";a&&a.length&&(u=` ${a}`),a=`Total${u}`}const d=this.gos.getCallback("processCellForClipboard");if(d){let u=s.rowGroupColumn;return!u&&s.footer&&-1===s.level&&(u=this.funcColsService.getRowGroupColumns()[0]),d({value:a,node:s,column:u,type:"clipboard",formatValue:h=>this.valueService.formatValue(u,s,h)??h,parseValue:h=>this.valueService.parseValue(u,s,h,this.valueService.getValue(u,s))})}return a}dispatchFlashCells(t){window.setTimeout(()=>{this.eventService.dispatchEvent({type:"flashCells",cells:t})},0)}processCell(t,s,i,r,o,l,a){return o?o({column:s,node:t,value:i,type:r,formatValue:u=>this.valueService.formatValue(s,t??null,u)??u,parseValue:u=>this.valueService.parseValue(s,t??null,u,this.valueService.getValue(s,t))}):l&&!1!==s.getColDef().useValueParserForImport?this.valueService.parseValue(s,t??null,i,this.valueService.getValue(s,t)):a&&!1!==s.getColDef().useValueFormatterForExport?this.valueService.formatValue(s,t??null,i)??i:i}copyDataToClipboard(t){const s=this.gos.getCallback("sendToClipboard");s?s({data:t}):this.gos.get("suppressClipboardApi")||!navigator.clipboard?this.copyDataToClipboardLegacy(t):navigator.clipboard.writeText(t).catch(r=>{(0,n.JT7)(`${r}\n${Rt("writeText")}`),this.copyDataToClipboardLegacy(t)})}copyDataToClipboardLegacy(t){this.executeOnTempElement(s=>{const i=(0,n.BxM)(this.gos),r=(0,n.UlD)(this.gos);s.value=t||" ",s.select(),s.focus({preventScroll:!0}),i.execCommand("copy")||(0,n.JT7)("Browser did not allow document.execCommand('copy'). Ensure api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons."),null!=r&&null!=r.focus&&r.focus({preventScroll:!0})})}executeOnTempElement(t,s){const i=(0,n.BxM)(this.gos),r=i.createElement("textarea");r.style.width="1px",r.style.height="1px",r.style.top=i.documentElement.scrollTop+"px",r.style.left=i.documentElement.scrollLeft+"px",r.style.position="absolute",r.style.opacity="0";const o=this.gridCtrl.getGui();o.appendChild(r);try{t(r)}catch{(0,n.JT7)("Browser does not support document.execCommand('copy') for clipboard operations")}s?window.setTimeout(()=>{s(r),o.removeChild(r)},100):o.removeChild(r)}getRangeSize(t){const s=t.getCellRanges();let i=0,r=0;return s.length>0&&(i=t.getRangeStartRow(s[0]).rowIndex,r=t.getRangeEndRow(s[0]).rowIndex),i-r+1}}],dependantModules:[R.bP,_s]}),ri=(0,n.n9N)({version:Be,moduleName:`${n.zsj.ClipboardModule}-api`,apiFunctions:{copyToClipboard:function Js(e,t){e.clipboardService?.copyToClipboard(t)},cutToClipboard:function qs(e,t){e.clipboardService?.cutToClipboard(t)},copySelectedRowsToClipboard:function Zs(e,t){e.clipboardService?.copySelectedRowsToClipboard(t)},copySelectedRangeToClipboard:function ei(e,t){e.clipboardService?.copySelectedRangeToClipboard(t)},copySelectedRangeDown:function ti(e){e.clipboardService?.copyRangeDown()},pasteFromClipboard:function si(e){e.clipboardService?.pasteFromClipboard()}},dependantModules:[xt]}),oi=(0,n.n9N)({version:Be,moduleName:n.zsj.ClipboardModule,dependantModules:[xt,ri]}),ni={sum:"Sum",first:"First",last:"Last",min:"Min",max:"Max",count:"Count",avg:"Average"};function ai(e){const{values:t}=e;let s=null;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?null===s?s=r:s+="number"==typeof s?r:BigInt(r):"bigint"==typeof r&&(s=null===s?r:("bigint"==typeof s?s:BigInt(s))+r)}return s}function di(e){return e.values.length>0?e.values[0]:null}function ui(e){return e.values.length>0?(0,n.GXs)(e.values):null}function ci(e){const{values:t}=e;let s=null;for(let i=0;i<t.length;i++){const r=t[i];("number"==typeof r||"bigint"==typeof r)&&(null===s||s>r)&&(s=r)}return s}function hi(e){const{values:t}=e;let s=null;for(let i=0;i<t.length;i++){const r=t[i];("number"==typeof r||"bigint"==typeof r)&&(null===s||s<r)&&(s=r)}return s}function pi(e){const{values:t}=e;let s=0;for(let r=0;r<t.length;r++){const o=t[r];s+=null!=o&&"number"==typeof o.value?o.value:1}const i=e.rowNode?.aggData?.[e.column.getColId()];return i&&i.value===s?i:{value:s,toString:function(){return this.value.toString()},toNumber:function(){return this.value}}}function gi(e){const{values:t}=e;let s=0,i=0;for(let l=0;l<t.length;l++){const a=t[l];let d=null;"number"==typeof a||"bigint"==typeof a?(d=a,i++):null!=a&&("number"==typeof a.value||"bigint"==typeof a.value)&&"number"==typeof a.count&&(d=a.value*("number"==typeof a.value?a.count:BigInt(a.count)),i+=a.count),"number"==typeof d?s+="number"==typeof s?d:BigInt(d):"bigint"==typeof d&&(s=("bigint"==typeof s?s:BigInt(s))+d)}let r=null;i>0&&(r=s/("number"==typeof s?i:BigInt(i)));const o=e.rowNode?.aggData?.[e.column?.getColId()];return o&&o.count===i&&o.value===r?o:{count:i,value:r,toString:function(){return"number"==typeof this.value||"bigint"==typeof this.value?this.value.toString():""},toNumber:function(){return this.value}}}var Ci=class extends R.v2{constructor(e,t,s,i,r){super(t,s,r,'\n                <span role="option">\n                    <span data-ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>\n                    <span data-ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>\n                    <ag-sort-indicator data-ref="eSortIndicator"></ag-sort-indicator>\n                    <span data-ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>\n                </span>\n            ',[n.pbL]),this.column=e,this.dropZonePurpose=i,this.eSortIndicator=n.dRA,this.popupShowing=!1}wireBeans(e){super.wireBeans(e),this.popupService=e.popupService,this.sortController=e.sortController,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.aggFuncService=e.aggFuncService}postConstruct(){this.displayName=this.columnNameService.getDisplayNameForColumn(this.column,"columnDrop"),super.postConstruct(),this.setupSort(),this.addManagedEventListeners({sortChanged:()=>{this.setupAria()}}),this.isGroupingZone()&&this.addManagedPropertyListener("groupLockGroupColumns",()=>{this.refreshRemove(),this.refreshDraggable(),this.setupAria()})}getItem(){return this.column}getDisplayName(){return this.displayName}getTooltip(){return this.column.getColDef().headerTooltip}addAdditionalAriaInstructions(e,t){const s=this.gos.get("rowGroupPanelSuppressSort"),i=this.gos.get("functionsReadOnly");if(this.isAggregationZone()&&!i){const r=t("ariaDropZoneColumnValueItemDescription","Press ENTER to change the aggregation type");e.push(r)}if(this.isGroupingZone()&&this.column.isSortable()&&!s){const r=t("ariaDropZoneColumnGroupItemDescription","Press ENTER to sort");e.push(r)}super.addAdditionalAriaInstructions(e,t)}isDraggable(){return this.isReadOnly()}isRemovable(){return this.isReadOnly()}isReadOnly(){return!this.isGroupingAndLocked()&&!this.gos.get("functionsReadOnly")}getAriaDisplayName(){const e=this.localeService.getLocaleTextFunc(),{name:t,aggFuncName:s}=this.getColumnAndAggFuncName(),i=e("ariaDropZoneColumnComponentAggFuncSeparator"," of "),r={asc:e("ariaDropZoneColumnComponentSortAscending","ascending"),desc:e("ariaDropZoneColumnComponentSortDescending","descending")},o=this.column.getSort(),l=this.gos.get("rowGroupPanelSuppressSort");return[s&&`${s}${i}`,t,this.isGroupingZone()&&!l&&o&&`, ${r[o]}`].filter(a=>!!a).join("")}getColumnAndAggFuncName(){const e=this.displayName;let t="";if(this.isAggregationZone()){const s=this.column.getAggFunc(),i="string"==typeof s?s:"agg";t=this.localeService.getLocaleTextFunc()(i,i)}return{name:e,aggFuncName:t}}setupSort(){const e=this.column.isSortable(),t=this.isGroupingZone();if(e&&t&&!this.gos.get("rowGroupPanelSuppressSort")){this.eSortIndicator.setupSort(this.column,!0);const s=i=>{i.preventDefault();const o="ctrl"===this.gos.get("multiSortKey")?i.ctrlKey||i.metaKey:i.shiftKey;this.sortController.progressSort(this.column,o,"uiColumnSorted")};this.addGuiEventListener("click",s),this.addGuiEventListener("keydown",i=>{i.key===n.DDm.ENTER&&this.isGroupingZone()&&s(i)})}}getDefaultIconName(){return"hide"}createGetDragItem(){const{column:e}=this;return()=>{const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}}setupComponents(){super.setupComponents(),this.isAggregationZone()&&!this.gos.get("functionsReadOnly")&&this.addGuiEventListener("click",this.onShowAggFuncSelection.bind(this))}onKeyDown(e){super.onKeyDown(e),e.key===n.DDm.ENTER&&this.isAggregationZone()&&!this.gos.get("functionsReadOnly")&&(e.preventDefault(),this.onShowAggFuncSelection())}getDisplayValue(){const{name:e,aggFuncName:t}=this.getColumnAndAggFuncName();return this.isAggregationZone()?`${t}(${e})`:e}onShowAggFuncSelection(){if(this.popupShowing)return;this.popupShowing=!0;const e=new R.wj({cssIdentifier:"select-agg-func"}),t=this.aggFuncService.getFuncNames(this.column),s=this.getGui(),i=e.getGui();e.setModel({getRow:function(h){return t[h]},getRowCount:function(){return t.length}}),this.createBean(e);const r=(0,n.cvw)('<div class="ag-select-agg-func-popup"></div>');r.style.top="0px",r.style.left="0px",r.appendChild(i),r.style.width=`${s.clientWidth}px`;const[o]=this.addManagedElementListeners(r,{focusout:h=>{!r.contains(h.relatedTarget)&&d&&d.hideFunc()}}),a=this.localeService.getLocaleTextFunc(),d=this.popupService.addPopup({modal:!0,eChild:r,closeOnEsc:!0,closedCallback:h=>{this.destroyBean(e),this.popupShowing=!1,"Escape"===h?.key&&s.focus(),o&&o()},ariaLabel:a("ariaLabelAggregationFunction","Aggregation Function")});d&&e.setComponentCreator(this.createAggSelect.bind(this,d.hideFunc)),e.addGuiEventListener("keydown",h=>{if(h.key===n.DDm.ENTER||h.key===n.DDm.SPACE){const c=e.getLastFocusedRow();if(null==c)return;const p=e.getComponentAt(c);p&&p.selectItem()}}),this.popupService.positionPopupByComponent({type:"aggFuncSelect",eventSource:s,ePopup:r,keepWithinBounds:!0,column:this.column,position:"under"}),e.refresh();let u=t.findIndex(h=>h===this.column.getAggFunc());-1===u&&(u=0),e.focusRow(u)}createAggSelect(e,t){const i=this.localeService.getLocaleTextFunc(),r=t.toString(),o=i(r,r);return new vi(()=>{e(),this.getGui().focus(),this.funcColsService.setColumnAggFunc(this.column,t,"toolPanelDragAndDrop")},o)}isGroupingAndLocked(){return this.isGroupingZone()&&this.columnModel.isColGroupLocked(this.column)}isAggregationZone(){return"aggregation"===this.dropZonePurpose}isGroupingZone(){return"rowGroup"===this.dropZonePurpose}getDragSourceType(){return n.qRA.ToolPanel}destroy(){super.destroy(),this.column=null}},vi=class extends n.uAl{constructor(e,t){super('<div class="ag-select-agg-func-item"/>'),this.selectItem=e,this.getGui().innerText=t,this.addGuiEventListener("click",this.selectItem)}},He=class extends R.y_{constructor(e,t){super(e),this.dropZonePurpose=t}wireBeans(e){super.wireBeans(e),this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}init(e){super.init(e),this.addManagedEventListeners({newColumnsLoaded:this.refreshGui.bind(this)}),this.addManagedPropertyListeners(["functionsReadOnly","rowGroupPanelSuppressSort","groupLockGroupColumns"],this.refreshGui.bind(this))}getItems(e){return e.columns??[]}isInterestedIn(e){return e===n.qRA.HeaderCell||e===n.qRA.ToolPanel}minimumAllowedNewInsertIndex(){const e=this.gos.get("groupLockGroupColumns"),t=this.funcColsService.getRowGroupColumns().length;return-1===e?t:Math.min(e,t)}showOrHideColumnOnExit(e){return this.isRowGroupPanel()&&!this.gos.get("suppressRowGroupHidesColumns")&&!e.fromNudge}handleDragEnterEnd(e){if(this.showOrHideColumnOnExit(e)){const i=e.dragSource.getDragItem().columns;this.setColumnsVisible(i,!1,"uiColumnDragged")}}handleDragLeaveEnd(e){if(this.showOrHideColumnOnExit(e)){const s=e.dragSource.getDragItem();this.setColumnsVisible(s.columns,!0,"uiColumnDragged")}}setColumnsVisible(e,t,s){if(e){const i=e.filter(r=>!r.getColDef().lockVisible);this.columnModel.setColsVisible(i,t,s)}}isRowGroupPanel(){return"rowGroup"===this.dropZonePurpose}createPillComponent(e,t,s,i){return new Ci(e,t,s,this.dropZonePurpose,i)}},Ue=class extends He{constructor(e){super(e,"pivot")}postConstruct(){const e=this.localeService.getLocaleTextFunc(),t=e("pivotColumnsEmptyMessage","Drag here to set column labels"),s=e("pivots","Column Labels");super.init({icon:(0,n.asF)("pivotPanel",this.gos,null),emptyMessage:t,title:s}),this.addManagedEventListeners({newColumnsLoaded:this.refresh.bind(this),columnPivotChanged:this.refresh.bind(this),columnPivotModeChanged:this.checkVisibility.bind(this)}),this.refresh()}getAriaLabel(){return this.localeService.getLocaleTextFunc()("ariaPivotDropZonePanelLabel","Column Labels")}getTooltipParams(){const e=super.getTooltipParams();return e.location="pivotColumnsList",e}refresh(){this.checkVisibility(),this.refreshGui()}checkVisibility(){const e=this.columnModel.isPivotMode();if(this.isHorizontal())switch(this.gos.get("pivotPanelShow")){case"always":this.setDisplayed(e);break;case"onlyWhenPivoting":{const t=this.columnModel.isPivotActive();this.setDisplayed(e&&t);break}default:this.setDisplayed(!1)}else this.setDisplayed(e)}isItemDroppable(e,t){return!(this.gos.get("functionsReadOnly")||!e.isPrimary())&&e.isAllowPivot()&&(!e.isPivotActive()||this.isSourceEventFromTarget(t))}updateItems(e){this.funcColsService.setPivotColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?"pivot":"notAllowed"}getExistingItems(){return this.funcColsService.getPivotColumns()}},_e=class extends He{constructor(e){super(e,"rowGroup")}postConstruct(){const e=this.localeService.getLocaleTextFunc(),t=e("rowGroupColumnsEmptyMessage","Drag here to set row groups"),s=e("groups","Row Groups");super.init({icon:(0,n.asF)("rowGroupPanel",this.gos,null),emptyMessage:t,title:s}),this.addManagedEventListeners({columnRowGroupChanged:this.refreshGui.bind(this)})}getAriaLabel(){return this.localeService.getLocaleTextFunc()("ariaRowGroupDropZonePanelLabel","Row Groups")}getTooltipParams(){const e=super.getTooltipParams();return e.location="rowGroupColumnsList",e}isItemDroppable(e,t){return!(this.gos.get("functionsReadOnly")||!e.isPrimary())&&e.isAllowRowGroup()&&(!e.isRowGroupActive()||this.isSourceEventFromTarget(t))}updateItems(e){this.funcColsService.setRowGroupColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?"group":"notAllowed"}getExistingItems(){return this.funcColsService.getRowGroupColumns()}},wi={selector:"AG-GRID-HEADER-DROP-ZONES",component:class extends n.uAl{wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}constructor(){super()}postConstruct(){this.setGui(this.createNorthPanel());const e=this.onRowGroupChanged.bind(this);this.addManagedEventListeners({columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedPropertyListener("rowGroupPanelShow",e),this.addManagedPropertyListener("pivotPanelShow",()=>this.onPivotPanelShow()),this.onRowGroupChanged()}createNorthPanel(){const e=document.createElement("div");e.classList.add("ag-column-drop-wrapper"),(0,n.lXX)(e,"presentation"),this.rowGroupComp=new _e(!0),this.createManagedBean(this.rowGroupComp),this.pivotComp=new Ue(!0),this.createManagedBean(this.pivotComp),e.appendChild(this.rowGroupComp.getGui()),e.appendChild(this.pivotComp.getGui());const t=this.onDropPanelVisible.bind(this);return this.addManagedListeners(this.rowGroupComp,{displayChanged:t}),this.addManagedListeners(this.pivotComp,{displayChanged:t}),this.onDropPanelVisible(),e}onDropPanelVisible(){const e=this.rowGroupComp.isDisplayed()&&this.pivotComp.isDisplayed(),t="ag-column-drop-horizontal-half-width";this.rowGroupComp.addOrRemoveCssClass(t,e),this.pivotComp.addOrRemoveCssClass(t,e)}onRowGroupChanged(){if(!this.rowGroupComp)return;const e=this.gos.get("rowGroupPanelShow");if("always"===e)this.rowGroupComp.setDisplayed(!0);else if("onlyWhenGrouping"===e){const t=!this.funcColsService.isRowGroupEmpty();this.rowGroupComp.setDisplayed(t)}else this.rowGroupComp.setDisplayed(!1)}onPivotPanelShow(){if(!this.pivotComp)return;const e=this.gos.get("pivotPanelShow");if("always"===e)this.pivotComp.setDisplayed(!0);else if("onlyWhenPivoting"===e){const t=this.columnModel.isPivotActive();this.pivotComp.setDisplayed(t)}else this.pivotComp.setDisplayed(!1)}}},ze=class{constructor(){this.allSets={},this.allParents=[]}removeFromChildrenAfterGroup(e,t){this.getSet(e).removeFromChildrenAfterGroup[t.id]=!0}isRemoveFromAllLeafChildren(e,t){return!!this.getSet(e).removeFromAllLeafChildren[t.id]}preventRemoveFromAllLeafChildren(e,t){delete this.getSet(e).removeFromAllLeafChildren[t.id]}removeFromAllLeafChildren(e,t){this.getSet(e).removeFromAllLeafChildren[t.id]=!0}getSet(e){return this.allSets[e.id]||(this.allSets[e.id]={removeFromAllLeafChildren:{},removeFromChildrenAfterGroup:{}},this.allParents.push(e)),this.allSets[e.id]}getAllParents(){return this.allParents}flush(){this.allParents.forEach(e=>{const t=this.allSets[e.id];e.childrenAfterGroup=e.childrenAfterGroup.filter(i=>!t.removeFromChildrenAfterGroup[i.id]),e.allLeafChildren=e.allLeafChildren?.filter(i=>!t.removeFromAllLeafChildren[i.id])??null,e.updateHasChildren();const s=e.sibling;s&&(s.childrenAfterGroup=e.childrenAfterGroup,s.allLeafChildren=e.allLeafChildren)}),this.allSets={},this.allParents.length=0}};function Mt(e,t){const s=e.sourceRowIndex,i=t.sourceRowIndex,r=s>=0,o=i>=0;return r&&o?s-i:r||o?r?1:-1:e.__objectId-t.__objectId}var Ai=class extends n.XQb{wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.selectionService=e.selectionService,this.showRowGroupColsService=e.showRowGroupColsService}execute(e){const t=this.createGroupingDetails(e);t.transactions?this.handleTransaction(t):this.shotgunResetEverything(t,!0===e.afterColumnsChanged),this.positionLeafsAndGroups(e.changedPath),this.orderGroups(t)}positionLeafsAndGroups(e){e.forEachChangedNodeDepthFirst(t=>{if(t.childrenAfterGroup){const s=[],i=[];let r;t.childrenAfterGroup.forEach(o=>{o.childrenAfterGroup?.length?""!==o.key||r?i.push(o):r=o:s.push(o)}),r&&i.push(r),t.childrenAfterGroup=[...s,...i]}},!1)}createGroupingDetails(e){const{rowNode:t,changedPath:s,rowNodeTransactions:i,rowNodesOrderChanged:r}=e,o=this.funcColsService.getRowGroupColumns();return{expandByDefault:this.gos.get("groupDefaultExpanded"),groupedCols:o,rootNode:t,pivotMode:this.columnModel.isPivotMode(),groupedColCount:o?.length??0,transactions:i,rowNodesOrderChanged:!!r,changedPath:s,groupAllowUnbalanced:this.gos.get("groupAllowUnbalanced"),isGroupOpenByDefault:this.gos.getCallback("isGroupOpenByDefault"),initialGroupOrderComparator:this.gos.getCallback("initialGroupOrderComparator"),suppressGroupMaintainValueType:this.gos.get("suppressGroupMaintainValueType"),keyCreators:o?.map(a=>a.getColDef().keyCreator)??[]}}handleTransaction(e){e.transactions.forEach(t=>{const s=new ze;(0,n.Rer)(t.remove)&&this.removeNodes(t.remove,e,s),(0,n.Rer)(t.update)&&this.moveNodesInWrongPath(t.update,e,s),(0,n.Rer)(t.add)&&this.insertNodes(t.add,e);const i=s.getAllParents().slice();s.flush(),this.removeEmptyGroups(i,e)}),e.rowNodesOrderChanged&&this.sortChildren(e)}sortChildren(e){e.changedPath.forEachChangedNodeDepthFirst(t=>{(function Mi(e){if(!e)return!1;const t=e.length;if(t<2)return!1;let s=!1;for(let i=1;i<t;i++)if(Mt(e[i-1],e[i])>0){s=!0;break}return!!s&&(e.sort(Mt),!0)})(t.childrenAfterGroup)&&e.changedPath.addParentNode(t)},!1,!0)}orderGroups(e){const t=e.initialGroupOrderComparator;(0,n.Qmv)(t)&&function s(i){(0,n.Qmv)(i.childrenAfterGroup)&&!i.leafGroup&&(i.childrenAfterGroup.sort((o,l)=>t({nodeA:o,nodeB:l})),i.childrenAfterGroup.forEach(o=>s(o)))}(e.rootNode)}getExistingPathForNode(e,t){const s=[];let i=e.parent;for(;i&&i!==t.rootNode;)s.push({key:i.key,rowGroupColumn:i.rowGroupColumn,field:i.field}),i=i.parent;return s.reverse(),s}moveNodesInWrongPath(e,t,s){e.forEach(i=>{t.changedPath.isActive()&&t.changedPath.addParentNode(i.parent);const r=d=>d.key,o=this.getExistingPathForNode(i,t).map(r),l=this.getGroupInfo(i,t).map(r);(0,n.MpY)(o,l)||this.moveNode(i,t,s)})}moveNode(e,t,s){this.removeNodesFromParents([e],t,s),this.insertOneNode(e,t,s),e.setData(e.data),t.changedPath.isActive()&&t.changedPath.addParentNode(e.parent)}removeNodes(e,t,s){this.removeNodesFromParents(e,t,s),t.changedPath.isActive()&&e.forEach(i=>t.changedPath.addParentNode(i.parent))}forEachParentGroup(e,t,s){let i=t;for(;i&&i!==e.rootNode;)s(i),i=i.parent}removeNodesFromParents(e,t,s){const i=null==s,r=s||new ze;e.forEach(o=>{this.removeFromParent(o,r),this.forEachParentGroup(t,o.parent,l=>{r.removeFromAllLeafChildren(l,o)})}),i&&r.flush()}removeEmptyGroups(e,t){let s=!0;const i=r=>{const o=this.getChildrenMappedKey(r.key,r.rowGroupColumn),l=r.parent;return!(!l?.childrenMapped||!l.childrenMapped[o]||!r.group||0!==(r.childrenAfterGroup?.length??0))};for(;s;){s=!1;const r=new ze;e.forEach(o=>{this.forEachParentGroup(t,o,l=>{i(l)&&(s=!0,this.removeFromParent(l,r),l.setSelectedParams({newValue:!1,source:"rowGroupChanged"}))})}),r.flush()}}removeFromParent(e,t){e.parent&&(t?t.removeFromChildrenAfterGroup(e.parent,e):((0,n.$ii)(e.parent.childrenAfterGroup,e),e.parent.updateHasChildren()));const s=this.getChildrenMappedKey(e.key,e.rowGroupColumn);e.parent?.childrenMapped&&delete e.parent.childrenMapped[s],e.setRowTop(null),e.setRowIndex(null)}addToParent(e,t){const s=this.getChildrenMappedKey(e.key,e.rowGroupColumn);t?.childrenMapped&&t.childrenMapped[s]!==e&&(t.childrenMapped[s]=e,t.childrenAfterGroup.push(e),t.setGroup(!0))}areGroupColsEqual(e,t){return null!=e&&null!=t&&e.pivotMode===t.pivotMode&&(0,n.MpY)(e.groupedCols,t.groupedCols)&&(0,n.MpY)(e.keyCreators,t.keyCreators)}checkAllGroupDataAfterColsChanged(e){const t=s=>{s&&s.forEach(i=>{i.group&&(this.setGroupData(i,{field:i.field,key:i.key,rowGroupColumn:i.rowGroupColumn,leafNode:i.allLeafChildren?.[0]},e),t(i.childrenAfterGroup))})};t(e.rootNode.childrenAfterGroup)}shotgunResetEverything(e,t){if(this.noChangeInGroupingColumns(e,t))return;this.selectionService.filterFromSelection(o=>o&&!o.group);const{groupedCols:s}=e,i=e.rootNode;i.leafGroup=0===s.length,i.childrenAfterGroup=[],i.childrenMapped={},i.updateHasChildren();const r=i.sibling;r&&(r.childrenAfterGroup=i.childrenAfterGroup,r.childrenMapped=i.childrenMapped),this.insertNodes(i.allLeafChildren,e)}noChangeInGroupingColumns(e,t){let s=!1;const i=this.showRowGroupColsService.getShowRowGroupCols(),r=i?i.map(o=>o.getId()).join("-"):"";return t&&(s=this.areGroupColsEqual(e,this.oldGroupingDetails),this.oldGroupDisplayColIds!==r&&this.checkAllGroupDataAfterColsChanged(e)),this.oldGroupingDetails=e,this.oldGroupDisplayColIds=r,s}insertNodes(e,t){e.forEach(s=>{this.insertOneNode(s,t),t.changedPath.isActive()&&t.changedPath.addParentNode(s.parent)})}insertOneNode(e,t,s){const i=this.getGroupInfo(e,t),r=this.findParentForNode(e,i,t,s);r.group||(0,n.JT7)("duplicate group keys for row data, keys should be unique",[r.data,e.data]),e.parent=r,e.level=i.length,r.childrenAfterGroup.push(e),r.updateHasChildren()}findParentForNode(e,t,s,i){let r=s.rootNode;return t.forEach((o,l)=>{r=this.getOrCreateNextNode(r,o,l,s),i?.isRemoveFromAllLeafChildren(r,e)?i?.preventRemoveFromAllLeafChildren(r,e):r.allLeafChildren.push(e)}),r}getOrCreateNextNode(e,t,s,i){const r=this.getChildrenMappedKey(t.key,t.rowGroupColumn);let o=e?.childrenMapped?.[r];return o||(o=this.createGroup(t,e,s,i),this.addToParent(o,e)),o}createGroup(e,t,s,i){const r=new n.TUE(this.beans);return r.group=!0,r.field=e.field,r.rowGroupColumn=e.rowGroupColumn,this.setGroupData(r,e,i),r.key=e.key,r.id=this.createGroupId(r,t,s),r.level=s,r.leafGroup=s===i.groupedColCount-1,r.allLeafChildren=[],r.setAllChildrenCount(0),r.rowGroupIndex=s,r.childrenAfterGroup=[],r.childrenMapped={},r.updateHasChildren(),r.parent=t,this.setExpandedInitialValue(i,r),r}createGroupId(e,t,s){const i=(r,o)=>{if(!r.rowGroupColumn)return null;const l=o?i(o,o.parent,0):null;return`${null==l?"":l+"-"}${r.rowGroupColumn.getColId()}-${r.key}`};return n.TUE.ID_PREFIX_ROW_GROUP+i(e,t,s)}setGroupData(e,t,s){e.groupData={},this.showRowGroupColsService.getShowRowGroupCols().forEach(r=>{const o=e.rowGroupColumn;null!==o&&r.isRowGroupDisplayed(o.getId())&&(e.groupData[r.getColId()]=s.suppressGroupMaintainValueType?t.key:this.valueService.getValue(o,t.leafNode))})}getChildrenMappedKey(e,t){return t?t.getId()+"-"+e:e}setExpandedInitialValue(e,t){if(e.pivotMode&&t.leafGroup)return void(t.expanded=!1);const s=e.isGroupOpenByDefault;t.expanded=s?1==s({rowNode:t,field:t.field,key:t.key,level:t.level,rowGroupColumn:t.rowGroupColumn}):-1===e.expandByDefault||t.level<e.expandByDefault}getGroupInfo(e,t){const s=[];return t.groupedCols.forEach(i=>{let r=this.valueService.getKeyForNode(i,e),o=null!=r&&""!==r;if((t.pivotMode||!t.groupAllowUnbalanced)&&!o&&(r="",o=!0),o){const a={key:r,field:i.getColDef().field,rowGroupColumn:i,leafNode:e};s.push(a)}}),s}},bi=(e,t)=>e.treeNode.oldSourceRowIndex-t.treeNode.oldSourceRowIndex,E=Object.freeze([]),Pi=E.values(),ve=(e,t)=>{e.parent=null,e.treeNode=null,t?e.childrenAfterGroup=[]:(e.level=0,e.childrenAfterGroup=null,e.allLeafChildren=null)},Ei=class Rs{constructor(t,s,i){this.parent=t,this.key=s,this.level=i,this.children=null,this.invalidatedHead=null,this.invalidatedNext=void 0,this.row=null,this.oldRow=null,this.duplicateRows=null,this.childrenAfterGroup=E,this.allLeafChildren=E,this.childrenChanged=!1,this.leafChildrenChanged=!1,this.oldSourceRowIndex=-1}isEmptyFillerNode(){return!this.row?.data&&!this.children?.size}hasChildren(){return!!this.children?.size}enumChildren(){return this.children?.values()??Pi}upsertKey(t){"string"!=typeof t&&(t=String(t));let s=this.children?.get(t);return s||(s=new Rs(this,t,this.level+1),(this.children??(this.children=new Map))?.set(s.key,s)),s}destroy(){const{row:t,parent:s}=this;null!==s&&(s?.children?.delete(this.key),null!==t&&ve(t,!0),this.parent=null)}setRow(t){const{level:s,row:i,childrenAfterGroup:r}=this;if(s<0)null!==i&&i!==t&&ve(i,!0);else{if(i===t)return!1;null!==i?(t.allLeafChildren=i.allLeafChildren??this.allLeafChildren??E,ve(i,!1)):t.allLeafChildren=this.allLeafChildren??E}return t.level=s,t.childrenAfterGroup=r,t.treeNode=this,this.row=t,!0}removeRow(t){const{level:s,row:i,duplicateRows:r,childrenAfterGroup:o}=this;if(i===t){const l=this.popDuplicateRow();l?(this.row=l,l.childrenAfterGroup=o,s>=0&&(l.allLeafChildren=i.allLeafChildren??this.allLeafChildren??E)):this.row=null}else{if(!r?.delete(t))return!1;0===r.size&&(this.duplicateRows=null)}return ve(t,s<0),!0}addDuplicateRow(t){const{level:s}=this;let i=this.duplicateRows;if(null===i)i=new Set,this.duplicateRows=i;else if(i.has(t))return!1;return i.add(t),t.treeNode=this,t.level=s,s>=0&&(t.allLeafChildren=E),t.childrenAfterGroup=E,!0}sortFirstDuplicateRow(){const t=this.duplicateRows,s=this.row;if(!s||!t)return s;let i=s;for(const r of t)r.sourceRowIndex<i.sourceRowIndex&&(i=r);return i!==s&&(i.childrenAfterGroup=this.childrenAfterGroup,i.allLeafChildren=s.allLeafChildren??this.allLeafChildren??E,s.childrenAfterGroup=E,s.allLeafChildren=E,t.delete(i),t.add(s),this.row=i),i}popDuplicateRow(){let t=null;const s=this.duplicateRows;return null!==s&&(t=s.values().next().value,null!==t&&s.delete(t)&&0===s.size&&(this.duplicateRows=null)),t}dequeueInvalidated(){const t=this.invalidatedHead;return null!==t&&(this.invalidatedHead=t.invalidatedNext??null,t.invalidatedNext=void 0),t}invalidate(){let t=this,s=this.parent;for(;null!==s&&void 0===t.invalidatedNext;)t.invalidatedNext=s.invalidatedHead,s.invalidatedHead=t,t=s,s=t.parent}invalidateOrder(){const t=this.parent;null!==t&&!t.childrenChanged&&((this.children?.size??0)>1||!t.row?.data)&&(t.childrenChanged=!0,t.invalidate())}getRowPosition(){const t=this.row;return t?.data?t.sourceRowIndex:this.childrenAfterGroup[0]?.treeNode?.oldSourceRowIndex??this.oldSourceRowIndex}updateChildrenAfterGroup(){this.childrenChanged=!1;const t=this.children?.size??0;if(0===t)return 0!==this.childrenAfterGroup.length&&(this.leafChildrenChanged=!0,this.childrenAfterGroup=E,this.row.childrenAfterGroup=E,!0);let s=!1,i=this.childrenAfterGroup;i===E?(i=new Array(t),this.childrenAfterGroup=i,this.row.childrenAfterGroup=i,s=!0):i.length!==t&&(i.length=t,s=!0);let r=0,o=-1,l=!1;for(const a of this.enumChildren()){const d=a.getRowPosition();d<o&&(l=!0),o=d,a.oldSourceRowIndex=d;const u=a.row;i[r]!==u&&(i[r]=u,s=!0),++r}return s&&(this.leafChildrenChanged=!0),l&&this.reorderChildrenList(i),s||l}reorderChildrenList(t){const s=t.length,i=this.children;t.sort(bi),i.clear();for(let r=0;r<s;++r){const o=t[r].treeNode;i.set(o.key,o)}}updateAllLeafChildren(){const{parent:t,row:s,childrenAfterGroup:i}=this;this.leafChildrenChanged=!1;let r=!1;const o=i.length;if(0===o)r=0!==s.allLeafChildren?.length,s.allLeafChildren=E,this.allLeafChildren=E;else if(1===o&&i[0].allLeafChildren?.length)s.allLeafChildren=i[0].allLeafChildren,this.allLeafChildren=null,r=!0;else{let l=this.allLeafChildren;(l===E||null===l)&&(l=[],this.allLeafChildren=l);const a=l.length;let d=0;for(let u=0;u<o;++u){const h=i[u],c=h.allLeafChildren,p=c.length;if(p)for(let g=0;g<p;++g){const f=c[g];(d>=a||l[d]!==f)&&(l[d]=f,r=!0),++d}else(d>=a||l[d]!==h)&&h&&(l[d]=h,r=!0),++d}a!==d&&(l.length=d,r=!0),s.allLeafChildren!==l&&(s.allLeafChildren=l,r=!0)}r&&t&&(t.leafChildrenChanged=!0)}},At=e=>!!(1&e.treeNodeFlags),bt=e=>!!(2&e.treeNodeFlags),Pt=e=>!!(4&e.treeNodeFlags),Et=e=>!!(16&e.treeNodeFlags),Tt=(e,t)=>{t?e.treeNodeFlags|=2:e.treeNodeFlags&=-3},_=e=>{e.treeNodeFlags|=16},Dt=e=>{e.treeNodeFlags=1|-29&e.treeNodeFlags},ae=e=>{e.treeNodeFlags=0},Ii=class extends n.XQb{constructor(){super(...arguments),this.rowsPendingDestruction=null,this.root=new Ei(null,"",-1)}wireBeans(e){this.beans=e,this.showRowGroupColsService=e.showRowGroupColsService}destroy(){const e=this.root.row;null!==e&&(this.root.removeRow(e),ae(e)),this.destroyTree(this.root),this.commitDestroyedRows(),super.destroy()}execute(e){const{rowNodeTransactions:t,rowNodesOrderChanged:s,changedPath:i}=e,r=e.rowNode,o=this.gos,l={changedPath:i,expandByDefault:o.get("groupDefaultExpanded"),suppressGroupMaintainValueType:o.get("suppressGroupMaintainValueType"),getDataPath:o.get("getDataPath"),isGroupOpenByDefault:o.getCallback("isGroupOpenByDefault"),initialGroupOrderComparator:o.getCallback("initialGroupOrderComparator")};this.root.setRow(r),r.leafGroup=!1;const d=r.sibling;d&&(d.childrenAfterGroup=r.childrenAfterGroup,d.childrenMapped=r.childrenMapped),t?this.handleTransaction(l,t,s):this.handleRowData(l,r,!0===e.afterColumnsChanged)}handleRowData(e,t,s){const i=this.root;if(s||void 0===this.oldGroupDisplayColIds){const r=this.showRowGroupColsService?.getShowRowGroupCols()?.map(o=>o.getId()).join("-")??"";if(s)return void(this.oldGroupDisplayColIds!==r&&this.checkAllGroupDataAfterColsChanged(i.row?.childrenAfterGroup));this.oldGroupDisplayColIds=r}this.clearTree(i),this.addOrUpdateRows(e,t.allLeafChildren,!1),this.commitTree(e)}handleTransaction(e,t,s){for(const{remove:i,update:r,add:o}of t)this.removeRows(i),this.addOrUpdateRows(e,r,!0),this.addOrUpdateRows(e,o,!1);s&&this.handleRowNodesOrderChanged(),this.commitTree(e)}handleRowNodesOrderChanged(){const e=this.root.row?.allLeafChildren;if(e)for(let t=0,s=e.length;t<s;++t){const i=e[t].treeNode;i&&i.oldSourceRowIndex!==t&&i.invalidateOrder()}}checkAllGroupDataAfterColsChanged(e){for(let t=0,s=e?.length??0;t<s;++t){const i=e[t];this.setGroupData(i,i.treeNode?.key??i.key),this.checkAllGroupDataAfterColsChanged(i.childrenAfterGroup)}}addOrUpdateRows(e,t,s){for(let i=0,r=t?.length??0;i<r;++i){const o=t[i],l=this.upsertPath(this.getDataPath(e,o));l&&this.addOrUpdateRow(l,o,s)}}removeRows(e){for(let t=0,s=e?.length??0;t<s;++t){const i=e[t],r=i.treeNode;null!==r&&this.removeRow(r,i)}}getDataPath({getDataPath:e},{data:t}){const s=e?.(t)||E;return s.length||(0,n.JT7)("getDataPath() should not return an empty path",[t]),s}upsertPath(e){let t=this.root;const s=e.length-1;for(let i=0;i<=s;++i){const r=t.upsertKey(e[i]);if(i>=s)return r.invalidate(),r;t=r}return null}addOrUpdateRow(e,t,s){const{level:i,row:r}=e;if(i<0)return;let o=!1;if(r!==t){const l=t.treeNode;null!==l&&l!==e&&(l.removeRow(t),l.invalidate()),null===r?(e.setRow(t),o=!0):r.data?e.addDuplicateRow(t)&&(o=!0):(e.setRow(t),this.destroyRow(r,!0),o=!0)}s&&!Pt(t)&&((e=>{const t=e.treeNodeFlags;1&t&&(e.treeNodeFlags=4|t)})(t),o=!0),o&&e.invalidate(),this.rowsPendingDestruction?.delete(t)}removeRow(e,t){const{parent:s,level:i}=e;if(i<0)return;let r=!1;e.removeRow(t)&&(r=!0,s&&(s.childrenChanged=!0),this.destroyRow(t,!t.data)),r&&e.invalidate()}commitTree(e){const t=this.root;this.commitInvalidatedChildren(e,t);const s=t.row;t.childrenChanged&&t.updateChildrenAfterGroup()&&_(s),s.updateHasChildren(),Et(s)&&e.changedPath?.isActive()&&e.changedPath.addParentNode(s),Dt(s),this.commitDestroyedRows()}commitInvalidatedChildren(e,t){for(;;){const s=t.dequeueInvalidated();if(null===s)break;s.parent===t&&this.commitChild(e,t,s)}}commitChild(e,t,s){s.isEmptyFillerNode()?this.clearTree(s):(this.commitNodePreOrder(t,s),this.commitInvalidatedChildren(e,s),this.commitNodePostOrder(e,t,s))}commitNodePreOrder(e,t){let s=t.row;if(null===s?(s=this.createFillerRow(t),t.setRow(s)):(s=t.sortFirstDuplicateRow(),void 0===s.allChildrenCount&&(s.allChildrenCount=null)),s.parent=e.row,t.oldRow!==s)for(const r of t.enumChildren()){const o=r.row;null!==o&&(o.parent=s)}const i=t.key;s.key!==i?(s.key=i,(e=>{const t=e.treeNodeFlags;1&t&&(e.treeNodeFlags=12|t)})(s),this.setGroupData(s,i)):s.groupData||this.setGroupData(s,i)}commitNodePostOrder(e,t,s){const i=s.row,r=s.oldRow;if(s.isEmptyFillerNode())return void this.clearTree(s);s.childrenChanged&&s.updateChildrenAfterGroup()&&_(i),s.leafChildrenChanged&&s.updateAllLeafChildren();const o=s.getRowPosition();s.oldSourceRowIndex!==o&&(s.oldSourceRowIndex=o,t.childrenChanged=!0);const l=!!i.childrenAfterGroup?.length,a=l||!i.data,d=i.group;d!==a?(_(i),i.setGroup(a),!a&&!i.expanded&&Tt(i,!1)):i.hasChildren()!==l&&(_(i),i.updateHasChildren()),i.group&&!bt(i)&&(i.expanded=r!==i&&null!==r&&r.group&&bt(r)&&!e.isGroupOpenByDefault?r.expanded:this.getExpandedInitialValue(e,i),Tt(i,!0)),Pt(i)&&(_(t.row),(e=>!!(8&e.treeNodeFlags))(i)&&i.setData(i.data)),r!==i&&(s.oldRow=i,null!==r&&(d||s.hasChildren())&&_(i),t.childrenChanged=!0,_(t.row)),Et(i)?e.changedPath?.isActive()&&e.changedPath.addParentNode(i):At(i)||(i.childrenAfterFilter||(i.childrenAfterFilter=i.childrenAfterGroup.slice()),i.childrenAfterAggFilter||(i.childrenAfterAggFilter=i.childrenAfterFilter.slice()),i.childrenAfterSort||(i.childrenAfterSort=i.childrenAfterAggFilter.slice())),Dt(i),s.duplicateRows?.size&&!s.duplicateRowsWarned&&(s.duplicateRowsWarned=!0,(0,n.JT7)("duplicate group keys for row data, keys should be unique",[i.id,i.data,...Array.from(s.duplicateRows).map(u=>u.data)]))}createFillerRow(e){const t=new n.TUE(this.beans);t.key=e.key,t.group=!0,t.field=null,t.leafGroup=!1,t.rowGroupIndex=null,t.allChildrenCount=null;let s=e.level+"-"+e.key,i=e.parent;for(;null!==i;){const r=i.parent;if(null===r)break;s=`${i.level}-${i.key}-${s}`,i=r}return t.id=n.TUE.ID_PREFIX_ROW_GROUP+s,t}setGroupData(e,t){const s={};e.groupData=s;const i=this.showRowGroupColsService?.getShowRowGroupCols();if(i)for(const r of i)s[r.getColId()]=t}getExpandedInitialValue(e,t){const s=e.isGroupOpenByDefault;return s?1==s({rowNode:t,field:t.field,key:t.key,level:t.level,rowGroupColumn:t.rowGroupColumn}):-1===e.expandByDefault||t.level<e.expandByDefault}clearTree(e){const{parent:t,oldRow:s,row:i,level:r}=e;if(null!==t&&null!==s&&(t.childrenChanged=!0,null!==t.row&&_(t.row)),null!==i&&r>=0){let o=e.row;for(;null!==o&&e.removeRow(o);)this.destroyRow(o,!o.data),o=e.row}for(const o of e.enumChildren())this.clearTree(o);e.destroy()}destroyTree(e){const{row:t,level:s,duplicateRows:i}=e;if(t&&(s>=0&&!t.data?this.destroyRow(t,!0):ae(t)),i)for(const r of i)s>=0&&!r.data?this.destroyRow(r,!0):ae(r);for(const r of e.enumChildren())this.destroyTree(r);e.destroy()}destroyRow(e,t){At(e)?t?(ae(e),e.setRowIndex(null),e.setRowTop(null),!e.data&&e.isSelected()&&e.setSelectedParams({newValue:!1,source:"rowGroupChanged"})):(this.rowsPendingDestruction??(this.rowsPendingDestruction=new Set)).add(e):ae(e)}commitDestroyedRows(){const{rowsPendingDestruction:e}=this;if(null!==e){this.rowsPendingDestruction=null;for(const t of e)this.destroyRow(t,!0)}}},Gt="PivotRowTotal_",It="Exceeded maximum allowed pivot column count.",de="32.3.3",Ke=(0,n.n9N)({version:de,moduleName:`${n.zsj.RowGroupingModule}-core`,beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="aggregationStage"}wireBeans(e){this.columnModel=e.columnModel,this.aggFuncService=e.aggFuncService,this.funcColsService=e.funcColsService,this.pivotResultColsService=e.pivotResultColsService,this.valueService=e.valueService}execute(e){const t=(0,n.Wgl)(this.funcColsService.getValueColumns()),s=!this.gos.getCallback("getGroupRowAgg"),i=e.changedPath&&e.changedPath.isActive();if(t&&s&&i)return;const r=this.createAggDetails(e);this.recursivelyCreateAggData(r)}createAggDetails(e){const t=this.columnModel.isPivotActive(),s=this.funcColsService.getValueColumns(),i=t?this.funcColsService.getPivotColumns():[];return{alwaysAggregateAtRootLevel:this.gos.get("alwaysAggregateAtRootLevel"),groupIncludeTotalFooter:!!(0,n.UcN)(this.gos),changedPath:e.changedPath,valueColumns:s,pivotColumns:i,filteredOnly:!this.isSuppressAggFilteredOnly(),userAggFunc:this.gos.getCallback("getGroupRowAgg")}}isSuppressAggFilteredOnly(){return void 0!==(0,n.euU)(this.gos)||this.gos.get("suppressAggFilteredOnly")}recursivelyCreateAggData(e){e.changedPath.forEachChangedNodeDepthFirst(s=>{if(s.hasChildren()){if(-1===s.level&&!e.groupIncludeTotalFooter){const o=!this.columnModel.isPivotMode();if(!e.alwaysAggregateAtRootLevel&&o)return void s.setAggData(null)}this.aggregateRowNode(s,e)}else s.aggData&&s.setAggData(null)},!0)}aggregateRowNode(e,t){const s=0===t.valueColumns.length,i=0===t.pivotColumns.length;let r;r=t.userAggFunc?t.userAggFunc({nodes:e.childrenAfterFilter}):s?null:i?this.aggregateRowNodeUsingValuesOnly(e,t):this.aggregateRowNodeUsingValuesAndPivot(e),e.setAggData(r),e.sibling&&e.sibling.setAggData(r)}aggregateRowNodeUsingValuesAndPivot(e){const t={},s=this.pivotResultColsService.getPivotResultCols()?.list??[];let i=!0;for(let r=0;r<s.length;r++){const o=s[r],l=o.getColDef();if(null!=l.pivotTotalColumnIds){i=!1;continue}let d;d=e.leafGroup?this.getValuesFromMappedSet(e.childrenMapped,l.pivotKeys??[],l.pivotValueColumn):this.getValuesPivotNonLeaf(e,l.colId),t[l.colId]=this.aggregateValues(d,l.pivotValueColumn.getAggFunc(),l.pivotValueColumn,e,o)}if(!i)for(let r=0;r<s.length;r++){const o=s[r],l=o.getColDef();if(null==l.pivotTotalColumnIds||!l.pivotTotalColumnIds.length)continue;const a=l.pivotTotalColumnIds.map(d=>t[d]);t[l.colId]=this.aggregateValues(a,l.pivotValueColumn.getAggFunc(),l.pivotValueColumn,e,o)}return t}aggregateRowNodeUsingValuesOnly(e,t){const s={},i=t.changedPath.isActive()?t.changedPath.getValueColumnsForNode(e,t.valueColumns):t.valueColumns,r=t.changedPath.isActive()?t.changedPath.getNotValueColumnsForNode(e,t.valueColumns):null,o=this.getValuesNormal(e,i,t.filteredOnly),l=e.aggData;return i.forEach((a,d)=>{s[a.getId()]=this.aggregateValues(o[d],a.getAggFunc(),a,e)}),r&&l&&r.forEach(a=>{s[a.getId()]=l[a.getId()]}),s}getValuesPivotNonLeaf(e,t){return e.childrenAfterFilter.map(s=>s.aggData[t])}getValuesFromMappedSet(e,t,s){let i=e;for(let r=0;r<t.length;r++)i=i?i[t[r]]:null;return i?i.map(r=>this.valueService.getValue(s,r)):[]}getValuesNormal(e,t,s){const i=[];t.forEach(()=>i.push([]));const r=t.length,o=s?e.childrenAfterFilter:e.childrenAfterGroup,l=o.length;for(let a=0;a<l;a++){const d=o[a];for(let u=0;u<r;u++){const c=this.valueService.getValue(t[u],d);i[u].push(c)}}return i}aggregateValues(e,t,s,i,r){const o="string"==typeof t?this.aggFuncService.getAggFunc(t):t;return"function"!=typeof o?((0,n.D1O)(`unrecognised aggregation function ${t}`),null):o(this.gos.addGridCommonParams({values:e,column:s,colDef:s?s.getColDef():void 0,pivotResultColumn:r,rowNode:i,data:i?i.data:void 0}))}},class extends n.XQb{constructor(){super(...arguments),this.beanName="filterAggregatesStage"}wireBeans(e){this.filterManager=e.filterManager,this.columnModel=e.columnModel}execute(e){const t=this.columnModel.isPivotMode(),s=this.filterManager?.isAggregateFilterPresent()||this.filterManager?.isAggregateQuickFilterPresent(),o=(0,n.euU)(this.gos)||(t?u=>u.node.leafGroup:u=>!u.node.group),{changedPath:l}=e,a=(u,h=!1)=>{u.childrenAfterFilter&&(u.childrenAfterAggFilter=u.childrenAfterFilter,h&&u.childrenAfterAggFilter.forEach(c=>a(c,h)),this.setAllChildrenCount(u)),u.sibling&&(u.sibling.childrenAfterAggFilter=u.childrenAfterAggFilter)};l.forEachChangedNodeDepthFirst(s?u=>{u.childrenAfterAggFilter=u.childrenAfterFilter?.filter(h=>o({node:h})&&this.filterManager.doesRowPassAggregateFilters({rowNode:h})?(a(h,!0),!0):h.childrenAfterAggFilter?.length)||null,this.setAllChildrenCount(u),u.sibling&&(u.sibling.childrenAfterAggFilter=u.childrenAfterAggFilter)}:a,!0)}setAllChildrenCountTreeData(e){const t=e.childrenAfterAggFilter;let s=0;if(t){const i=t.length;s=i;for(let r=0;r<i;++r)s+=t[r].allChildrenCount??0}e.setAllChildrenCount(0===s&&e.level>=0?null:s)}setAllChildrenCountGridGrouping(e){let t=0;e.childrenAfterAggFilter.forEach(s=>{s.group?t+=s.allChildrenCount:t++}),e.setAllChildrenCount(t)}setAllChildrenCount(e){e.hasChildren()?this.gos.get("treeData")?this.setAllChildrenCountTreeData(e):this.setAllChildrenCountGridGrouping(e):e.setAllChildrenCount(null)}},class extends n.XQb{constructor(){super(...arguments),this.beanName="groupStage"}wireBeans(e){this.selectableService=e.selectableService}execute(e){const t=this.gos.get("treeData")?Ii:Ai;let s=this.strategy;s?.constructor!==t&&(this.destroyBean(s),s=this.createManagedBean(new t),this.strategy=s),s.execute(e),this.selectableService.updateSelectableAfterGrouping()}destroy(){this.destroyBean(this.strategy),this.strategy=void 0,super.destroy()}},class extends n.XQb{constructor(){super(...arguments),this.beanName="pivotColDefService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.columnNameService=e.columnNameService}postConstruct(){const e=()=>this.gos.get("serverSidePivotResultFieldSeparator")??"_";this.fieldSeparator=e(),this.addManagedPropertyListener("serverSidePivotResultFieldSeparator",()=>{this.fieldSeparator=e()});const t=()=>this.gos.get("pivotDefaultExpanded");this.pivotDefaultExpanded=t(),this.addManagedPropertyListener("pivotDefaultExpanded",()=>{this.pivotDefaultExpanded=t()})}createPivotColumnDefs(e){const t=this.createPivotColumnsFromUniqueValues(e),i=function s(o,l=[]){return o.forEach(a=>{void 0!==a.children?s(a.children,l):l.push(a)}),l}(t);return this.addRowGroupTotals(t,i),this.addExpandablePivotGroups(t,i),this.addPivotTotalsToGroups(t,i),{pivotColumnGroupDefs:t,pivotColumnDefs:i.map(o=>(0,n.gpM)(o))}}createPivotColumnsFromUniqueValues(e){const t=this.funcColsService.getPivotColumns();return this.recursivelyBuildGroup(0,e,[],t.length,t)}recursivelyBuildGroup(e,t,s,i,r){const o=this.funcColsService.getValueColumns();if(e>=i)return this.buildMeasureCols(s);const l=r[e].getColDef(),a=this.headerNameComparator.bind(this,l.pivotComparator);if(1===o.length&&this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&e===i-1){const u=[];return(0,n.RhE)(t,h=>{const c=[...s,h],p=this.createColDef(o[0],h,c);p.columnGroupShow="open",u.push(p)}),u.sort(a),u}const d=[];return(0,n.RhE)(t,(u,h)=>{const c=-1===this.pivotDefaultExpanded||e<this.pivotDefaultExpanded,p=[...s,u];d.push({children:this.recursivelyBuildGroup(e+1,h,p,i,r),headerName:u,pivotKeys:p,columnGroupShow:"open",openByDefault:c,groupId:this.generateColumnGroupId(p)})}),d.sort(a),d}buildMeasureCols(e){const t=this.funcColsService.getValueColumns();return 0===t.length?[this.createColDef(null,"-",e)]:t.map(s=>{const i=this.columnNameService.getDisplayNameForColumn(s,"header");return{...this.createColDef(s,i,e),columnGroupShow:"open"}})}addExpandablePivotGroups(e,t){const s=this.gos.get("suppressExpandablePivotGroups");if(s||this.gos.get("pivotColumnGroupTotals"))return;const i=(r,o,l)=>{if("children"in r){const u=new Map;r.children.forEach(c=>{i(c,o,u)});const h=!r.children.some(c=>c.children);return this.funcColsService.getValueColumns().forEach(c=>{const p=this.columnNameService.getDisplayNameForColumn(c,"header"),g=this.createColDef(c,p,r.pivotKeys);g.pivotTotalColumnIds=u.get(c.getColId()),g.columnGroupShow=s?"open":"closed",g.aggFunc=c.getAggFunc(),h||(r.children.push(g),o.push(g))}),void this.merge(l,u)}if(!r.pivotValueColumn)return;const a=r.pivotValueColumn.getColId();l.has(a)?l.get(a).push(r.colId):l.set(a,[r.colId])};e.forEach(r=>{i(r,t,new Map)})}addPivotTotalsToGroups(e,t){if(!this.gos.get("pivotColumnGroupTotals"))return;const s="after"===this.gos.get("pivotColumnGroupTotals"),i=this.funcColsService.getValueColumns(),r=i.map(l=>l.getAggFunc());if(!r||r.length<1||!this.sameAggFuncs(r))return;const o=i[0];e.forEach(l=>{this.recursivelyAddPivotTotal(l,t,o,s)})}recursivelyAddPivotTotal(e,t,s,i){const r=e;if(!r.children)return e.colId?[e.colId]:null;let o=[];if(r.children.forEach(l=>{const a=this.recursivelyAddPivotTotal(l,t,s,i);a&&(o=o.concat(a))}),r.children.length>1){const a=this.localeService.getLocaleTextFunc()("pivotColumnGroupTotals","Total"),d=this.createColDef(s,a,e.pivotKeys,!0);d.pivotTotalColumnIds=o,d.aggFunc=s.getAggFunc(),d.columnGroupShow=this.gos.get("suppressExpandablePivotGroups")?"open":void 0;const u=e.children;i?u.push(d):u.unshift(d),t.push(d)}return o}addRowGroupTotals(e,t){if(!this.gos.get("pivotRowTotals"))return;const s="after"===this.gos.get("pivotRowTotals"),r=this.funcColsService.getValueColumns().slice();s||r.reverse();const o=r.length>1||!this.gos.get("removePivotHeaderRowWhenSingleValueColumn");for(let l=0;l<r.length;l++){const a=r[l],d=this.columnNameService.getDisplayNameForColumn(a,"header"),u=this.createColDef(a,d,[]),h=[];for(let p=0;p<t.length;p++){const g=t[p];g.pivotValueColumn===a&&h.push(g.colId)}u.pivotTotalColumnIds=h,u.colId=Gt+u.colId;const c=o?{children:[u],pivotKeys:[],groupId:`${Gt}_pivotGroup_${a.getColId()}`}:u;t.push(u),s?e.push(c):e.unshift(c)}}createColDef(e,t,s,i=!1){const r={};if(e){const o=e.getColDef();Object.assign(r,o),r.hide=!1}return r.headerName=t,r.colId=this.generateColumnId(s||[],e&&!i?e.getColId():""),r.field=r.colId,r.valueGetter=o=>o.data?.[o.colDef.field],r.pivotKeys=s,r.pivotValueColumn=e,!0===r.filter&&(r.filter="agNumberColumnFilter"),r}sameAggFuncs(e){if(1==e.length)return!0;for(let t=1;t<e.length;t++)if(e[t]!==e[0])return!1;return!0}headerNameComparator(e,t,s){return e?e(t.headerName,s.headerName):t.headerName&&!s.headerName?1:!t.headerName&&s.headerName?-1:t.headerName&&s.headerName?t.headerName<s.headerName?-1:t.headerName>s.headerName?1:0:0}merge(e,t){t.forEach((s,i)=>{const o=[...e.has(i)?e.get(i):[],...s];e.set(i,o)})}generateColumnGroupId(e){return`pivotGroup_${this.funcColsService.getPivotColumns().map(s=>s.getColId()).join("-")}_${e.join("-")}`}generateColumnId(e,t){return`pivot_${this.funcColsService.getPivotColumns().map(i=>i.getColId()).join("-")}_${e.join("-")}_${t}`}createColDefsFromFields(e){const t={};for(let r=0;r<e.length;r++){const l=e[r].split(this.fieldSeparator);let a=t;for(let d=0;d<l.length;d++){const u=l[d];null==a[u]&&(a[u]={}),a=a[u]}}const s=(r,o,l,a)=>{const d=[];for(const c in l){const g=s(`${r}${this.fieldSeparator}${c}`,c,l[c],a+1);d.push(g)}if(0===d.length){const c=this.columnModel.getColDefCol(o);if(c){const g=this.columnNameService.getDisplayNameForColumn(c,"header")??o,f=this.createColDef(c,g,void 0,!1);return f.colId=r,f.aggFunc=c.getAggFunc(),f.valueGetter=v=>v.data?.[r],f}return{colId:r,headerName:o,valueGetter:g=>g.data?.[r]}}return this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===d.length&&"colId"in d[0]?(d[0].headerName=o,d[0]):{openByDefault:-1===this.pivotDefaultExpanded||a<this.pivotDefaultExpanded,groupId:r,headerName:o,children:d}},i=[];for(const r in t){const l=s(r,r,t[r],0);i.push(l)}return i}},class extends n.XQb{constructor(){super(...arguments),this.beanName="pivotStage",this.uniqueValues={},this.lastTimeFailed=!1,this.maxUniqueValues=-1,this.currentUniqueCount=0}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.pivotResultColsService=e.pivotResultColsService,this.funcColsService=e.funcColsService,this.pivotColDefService=e.pivotColDefService}execute(e){const t=e.changedPath;this.columnModel.isPivotActive()?this.executePivotOn(t):this.executePivotOff(t)}executePivotOff(e){this.aggregationColumnsHashLastTime=null,this.uniqueValues={},this.pivotResultColsService.isPivotResultColsPresent()&&(this.pivotResultColsService.setPivotResultCols(null,"rowModelUpdated"),e&&e.setInactive())}executePivotOn(e){const t=this.funcColsService.getValueColumns().length??1,s=this.gos.get("pivotMaxGeneratedColumns");let i;this.maxUniqueValues=-1===s?-1:s/t;try{i=this.bucketUpRowNodes(e)}catch(C){if(C.message===It)return this.pivotResultColsService.setPivotResultCols([],"rowModelUpdated"),this.eventService.dispatchEvent({type:"pivotMaxColumnsExceeded",message:C.message}),void(this.lastTimeFailed=!0);throw C}const r=this.setUniqueValues(i),o=this.funcColsService.getValueColumns(),l=o.map(C=>`${C.getId()}-${C.getColDef().headerName}`).join("#"),a=o.map(C=>C.getAggFunc().toString()).join("#"),d=this.aggregationColumnsHashLastTime!==l,u=this.aggregationFuncsHashLastTime!==a;this.aggregationColumnsHashLastTime=l,this.aggregationFuncsHashLastTime=a;const h=this.funcColsService.getRowGroupColumns().map(C=>C.getId()).join("#"),c=h!==this.groupColumnsHashLastTime;this.groupColumnsHashLastTime=h;const p=this.gos.get("pivotRowTotals"),g=this.gos.get("pivotColumnGroupTotals"),f=this.gos.get("suppressExpandablePivotGroups"),v=this.gos.get("removePivotHeaderRowWhenSingleValueColumn"),y=p!==this.pivotRowTotalsLastTime||g!==this.pivotColumnGroupTotalsLastTime||f!==this.suppressExpandablePivotGroupsLastTime||v!==this.removePivotHeaderRowWhenSingleValueColumnLastTime;if(this.pivotRowTotalsLastTime=p,this.pivotColumnGroupTotalsLastTime=g,this.suppressExpandablePivotGroupsLastTime=f,this.removePivotHeaderRowWhenSingleValueColumnLastTime=v,this.lastTimeFailed||r||d||c||u||y){const{pivotColumnGroupDefs:C,pivotColumnDefs:S}=this.pivotColDefService.createPivotColumnDefs(this.uniqueValues);this.pivotColumnDefs=S,this.pivotResultColsService.setPivotResultCols(C,"rowModelUpdated"),e&&e.setInactive()}this.lastTimeFailed=!1}setUniqueValues(e){return JSON.stringify(e)!==JSON.stringify(this.uniqueValues)&&(this.uniqueValues=e,!0)}bucketUpRowNodes(e){this.currentUniqueCount=0;const t={};e.forEachChangedNodeDepthFirst(i=>{i.leafGroup&&(i.childrenMapped=null)});const s=i=>{i.leafGroup?this.bucketRowNode(i,t):i.childrenAfterFilter?.forEach(s)};return e.executeFromRootNode(s),t}bucketRowNode(e,t){const s=this.funcColsService.getPivotColumns();e.childrenMapped=0===s.length?null:this.bucketChildren(e.childrenAfterFilter,s,0,t),e.sibling&&(e.sibling.childrenMapped=e.childrenMapped)}bucketChildren(e,t,s,i){const r={},o=t[s];if(e.forEach(l=>{let a=this.valueService.getKeyForNode(o,l);if((0,n.MWY)(a)&&(a=""),!i[a]&&(this.currentUniqueCount+=1,i[a]={},-1!==this.maxUniqueValues&&this.currentUniqueCount>this.maxUniqueValues))throw Error(It);r[a]||(r[a]=[]),r[a].push(l)}),s===t.length-1)return r;{const l={};return(0,n.RhE)(r,(a,d)=>{l[a]=this.bucketChildren(d,t,s+1,i[a])}),l}}getPivotColumnDefs(){return this.pivotColumnDefs}},class extends n.XQb{constructor(){super(...arguments),this.beanName="aggFuncService",this.aggFuncsMap={},this.initialised=!1}postConstruct(){this.init()}init(){this.initialised||(this.initialiseWithDefaultAggregations(),this.addAggFuncs(this.gos.get("aggFuncs")))}initialiseWithDefaultAggregations(){const e=this.aggFuncsMap;e.sum=ai,e.first=di,e.last=ui,e.min=ci,e.max=hi,e.count=pi,e.avg=gi,this.initialised=!0}isAggFuncPossible(e,t){const s=this.getFuncNames(e),i=(0,n.dRF)(s,t),r=(0,n.Qmv)(this.aggFuncsMap[t]);return i&&r}getDefaultFuncLabel(e){return ni[e]??e}getDefaultAggFunc(e){const t=e.getColDef().defaultAggFunc;if((0,n.Qmv)(t)&&this.isAggFuncPossible(e,t))return t;if(this.isAggFuncPossible(e,"sum"))return"sum";const s=this.getFuncNames(e);return(0,n.Rer)(s)?s[0]:null}addAggFuncs(e){this.init(),(0,n.RhE)(e,(t,s)=>{this.aggFuncsMap[t]=s})}getAggFunc(e){return this.init(),this.aggFuncsMap[e]}getFuncNames(e){return e.getColDef().allowedAggFuncs??Object.keys(this.aggFuncsMap).sort()}clear(){this.aggFuncsMap={}}},class extends n.XQb{constructor(){super(...arguments),this.beanName="autoColService"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.columnFactory=e.columnFactory}createAutoCols(e){const t=[],s=this.gos.get("treeData");let i=(0,n.Njs)(this.gos);return s&&i&&((0,n.JT7)('you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),i=!1),i?e.forEach((r,o)=>{t.push(this.createOneAutoCol(r,o))}):t.push(this.createOneAutoCol()),t}updateAutoCols(e,t){e.forEach((s,i)=>this.updateOneAutoCol(s,i,t))}createOneAutoCol(e,t){let s;s=e?`${n.JPk}-${e.getId()}`:n.JPk;const i=this.createAutoColDef(s,e,t);i.colId=s;const r=new n.Brr(i,null,s,!0);return this.createBean(r),r}updateOneAutoCol(e,t,s){const i=e.getColDef(),r="string"==typeof i.showRowGroup?i.showRowGroup:void 0,o=null!=r?this.columnModel.getColDefCol(r):void 0,l=this.createAutoColDef(e.getId(),o??void 0,t);e.setColDef(l,null,s),this.columnFactory.applyColumnState(e,l,s)}createAutoColDef(e,t,s){let i=this.createBaseColDef(t);const r=this.gos.get("autoGroupColumnDef");return(0,n.WY6)(i,r),i=this.columnFactory.addColumnDefaultAndTypes(i,e),this.gos.get("treeData")||(0,n.MWY)(i.field)&&(0,n.MWY)(i.valueGetter)&&(0,n.MWY)(i.filterValueGetter)&&"agGroupColumnFilter"!==i.filter&&(i.filter=!1),s&&s>0&&(i.headerCheckboxSelection=!1),(0,n.hnU)(this.gos)&&!(i.valueGetter||null!=i.field)&&(i.sortIndex=void 0,i.initialSort=void 0),i}createBaseColDef(e){const t=this.gos.get("autoGroupColumnDef"),i={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererSelector)||(i.cellRenderer="agGroupCellRenderer"),e){const o=e.getColDef();Object.assign(i,{headerName:this.columnNameService.getDisplayNameForColumn(e,"header"),headerValueGetter:o.headerValueGetter}),o.cellRenderer&&Object.assign(i,{cellRendererParams:{innerRenderer:o.cellRenderer,innerRendererParams:o.cellRendererParams}}),i.showRowGroup=e.getColId()}else i.showRowGroup=!0;return i}},class extends n.XQb{constructor(){super(...arguments),this.beanName="showRowGroupColsService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}refresh(){this.showRowGroupCols=[],this.showRowGroupColsMap={},this.columnModel.getCols().forEach(e=>{const s=e.getColDef().showRowGroup,i="string"==typeof s;!i&&!0!==s||(this.showRowGroupCols.push(e),i?this.showRowGroupColsMap[s]=e:this.funcColsService.getRowGroupColumns().forEach(l=>{this.showRowGroupColsMap[l.getId()]=e}))})}getShowRowGroupCols(){return this.showRowGroupCols}getShowRowGroupCol(e){return this.showRowGroupColsMap[e]}},class extends n.XQb{constructor(){super(...arguments),this.beanName="columnDropZonesService"}getDropZoneSelector(){return wi}}],userComponents:[{name:"agGroupRowRenderer",classImp:R.H_},{name:"agGroupCellRenderer",classImp:R.H_}],controllers:[{name:"groupCellRendererCtrl",classImp:R.ih}],dependantModules:[R.bP]}),cr=(0,n.n9N)({version:de,moduleName:`${n.zsj.RowGroupingModule}-api`,apiFunctions:{addAggFunc:function Vi(e,t,s){e.aggFuncService&&e.aggFuncService.addAggFuncs({key:s})},addAggFuncs:function Oi(e,t){e.aggFuncService&&e.aggFuncService.addAggFuncs(t)},clearAggFuncs:function Bi(e){e.aggFuncService&&e.aggFuncService.clear()},setColumnAggFunc:function Hi(e,t,s){e.funcColsService.setColumnAggFunc(t,s,"api")},isPivotMode:function Ui(e){return e.columnModel.isPivotMode()},getPivotResultColumn:function _i(e,t,s){return e.pivotResultColsService.lookupPivotResultCol(t,s)},setValueColumns:function zi(e,t){e.funcColsService.setValueColumns(t,"api")},getValueColumns:function Ki(e){return e.funcColsService.getValueColumns()},removeValueColumn:function $i(e,t){e.funcColsService.removeValueColumns([t],"api")},removeValueColumns:function Wi(e,t){e.funcColsService.removeValueColumns(t,"api")},addValueColumn:function ji(e,t){e.funcColsService.addValueColumns([t],"api")},addValueColumns:function Xi(e,t){e.funcColsService.addValueColumns(t,"api")},setRowGroupColumns:function Yi(e,t){e.funcColsService.setRowGroupColumns(t,"api")},removeRowGroupColumn:function Qi(e,t){e.funcColsService.removeRowGroupColumns([t],"api")},removeRowGroupColumns:function Ji(e,t){e.funcColsService.removeRowGroupColumns(t,"api")},addRowGroupColumn:function qi(e,t){e.funcColsService.addRowGroupColumns([t],"api")},addRowGroupColumns:function Zi(e,t){e.funcColsService.addRowGroupColumns(t,"api")},getRowGroupColumns:function tr(e){return e.funcColsService.getRowGroupColumns()},moveRowGroupColumn:function er(e,t,s){e.funcColsService.moveRowGroupColumn(t,s,"api")},setPivotColumns:function sr(e,t){e.funcColsService.setPivotColumns(t,"api")},removePivotColumn:function ir(e,t){e.funcColsService.removePivotColumns([t],"api")},removePivotColumns:function rr(e,t){e.funcColsService.removePivotColumns(t,"api")},addPivotColumn:function or(e,t){e.funcColsService.addPivotColumns([t],"api")},addPivotColumns:function nr(e,t){e.funcColsService.addPivotColumns(t,"api")},getPivotColumns:function lr(e){return e.funcColsService.getPivotColumns()},setPivotResultColumns:function ar(e,t){e.pivotResultColsService.setPivotResultCols(t,"api")},getPivotResultColumns:function dr(e){const t=e.pivotResultColsService.getPivotResultCols();return t?t.list:null}},dependantModules:[Ke]}),Lt=(0,n.n9N)({version:de,moduleName:"@ag-grid-enterprise/group-filter",userComponents:[{name:"agGroupColumnFilter",classImp:class extends n.aJZ{constructor(){super('\n            <div class="ag-group-filter">\n                <div data-ref="eGroupField"></div>\n                <div data-ref="eUnderlyingFilter"></div>\n            </div>\n        '),this.eGroupField=n.dRA,this.eUnderlyingFilter=n.dRA}wireBeans(e){this.filterManager=e.filterManager,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService}postConstruct(){this.initialiseTabGuard({})}init(e){return this.updateParams(e).then(()=>{this.addManagedEventListeners({columnRowGroupChanged:()=>this.onColumnRowGroupChanged(),filterDestroyed:t=>this.onFilterDestroyed(t)})})}refresh(e){return this.updateParams(e),!0}updateParams(e){return this.params=e,this.validateParams(),this.updateGroups()}validateParams(){const{colDef:e}=this.params;e.field&&(0,n.JT7)('Group Column Filter does not work with the colDef property "field". This property will be ignored.'),e.filterValueGetter&&(0,n.JT7)('Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.'),e.filterParams&&(0,n.JT7)('Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.')}updateGroups(){const e=this.updateGroupField();return this.getUnderlyingFilters(e)}getSourceColumns(){return this.groupColumn=this.params.column,this.gos.get("treeData")?((0,n.JT7)("Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter."),[]):this.funcColsService.getSourceColumnsForGroupColumn(this.groupColumn)||((0,n.JT7)("Group Column Filter only works on group columns. Please use a different filter."),[])}updateGroupField(){(0,n.fDi)(this.eGroupField),this.eGroupFieldSelect&&this.destroyBean(this.eGroupFieldSelect);const e=this.getSourceColumns(),t=e.filter(s=>s.isFilterAllowed());return t.length?(1===e.length?(this.selectedColumn=t[0],(0,n.nl0)(this.eGroupField,!1)):((!this.selectedColumn||!t.some(s=>s.getId()===this.selectedColumn.getId()))&&(this.selectedColumn=t[0]),this.createGroupFieldSelectElement(t),this.eGroupField.appendChild(this.eGroupFieldSelect.getGui()),this.eGroupField.appendChild((0,n.cvw)('<div class="ag-filter-separator"></div>')),(0,n.nl0)(this.eGroupField,!0)),t):(this.selectedColumn=void 0,(0,n.nl0)(this.eGroupField,!1),null)}createGroupFieldSelectElement(e){this.eGroupFieldSelect=this.createManagedBean(new n.Ju4);const t=this.localeService.getLocaleTextFunc();this.eGroupFieldSelect.setLabel(t("groupFilterSelect","Select field:")),this.eGroupFieldSelect.setLabelAlignment("top"),this.eGroupFieldSelect.addOptions(e.map(s=>({value:s.getId(),text:this.columnNameService.getDisplayNameForColumn(s,"groupFilter",!1)??void 0}))),this.eGroupFieldSelect.setValue(this.selectedColumn.getId()),this.eGroupFieldSelect.onValueChange(s=>this.updateSelectedColumn(s)),this.eGroupFieldSelect.addCssClass("ag-group-filter-field-select-wrapper"),1===e.length&&this.eGroupFieldSelect.setDisabled(!0)}getUnderlyingFilters(e){if(!e)return this.filterColumnPairs=void 0,this.selectedFilter=void 0,this.groupColumn.setFilterActive(!1,"columnRowGroupChanged"),n.oY$.resolve();const t=[],s=[];return e.forEach(i=>{const r=this.filterManager.getOrCreateFilterWrapper(i);r?.filterPromise&&t.push(r.filterPromise.then(o=>(o&&s.push({filter:o,column:i}),i.getId()===this.selectedColumn.getId()&&(this.selectedFilter=o??void 0),o)))}),n.oY$.all(t).then(()=>{this.filterColumnPairs=s,this.groupColumn.setFilterActive(this.isFilterActive(),"columnRowGroupChanged")})}addUnderlyingFilterElement(){if((0,n.fDi)(this.eUnderlyingFilter),!this.selectedColumn)return n.oY$.resolve();const e=this.createManagedBean(new n.jfj(this.selectedColumn,"COLUMN_MENU"));return this.filterWrapperComp=e,e.hasFilter()?(this.eUnderlyingFilter.appendChild(e.getGui()),e.getFilter()?.then(()=>{e.afterGuiAttached?.(this.afterGuiAttachedParams),!this.afterGuiAttachedParams?.suppressFocus&&this.eGroupFieldSelect&&!this.eGroupFieldSelect.isDisabled()&&this.eGroupFieldSelect.getFocusableElement().focus()})??n.oY$.resolve()):n.oY$.resolve()}updateSelectedColumn(e){if(!e)return;this.filterWrapperComp?.afterGuiDetached(),this.destroyBean(this.filterWrapperComp);const t=this.getFilterColumnPair(e);this.selectedColumn=t?.column,this.selectedFilter=t?.filter,this.dispatchLocalEvent({type:"selectedColumnChanged"}),this.addUnderlyingFilterElement()}isFilterActive(){return!!this.filterColumnPairs?.some(({filter:e})=>e.isFilterActive())}doesFilterPass(){return!0}getModel(){return null}setModel(){return n.oY$.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.addUnderlyingFilterElement()}afterGuiDetached(){(0,n.fDi)(this.eUnderlyingFilter),this.selectedFilter?.afterGuiDetached?.()}onColumnRowGroupChanged(){this.updateGroups().then(()=>{this.dispatchLocalEvent({type:"columnRowGroupChanged"})})}onFilterDestroyed({column:e,source:t}){if("gridDestroyed"===t)return;const s=e.getColId();this.filterColumnPairs?.some(({column:i})=>i.getColId()===s)&&setTimeout(()=>{this.isAlive()&&this.updateGroups()})}getFilterColumnPair(e){if(e)return this.filterColumnPairs?.find(({column:t})=>t.getId()===e)}getSelectedFilter(){return this.selectedFilter}getSelectedColumn(){return this.selectedColumn}isFilterAllowed(){return!!this.selectedColumn}destroy(){super.destroy()}}}],dependantModules:[Ke,n.Sxk]}),hr=(0,n.n9N)({version:de,moduleName:"@ag-grid-enterprise/group-floating-filter",userComponents:[{name:"agGroupColumnFloatingFilter",classImp:class extends n.uAl{constructor(){super('\n            <div data-ref="eFloatingFilter" class="ag-group-floating-filter ag-floating-filter-input" role="presentation"></div>\n        '),this.eFloatingFilter=n.dRA,this.haveAddedColumnListeners=!1}wireBeans(e){this.columnNameService=e.columnNameService,this.filterManager=e.filterManager}init(e){this.params=e;const t="multipleColumns"===this.gos.get("groupDisplayType");return new n.oY$(s=>{this.params.parentFilterInstance(i=>{this.parentFilterInstance=i,t?this.setupUnderlyingFloatingFilterElement().then(()=>s()):(this.setupReadOnlyFloatingFilterElement(),s())})}).then(()=>{this.addManagedListeners(this.parentFilterInstance,{selectedColumnChanged:this.onSelectedColumnChanged.bind(this),columnRowGroupChanged:this.onColumnRowGroupChanged.bind(this)})})}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams()}setParams(){const e=this.columnNameService.getDisplayNameForColumn(this.params.column,"header",!0),t=this.localeService.getLocaleTextFunc();this.eFloatingFilterText?.setInputAriaLabel(`${e} ${t("ariaFilterInput","Filter Input")}`)}setupReadOnlyFloatingFilterElement(){this.eFloatingFilterText||(this.eFloatingFilterText=this.createManagedBean(new n.stt),this.eFloatingFilterText.setDisabled(!0).addGuiEventListener("click",()=>this.params.showParentFilter()),this.setParams()),this.updateDisplayedValue(),this.eFloatingFilter.appendChild(this.eFloatingFilterText.getGui())}setupUnderlyingFloatingFilterElement(){this.showingUnderlyingFloatingFilter=!1,this.underlyingFloatingFilter=void 0,(0,n.fDi)(this.eFloatingFilter);const e=this.parentFilterInstance.getSelectedColumn();if(e&&!e.isVisible()){const t=this.filterManager.getFloatingFilterCompDetails(e,this.params.showParentFilter);if(t)return this.haveAddedColumnListeners||(this.haveAddedColumnListeners=!0,this.addManagedListeners(e,{visibleChanged:this.onColumnVisibleChanged.bind(this),colDefChanged:this.onColDefChanged.bind(this)})),t.newAgStackInstance().then(s=>{this.underlyingFloatingFilter=s,this.underlyingFloatingFilter?.onParentModelChanged(this.parentFilterInstance.getSelectedFilter()?.getModel()),this.appendChild(s.getGui()),this.showingUnderlyingFloatingFilter=!0})}return this.setupReadOnlyFloatingFilterElement(),n.oY$.resolve()}onColumnVisibleChanged(){this.setupUnderlyingFloatingFilterElement()}onColDefChanged(e){if(!e.column)return;const t=this.filterManager.getFloatingFilterCompDetails(e.column,this.params.showParentFilter);t&&(this.underlyingFloatingFilter?.refresh?this.underlyingFloatingFilter.refresh(t.params):this.underlyingFloatingFilter?.onParamsUpdated?.(t.params))}onParentModelChanged(e,t){this.showingUnderlyingFloatingFilter?this.underlyingFloatingFilter?.onParentModelChanged(this.parentFilterInstance.getSelectedFilter()?.getModel(),t):this.updateDisplayedValue()}updateDisplayedValue(){if(!this.parentFilterInstance||!this.eFloatingFilterText)return;const e=this.parentFilterInstance.getSelectedFilter();if(!e)return this.eFloatingFilterText.setValue(""),void this.eFloatingFilterText.setDisplayed(!1);if(this.eFloatingFilterText.setDisplayed(!0),e.getModelAsString){const t=e.getModel();this.eFloatingFilterText.setValue(null==t?"":e.getModelAsString(t))}else this.eFloatingFilterText.setValue("")}onSelectedColumnChanged(){this.showingUnderlyingFloatingFilter||this.updateDisplayedValue()}onColumnRowGroupChanged(){this.showingUnderlyingFloatingFilter||this.updateDisplayedValue()}destroy(){super.destroy()}}}],dependantModules:[Lt,n.O1X]}),pr=(0,n.n9N)({version:de,moduleName:n.zsj.RowGroupingModule,dependantModules:[Ke,cr,Lt,hr]}),kt=class extends He{constructor(e){super(e,"aggregation")}postConstruct(){const e=this.localeService.getLocaleTextFunc(),t=e("valueColumnsEmptyMessage","Drag here to aggregate"),s=e("values","Values");super.init({icon:(0,n.asF)("valuePanel",this.gos,null),emptyMessage:t,title:s}),this.addManagedEventListeners({columnValueChanged:this.refreshGui.bind(this)})}getAriaLabel(){return this.localeService.getLocaleTextFunc()("ariaValuesDropZonePanelLabel","Values")}getTooltipParams(){const e=super.getTooltipParams();return e.location="valueColumnsList",e}getIconName(){return this.isPotentialDndItems()?"aggregate":"notAllowed"}isItemDroppable(e,t){return!(this.gos.get("functionsReadOnly")||!e.isPrimary())&&e.isAllowValue()&&(!e.isValueActive()||this.isSourceEventFromTarget(t))}updateItems(e){this.funcColsService.setValueColumns(e,"toolPanelUi")}getExistingItems(){return this.funcColsService.getValueColumns()}};function ee(e){return!!e&&typeof e.children<"u"}function z(e){return ee(e)?e.groupId:e.colId}function Nt(e,t,s){if(!ee(e))return!0;const r=e,o=s;if(((l,a)=>{const d=l.children.map(z),u=(0,n.dRF)(d,z(a)),h=(0,n.GXs)(l.children),c=h&&z(h)!==z(a);return u&&c})(r,o))return r.children.push(o),!0;if(r.groupId===t){const l=r.children.map(z);if(!(0,n.dRF)(l,z(o)))return r.children.push(o),!0}for(let l=r.children.length-1;l>=0&&!Nt(r.children[l],t,s);l--);return!1}function gr(e){const t=(r,o)=>ee(r)&&ee(o)&&z(r)===z(o),s=(r,o)=>{if(!ee(o))return r;const l=r,a=o;return a.children&&a.groupId&&Nt(l,a.groupId,a.children[0])||a.children.forEach(d=>s(l,d)),l},i=[];for(let r=1;r<=e.length;r++){const o=e[r-1],l=e[r];t(o,l)?e[r]=s(o,l):i.push(o)}return i}var Ar=class extends n.uAl{constructor(e){super(),this.eToggleButton=n.dRA,this.eIconWrapper=n.dRA,this.eLabel=n.dRA,this.toolPanelDef=e}getToolPanelId(){return this.toolPanelDef.id}postConstruct(){const e=this.createTemplate();this.setTemplate(e,[]),this.setLabel(),this.setIcon(),this.addManagedElementListeners(this.eToggleButton,{click:this.onButtonPressed.bind(this)}),this.eToggleButton.setAttribute("id",`ag-${this.getCompId()}-button`)}createTemplate(){return'<div class="ag-side-button" role="presentation">\n                <button type="button" data-ref="eToggleButton" tabindex="-1" role="tab" aria-expanded="false" class="ag-button ag-side-button-button">\n                    <div data-ref="eIconWrapper" class="ag-side-button-icon-wrapper" aria-hidden="true"></div>\n                    <span data-ref="eLabel" class="ag-side-button-label"></span>\n                </button>\n            </div>'}setLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.toolPanelDef,s=e(t.labelKey,t.labelDefault);this.eLabel.innerText=s}setIcon(){this.eIconWrapper.insertAdjacentElement("afterbegin",(0,n.asF)(this.toolPanelDef.iconKey,this.gos))}onButtonPressed(){this.dispatchLocalEvent({type:"toggleButtonClicked"})}setSelected(e){this.addOrRemoveCssClass("ag-selected",e),(0,n.oAJ)(this.eToggleButton,e)}getButtonElement(){return this.eToggleButton}},Pr={selector:"AG-SIDE-BAR-BUTTONS",component:class extends n.uAl{constructor(){super('<div class="ag-side-buttons" role="tablist"></div>'),this.buttonComps=[]}wireBeans(e){this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}postConstruct(){this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){if(e.key===n.DDm.TAB&&e.shiftKey){if(this.focusService.focusNextGridCoreContainer(!0))return void e.preventDefault();(0,n.rYD)(e)}}setActiveButton(e){this.buttonComps.forEach(t=>{t.setSelected(e===t.getToolPanelId())})}addButtonComp(e){const t=this.createBean(new Ar(e));return this.buttonComps.push(t),this.appendChild(t),t.addEventListener("toggleButtonClicked",()=>{this.dispatchLocalEvent({type:"sideBarButtonClicked",toolPanelId:e.id})}),t}clearButtons(){this.buttonComps=this.destroyBeans(this.buttonComps),(0,n.fDi)(this.getGui()),super.destroy()}destroy(){this.clearButtons(),super.destroy()}}},Vt={id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"},Ot={id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filter",toolPanel:"agFiltersToolPanel"},$e={columns:Vt,filters:Ot};function We(e){if(e){if(!0===e)return{toolPanels:[Vt,Ot],defaultToolPanel:"columns"};if("string"==typeof e)return We([e]);if(Array.isArray(e)){const s=[];return e.forEach(i=>{const r=$e[i];r?s.push(r):Bt(i)}),0===s.length?void 0:{toolPanels:s,defaultToolPanel:s[0].id}}return{toolPanels:Er(e.toolPanels),defaultToolPanel:e.defaultToolPanel,hiddenByDefault:e.hiddenByDefault,position:e.position}}}function Bt(e){(0,n.JT7)(`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys($e).join(",")}`)}function Er(e){const t=[];return e&&e.forEach(s=>{let i=null;if("string"==typeof s){const r=$e[s];if(!r)return void Bt(s);i=r}else i=s;t.push(i)}),t}var Fe,ie,he,pe,ge,Jt,Re,qt,Qe,Tr=class extends n.uAl{constructor(){super('<div class="ag-tool-panel-horizontal-resize"></div>'),this.minWidth=100,this.maxWidth=null}wireBeans(e){this.horizontalResizeService=e.horizontalResizeService}setElementToResize(e){this.elementToResize=e}postConstruct(){const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.getGui(),dragStartPixels:1,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this),onResizeEnd:this.onResizeEnd.bind(this)});this.addDestroyFunc(e),this.setInverted(this.gos.get("enableRtl"))}dispatchResizeEvent(e,t,s){this.eventService.dispatchEvent({type:"toolPanelSizeChanged",width:s,started:e,ended:t})}onResizeStart(){this.startingWidth=this.elementToResize.offsetWidth,this.dispatchResizeEvent(!0,!1,this.startingWidth)}onResizeEnd(e){return this.onResizing(e,!0)}onResizing(e,t=!1){let i=Math.max(this.minWidth,Math.floor(this.startingWidth-e*(this.inverted?-1:1)));null!=this.maxWidth&&(i=Math.min(this.maxWidth,i)),this.elementToResize.style.width=`${i}px`,this.dispatchResizeEvent(!1,t,i)}setInverted(e){this.inverted=e}setMaxWidth(e){this.maxWidth=e}setMinWidth(e){this.minWidth=null!=e?e:100}},Dr=class extends n.uAl{wireBeans(e){this.userComponentFactory=e.userComponentFactory}constructor(){super('<div class="ag-tool-panel-wrapper" role="tabpanel"/>')}postConstruct(){const e=this.getGui(),t=this.resizeBar=this.createManagedBean(new Tr);e.setAttribute("id",`ag-${this.getCompId()}`),t.setElementToResize(e),this.appendChild(t)}getToolPanelId(){return this.toolPanelId}setToolPanelDef(e,t){const{id:s,minWidth:i,maxWidth:r,width:o}=e;this.toolPanelId=s,this.width=o;const l=this.userComponentFactory.getToolPanelCompDetails(e,t),a=l.newAgStackInstance();this.params=l.params,null!=a?(a.then(this.setToolPanelComponent.bind(this)),null!=i&&this.resizeBar.setMinWidth(i),null!=r&&this.resizeBar.setMaxWidth(r)):(0,n.JT7)(`error processing tool panel component ${s}. You need to specify 'toolPanel'`)}setToolPanelComponent(e){this.toolPanelCompInstance=e,this.appendChild(e.getGui()),this.addDestroyFunc(()=>{this.destroyBean(e)}),this.width&&(this.getGui().style.width=`${this.width}px`)}getToolPanelInstance(){return this.toolPanelCompInstance}setResizerSizerSide(e){const t=this.gos.get("enableRtl"),s="left"===e;this.resizeBar.setInverted(t?s:!s)}refresh(){this.toolPanelCompInstance?.refresh(this.params)}},Ir={selector:"AG-SIDE-BAR",component:class extends n.uAl{constructor(){super('<div class="ag-side-bar ag-unselectable">\n            <ag-side-bar-buttons data-ref="sideBarButtons"></ag-side-bar-buttons>\n        </div>',[Pr]),this.sideBarButtons=n.dRA,this.toolPanelWrappers=[]}wireBeans(e){this.focusService=e.focusService,this.filterManager=e.filterManager,this.sideBarService=e.sideBarService}postConstruct(){this.sideBarButtons.addEventListener("sideBarButtonClicked",this.onToolPanelButtonClicked.bind(this));const{sideBar:e}=this.gos.get("initialState")??{};this.setSideBarDef({sideBarDef:We(this.gos.get("sideBar")),sideBarState:e}),this.addManagedPropertyListener("sideBar",this.onSideBarUpdated.bind(this)),this.sideBarService.registerSideBarComp(this);const t=this.getFocusableElement();this.createManagedBean(new n.G21(t,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),(0,n.oQi)(this,t,this.focusService)}onTabKeyDown(e){if(e.defaultPrevented)return;const{focusService:t,sideBarButtons:s}=this,i=this.getGui(),r=s.getGui(),o=(0,n.UlD)(this.gos),l=i.querySelector(".ag-tool-panel-wrapper:not(.ag-hidden)"),a=e.target;if(!l)return t.focusNextGridCoreContainer(e.shiftKey,!0);if(r.contains(o))return void(t.focusInto(l,e.shiftKey)&&e.preventDefault());if(!e.shiftKey)return;let d=null;l.contains(o)?d=this.focusService.findNextFocusableElement(l,void 0,!0):t.isTargetUnderManagedComponent(l,a)&&e.shiftKey&&(d=this.focusService.findFocusableElementBeforeTabGuard(l,a)),d||(d=r.querySelector(".ag-selected button")),d&&d!==e.target&&(e.preventDefault(),d.focus())}handleKeyDown(e){const t=(0,n.UlD)(this.gos);if(!this.sideBarButtons.getGui().contains(t))return;const s=this.sideBarButtons.getGui(),i=Array.prototype.slice.call(s.querySelectorAll(".ag-side-button")),r=i.findIndex(a=>a.contains(t));let o=null;switch(e.key){case n.DDm.LEFT:case n.DDm.UP:o=Math.max(0,r-1);break;case n.DDm.RIGHT:case n.DDm.DOWN:o=Math.min(r+1,i.length-1)}if(null===o)return;const l=i[o].querySelector("button");l&&(l.focus(),e.preventDefault())}onToolPanelButtonClicked(e){const t=e.toolPanelId;this.openedItem()===t?this.openToolPanel(void 0,"sideBarButtonClicked"):this.openToolPanel(t,"sideBarButtonClicked")}clearDownUi(){this.sideBarButtons.clearButtons(),this.destroyToolPanelWrappers()}setSideBarDef({sideBarDef:e,sideBarState:t,existingToolPanelWrappers:s}){if(this.setDisplayed(!1),this.sideBar=e,this.sideBar&&this.sideBar.toolPanels){if(this.createToolPanelsAndSideButtons(this.sideBar.toolPanels,t,s),!this.toolPanelWrappers.length)return;const r=t?t.visible:!this.sideBar.hiddenByDefault;if(this.setDisplayed(r),this.setSideBarPosition(t?t.position:this.sideBar.position),r)if(t){const{openToolPanel:o}=t;o&&this.openToolPanel(o,"sideBarInitializing")}else this.openToolPanel(this.sideBar.defaultToolPanel,"sideBarInitializing")}}getDef(){return this.sideBar}setSideBarPosition(e){e||(e="right"),this.position=e;const t="left"===e,s=t?"right":"left";return this.addOrRemoveCssClass("ag-side-bar-left",t),this.addOrRemoveCssClass("ag-side-bar-right",!t),this.toolPanelWrappers.forEach(i=>{i.setResizerSizerSide(s)}),this.dispatchSideBarUpdated(),this}setDisplayed(e,t){super.setDisplayed(e,t),this.dispatchSideBarUpdated()}getState(){const e={};return this.toolPanelWrappers.forEach(t=>{e[t.getToolPanelId()]=t.getToolPanelInstance()?.getState?.()}),{visible:this.isDisplayed(),position:this.position,openToolPanel:this.openedItem(),toolPanels:e}}createToolPanelsAndSideButtons(e,t,s){for(const i of e)this.createToolPanelAndSideButton(i,t?.toolPanels?.[i.id],s?.[i.id])}validateDef(e){if(null==e.id)return(0,n.JT7)("please review all your toolPanel components, it seems like at least one of them doesn't have an id"),!1;if("agColumnsToolPanel"===e.toolPanel&&!this.gos.assertModuleRegistered(n.zsj.ColumnsToolPanelModule,"Column Tool Panel"))return!1;if("agFiltersToolPanel"===e.toolPanel){if(!this.gos.assertModuleRegistered(n.zsj.FiltersToolPanelModule,"Filters Tool Panel"))return!1;if(this.filterManager?.isAdvancedFilterEnabled())return(0,n.JT7)("Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled."),!1}return!0}createToolPanelAndSideButton(e,t,s){if(!this.validateDef(e))return;const i=this.sideBarButtons.addButtonComp(e);let r;s?r=s:(r=this.createBean(new Dr),r.setToolPanelDef(e,{initialState:t,onStateUpdated:()=>this.dispatchSideBarUpdated()})),r.setDisplayed(!1);const o=r.getGui();this.appendChild(o),this.toolPanelWrappers.push(r),(0,n.xo4)(i.getButtonElement(),o)}refresh(){this.toolPanelWrappers.forEach(e=>e.refresh())}openToolPanel(e,t="api"){const s=this.openedItem();s!==e&&(this.toolPanelWrappers.forEach(o=>{const l=e===o.getToolPanelId();o.setDisplayed(l)}),s!==this.openedItem()&&(this.sideBarButtons.setActiveButton(e),this.raiseToolPanelVisibleEvent(e,s??void 0,t)))}getToolPanelInstance(e){const t=this.toolPanelWrappers.filter(s=>s.getToolPanelId()===e)[0];if(t)return t.getToolPanelInstance();(0,n.JT7)(`unable to lookup Tool Panel as invalid key supplied: ${e}`)}raiseToolPanelVisibleEvent(e,t,s){const i=!!e&&!!t;t&&this.eventService.dispatchEvent({type:"toolPanelVisibleChanged",source:s,key:t,visible:!1,switchingToolPanel:i}),e&&this.eventService.dispatchEvent({type:"toolPanelVisibleChanged",source:s,key:e,visible:!0,switchingToolPanel:i})}close(e="api"){this.openToolPanel(void 0,e)}isToolPanelShowing(){return!!this.openedItem()}openedItem(){let e=null;return this.toolPanelWrappers.forEach(t=>{t.isDisplayed()&&(e=t.getToolPanelId())}),e}onSideBarUpdated(){const e=We(this.gos.get("sideBar")),t={};e&&this.sideBar&&e.toolPanels?.forEach(s=>{const{id:i}=s;if(!i)return;const r=this.sideBar.toolPanels?.find(d=>d.id===i);if(!r||s.toolPanel!==r.toolPanel)return;const o=this.toolPanelWrappers.find(d=>d.getToolPanelId()===i);if(!o)return;const l=this.gos.addGridCommonParams({...s.toolPanelParams??{},onStateUpdated:()=>this.dispatchSideBarUpdated()});!0===o.getToolPanelInstance()?.refresh(l)&&(this.toolPanelWrappers=this.toolPanelWrappers.filter(d=>d!==o),(0,n.MwW)(o.getGui()),t[i]=o)}),this.clearDownUi(),this.setSideBarDef({sideBarDef:e,existingToolPanelWrappers:t})}dispatchSideBarUpdated(){this.eventService.dispatchEvent({type:"sideBarUpdated"})}destroyToolPanelWrappers(){this.toolPanelWrappers.forEach(e=>{(0,n.MwW)(e.getGui()),this.destroyBean(e)}),this.toolPanelWrappers.length=0}destroy(){this.destroyToolPanelWrappers(),super.destroy()}}},je="32.3.3",Ht=(0,n.n9N)({version:je,moduleName:`${n.zsj.SideBarModule}-core`,beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="toolPanelColDefService"}wireBeans(e){this.columnModel=e.columnModel}createColumnTree(e){const t=[],s=(r,o)=>{if(ee(r)){const l=r,d=new n.PuA(l,typeof l.groupId<"u"?l.groupId:l.headerName,!1,o),u=[];return l.children.forEach(h=>{const c=s(h,o+1);c&&u.push(c)}),d.setChildren(u),d}{const l=r,d=this.columnModel.getColDefCol(l.colId?l.colId:l.field);return d||t.push(l),d}},i=[];return e.forEach(r=>{const o=s(r,0);o&&i.push(o)}),t.length>0&&(0,n.JT7)("unable to find grid columns for the supplied colDef(s):",t),i}syncLayoutWithGrid(e){e(gr(this.getLeafPathTrees()))}getLeafPathTrees(){const e=(i,r)=>{let o;if((0,n.b6I)(i))if(i.isPadding())o=r;else{const a=Object.assign({},i.getColGroupDef());a.groupId=i.getGroupId(),a.children=[r],o=a}else{const a=Object.assign({},i.getColDef());a.colId=i.getColId(),o=a}const l=i.getOriginalParent();return l?e(l,o):o};return this.columnModel.getCols().filter(i=>{const r=i.getColDef();return i.isPrimary()&&!r.showRowGroup}).map(i=>e(i,i.getColDef()))}},class extends n.XQb{constructor(){super(...arguments),this.beanName="sideBarService"}registerSideBarComp(e){this.sideBarComp=e}getSideBarComp(){return this.sideBarComp}getSideBarSelector(){return Ir}}],dependantModules:[R.bP]}),kr=(0,n.n9N)({version:je,moduleName:`${n.zsj.SideBarModule}-api`,apiFunctions:{isSideBarVisible:function mr(e){return e.sideBarService?.getSideBarComp().isDisplayed()??!1},setSideBarVisible:function Cr(e,t){e.sideBarService?.getSideBarComp().setDisplayed(t)},setSideBarPosition:function vr(e,t){e.sideBarService?.getSideBarComp().setSideBarPosition(t)},openToolPanel:function Sr(e,t){e.sideBarService?.getSideBarComp().openToolPanel(t,"api")},closeToolPanel:function wr(e){e.sideBarService?.getSideBarComp().close("api")},getOpenedToolPanel:function yr(e){return e.sideBarService?.getSideBarComp().openedItem()??null},refreshToolPanel:function Fr(e){e.sideBarService?.getSideBarComp().refresh()},isToolPanelShowing:function Rr(e){return e.sideBarService?.getSideBarComp().isToolPanelShowing()??!1},getToolPanelInstance:function xr(e,t){const s=e.sideBarService?.getSideBarComp().getToolPanelInstance(t);return(0,n.nnr)(s)},getSideBar:function Mr(e){return e.sideBarService?.getSideBarComp().getDef()}},dependantModules:[Ht]}),Xe=(0,n.n9N)({version:je,moduleName:n.zsj.SideBarModule,dependantModules:[Ht,kr]}),Vr={selector:"AG-PRIMARY-COLS-HEADER",component:class extends n.uAl{constructor(){super('<div class="ag-column-select-header" role="presentation">\n            <div data-ref="eExpand" class="ag-column-select-header-icon"></div>\n            <ag-checkbox data-ref="eSelect" class="ag-column-select-header-checkbox"></ag-checkbox>\n            <ag-input-text-field class="ag-column-select-header-filter-wrapper" data-ref="eFilterTextField"></ag-input-text-field>\n        </div>',[n.DXf,n.n1z]),this.eExpand=n.dRA,this.eSelect=n.dRA,this.eFilterTextField=n.dRA}wireBeans(e){this.columnModel=e.columnModel}postConstruct(){this.createExpandIcons(),this.addManagedListeners(this.eExpand,{click:this.onExpandClicked.bind(this),keydown:t=>{t.key===n.DDm.SPACE&&(t.preventDefault(),this.onExpandClicked())}}),this.addManagedElementListeners(this.eSelect.getInputElement(),{click:this.onSelectClicked.bind(this)}),this.addManagedPropertyListener("functionsReadOnly",()=>this.onFunctionsReadOnlyPropChanged()),this.eFilterTextField.setAutoComplete(!1).onValueChange(()=>this.onFilterTextChanged()),this.addManagedElementListeners(this.eFilterTextField.getInputElement(),{keydown:this.onMiniFilterKeyDown.bind(this)}),this.addManagedEventListeners({newColumnsLoaded:this.showOrHideOptions.bind(this)});const e=this.localeService.getLocaleTextFunc();this.eSelect.setInputAriaLabel(e("ariaColumnSelectAll","Toggle All Columns Visibility")),this.eFilterTextField.setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input")),this.activateTabIndex([this.eExpand])}onFunctionsReadOnlyPropChanged(){const e=this.gos.get("functionsReadOnly");this.eSelect.setReadOnly(e),this.eSelect.addOrRemoveCssClass("ag-column-select-column-readonly",e)}init(e){this.params=e;const t=this.gos.get("functionsReadOnly");this.eSelect.setReadOnly(t),this.eSelect.addOrRemoveCssClass("ag-column-select-column-readonly",t),this.columnModel.isReady()&&this.showOrHideOptions()}createExpandIcons(){this.eExpand.appendChild(this.eExpandChecked=(0,n.asF)("columnSelectOpen",this.gos)),this.eExpand.appendChild(this.eExpandUnchecked=(0,n.asF)("columnSelectClosed",this.gos)),this.eExpand.appendChild(this.eExpandIndeterminate=(0,n.asF)("columnSelectIndeterminate",this.gos)),this.setExpandState(0)}showOrHideOptions(){const e=!this.params.suppressColumnFilter,t=!this.params.suppressColumnSelectAll,s=!this.params.suppressColumnExpandAll,i=this.columnModel.isProvidedColGroupsPresent(),r=this.localeService.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(r("searchOoo","Search...")),(0,n.nl0)(this.eFilterTextField.getGui(),e),(0,n.nl0)(this.eSelect.getGui(),t),(0,n.nl0)(this.eExpand,s&&i)}onFilterTextChanged(){this.onFilterTextChangedDebounced||(this.onFilterTextChangedDebounced=(0,n.pkA)(()=>{const e=this.eFilterTextField.getValue();this.dispatchLocalEvent({type:"filterChanged",filterText:e})},300)),this.onFilterTextChangedDebounced()}onMiniFilterKeyDown(e){e.key===n.DDm.ENTER&&setTimeout(()=>this.onSelectClicked(),300)}onSelectClicked(){this.dispatchLocalEvent({type:this.selectState?"unselectAll":"selectAll"})}onExpandClicked(){this.dispatchLocalEvent({type:0===this.expandState?"collapseAll":"expandAll"})}setExpandState(e){this.expandState=e,(0,n.nl0)(this.eExpandChecked,0===this.expandState),(0,n.nl0)(this.eExpandUnchecked,1===this.expandState),(0,n.nl0)(this.eExpandIndeterminate,2===this.expandState)}setSelectionState(e){this.selectState=e,this.eSelect.setValue(this.selectState)}}},_t=class{constructor(e,t,s,i=!1,r){this.localEventService=new n.$UK,this.displayName=e,this.dept=s,this.group=i,i?(this.columnGroup=t,this.expanded=r,this.children=[]):this.column=t}isGroup(){return this.group}getDisplayName(){return this.displayName}getColumnGroup(){return this.columnGroup}getColumn(){return this.column}getDept(){return this.dept}isExpanded(){return!!this.expanded}getChildren(){return this.children}isPassesFilter(){return this.passesFilter}setExpanded(e){e!==this.expanded&&(this.expanded=e,this.localEventService.dispatchEvent({type:"expandedChanged"}))}setPassesFilter(e){this.passesFilter=e}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}},zt=class extends n.uAl{constructor(e,t,s){super('<div class="ag-menu"></div>'),this.column=e,this.mouseEvent=t,this.parentEl=s,this.displayName=null}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.popupService=e.popupService,this.focusService=e.focusService}postConstruct(){if(this.initializeProperties(this.column),this.buildMenuItemMap(),this.displayName=(0,n.R39)(this.column)?this.columnNameService.getDisplayNameForColumn(this.column,"columnToolPanel"):this.columnNameService.getDisplayNameForProvidedColumnGroup(null,this.column,"columnToolPanel"),this.isActive()){this.mouseEvent.preventDefault();const e=this.getMappedMenuItems();if(0===e.length)return;this.displayContextMenu(e)}}initializeProperties(e){this.columns=(0,n.b6I)(e)?e.getLeafColumns():[e],this.allowGrouping=this.columns.some(t=>t.isPrimary()&&t.isAllowRowGroup()),this.allowValues=this.columns.some(t=>t.isPrimary()&&t.isAllowValue()),this.allowPivoting=this.columnModel.isPivotMode()&&this.columns.some(t=>t.isPrimary()&&t.isAllowPivot())}buildMenuItemMap(){const e=this.localeService.getLocaleTextFunc();this.menuItemMap=new Map,this.menuItemMap.set("rowGroup",{allowedFunction:t=>t.isPrimary()&&t.isAllowRowGroup()&&!this.columnModel.isColGroupLocked(t),activeFunction:t=>t.isRowGroupActive(),activateLabel:()=>`${e("groupBy","Group by")} ${this.displayName}`,deactivateLabel:()=>`${e("ungroupBy","Un-Group by")} ${this.displayName}`,activateFunction:()=>{const t=this.funcColsService.getRowGroupColumns();this.funcColsService.setRowGroupColumns(this.addColumnsToList(t),"toolPanelUi")},deActivateFunction:()=>{const t=this.funcColsService.getRowGroupColumns();this.funcColsService.setRowGroupColumns(this.removeColumnsFromList(t),"toolPanelUi")},addIcon:"menuAddRowGroup",removeIcon:"menuRemoveRowGroup"}),this.menuItemMap.set("value",{allowedFunction:t=>t.isPrimary()&&t.isAllowValue(),activeFunction:t=>t.isValueActive(),activateLabel:()=>e("addToValues",`Add ${this.displayName} to values`,[this.displayName]),deactivateLabel:()=>e("removeFromValues",`Remove ${this.displayName} from values`,[this.displayName]),activateFunction:()=>{const t=this.funcColsService.getValueColumns();this.funcColsService.setValueColumns(this.addColumnsToList(t),"toolPanelUi")},deActivateFunction:()=>{const t=this.funcColsService.getValueColumns();this.funcColsService.setValueColumns(this.removeColumnsFromList(t),"toolPanelUi")},addIcon:"valuePanel",removeIcon:"valuePanel"}),this.menuItemMap.set("pivot",{allowedFunction:t=>this.columnModel.isPivotMode()&&t.isPrimary()&&t.isAllowPivot(),activeFunction:t=>t.isPivotActive(),activateLabel:()=>e("addToLabels",`Add ${this.displayName} to labels`,[this.displayName]),deactivateLabel:()=>e("removeFromLabels",`Remove ${this.displayName} from labels`,[this.displayName]),activateFunction:()=>{const t=this.funcColsService.getPivotColumns();this.funcColsService.setPivotColumns(this.addColumnsToList(t),"toolPanelUi")},deActivateFunction:()=>{const t=this.funcColsService.getPivotColumns();this.funcColsService.setPivotColumns(this.removeColumnsFromList(t),"toolPanelUi")},addIcon:"pivotPanel",removeIcon:"pivotPanel"})}addColumnsToList(e){return[...e].concat(this.columns.filter(t=>-1===e.indexOf(t)))}removeColumnsFromList(e){return e.filter(t=>-1===this.columns.indexOf(t))}displayContextMenu(e){const t=this.getGui(),s=this.createBean(new R.i9),i=this.localeService.getLocaleTextFunc();let r=()=>{};t.appendChild(s.getGui()),s.addMenuItems(e),s.addManagedListeners(s,{closeMenu:()=>{this.parentEl.focus(),r()}});const o=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,afterGuiAttached:()=>this.focusService.focusInto(s.getGui()),ariaLabel:i("ariaLabelContextMenu","Context Menu"),closedCallback:l=>{l instanceof KeyboardEvent&&this.parentEl.focus(),this.destroyBean(s)}});o&&(r=o.hideFunc),this.popupService.positionPopupUnderMouseEvent({type:"columnContextMenu",mouseEvent:this.mouseEvent,ePopup:t})}isActive(){return this.allowGrouping||this.allowValues||this.allowPivoting}getMappedMenuItems(){const e=[];for(const t of this.menuItemMap.values()){const s=this.columns.some(r=>t.allowedFunction(r)&&!t.activeFunction(r)),i=this.columns.some(r=>t.allowedFunction(r)&&t.activeFunction(r));s&&e.push({name:t.activateLabel(this.displayName),icon:(0,n.asF)(t.addIcon,this.gos,null),action:()=>t.activateFunction()}),i&&e.push({name:t.deactivateLabel(this.displayName),icon:(0,n.asF)(t.removeIcon,this.gos,null),action:()=>t.deActivateFunction()})}return e}},Kt=class extends n.uAl{constructor(e,t,s,i){super(),this.modelItem=e,this.allowDragging=t,this.eventType=s,this.focusWrapper=i,this.cbSelect=n.dRA,this.eLabel=n.dRA,this.eGroupOpenedIcon=n.dRA,this.eGroupClosedIcon=n.dRA,this.eColumnGroupIcons=n.dRA,this.processingColumnStateChange=!1,this.modelItem=e,this.columnGroup=e.getColumnGroup(),this.columnDept=e.getDept(),this.displayName=e.getDisplayName(),this.allowDragging=t}wireBeans(e){this.columnModel=e.columnModel,this.dragAndDropService=e.dragAndDropService,this.modelItemUtils=e.modelItemUtils}postConstruct(){this.setTemplate('<div class="ag-column-select-column-group">\n                <span class="ag-column-group-icons" data-ref="eColumnGroupIcons" >\n                    <span class="ag-column-group-closed-icon" data-ref="eGroupClosedIcon"></span>\n                    <span class="ag-column-group-opened-icon" data-ref="eGroupOpenedIcon"></span>\n                </span>\n                <ag-checkbox data-ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n                <span class="ag-column-select-column-label" data-ref="eLabel"></span>\n            </div>',[n.DXf]),this.eDragHandle=(0,n.asF)("columnDrag",this.gos),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-group-drag-handle");const e=this.cbSelect.getGui(),t=this.cbSelect.getInputElement();e.insertAdjacentElement("afterend",this.eDragHandle),t.setAttribute("tabindex","-1"),this.eLabel.innerHTML=this.displayName?this.displayName:"",this.setupExpandContract(),this.addCssClass("ag-column-select-indent-"+this.columnDept),this.getGui().style.setProperty("--ag-indentation-level",String(this.columnDept)),this.addManagedEventListeners({columnPivotModeChanged:this.onColumnStateChanged.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.onLabelClicked.bind(this)}),this.addManagedListeners(this.cbSelect,{fieldValueChanged:this.onCheckboxChanged.bind(this)}),this.addManagedListeners(this.modelItem,{expandedChanged:this.onExpandChanged.bind(this)}),this.addManagedListeners(this.focusWrapper,{keydown:this.handleKeyDown.bind(this),contextmenu:this.onContextMenu.bind(this)}),this.setOpenClosedIcons(),this.setupDragging(),this.onColumnStateChanged(),this.addVisibilityListenersToAllChildren(),this.refreshAriaExpanded(),this.refreshAriaLabel(),this.setupTooltip(),(0,n.Xq0)(this.columnGroup.getColGroupDef(),this.gos,null,this.columnGroup).forEach(i=>this.addOrRemoveCssClass(i,!0))}getColumns(){return this.columnGroup.getLeafColumns()}setupTooltip(){const e=this.columnGroup.getColGroupDef();if(!e)return;let s;"whenTruncated"===this.gos.get("tooltipShowMode")&&(s=()=>this.eLabel.scrollWidth>this.eLabel.clientWidth);const i=()=>{this.setTooltip({newTooltipText:e.headerTooltip,location:"columnToolPanelColumnGroup",shouldDisplayTooltip:s})};i(),this.addManagedEventListeners({newColumnsLoaded:i})}getTooltipParams(){const e=super.getTooltipParams();return e.location="columnToolPanelColumnGroup",e}handleKeyDown(e){switch(e.key){case n.DDm.LEFT:e.preventDefault(),this.modelItem.setExpanded(!1);break;case n.DDm.RIGHT:e.preventDefault(),this.modelItem.setExpanded(!0);break;case n.DDm.SPACE:e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected())}}onContextMenu(e){const{columnGroup:t,gos:s}=this;if(s.get("functionsReadOnly"))return;const i=this.createBean(new zt(t,e,this.focusWrapper));this.addDestroyFunc(()=>{i.isAlive()&&this.destroyBean(i)})}addVisibilityListenersToAllChildren(){const e=this.onColumnStateChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{this.addManagedListeners(t,{visibleChanged:e,columnValueChanged:e,columnPivotChanged:e,columnRowGroupChanged:e})})}setupDragging(){if(!this.allowDragging)return void(0,n.nl0)(this.eDragHandle,!1);let e=!this.gos.get("suppressDragLeaveHidesColumns");const t={type:n.qRA.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDefaultIconName:()=>e?"hide":"notAllowed",getDragItem:()=>this.createDragItem(),onDragStarted:()=>{e=!this.gos.get("suppressDragLeaveHidesColumns"),this.eventService.dispatchEvent({type:"columnPanelItemDragStart",column:this.columnGroup})},onDragStopped:()=>{this.eventService.dispatchEvent({type:"columnPanelItemDragEnd"})},onGridEnter:s=>{e&&this.modelItemUtils.updateColumns({columns:this.columnGroup.getLeafColumns(),visibleState:s?.visibleState,pivotState:s?.pivotState,eventType:this.eventType})},onGridExit:()=>{e&&this.onChangeCommon(!1)}};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc(()=>this.dragAndDropService.removeDragSource(t))}createDragItem(){const e=this.columnGroup.getLeafColumns(),t={},s={};return e.forEach(i=>{const r=i.getId();t[r]=i.isVisible(),s[r]=this.modelItemUtils.createPivotState(i)}),{columns:e,visibleState:t,pivotState:s}}setupExpandContract(){this.eGroupClosedIcon.appendChild((0,n.fyk)("columnSelectClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild((0,n.fyk)("columnSelectOpen",this.gos,null));const e=this.onExpandOrContractClicked.bind(this);this.addManagedElementListeners(this.eGroupClosedIcon,{click:e}),this.addManagedElementListeners(this.eGroupOpenedIcon,{click:e});const t=new n.MVO(this.eColumnGroupIcons,!0);this.addManagedListeners(t,{tap:e}),this.addDestroyFunc(t.destroy.bind(t))}onLabelClicked(){const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}getVisibleLeafColumns(){const e=[],t=s=>{s.forEach(i=>{i.isPassesFilter()&&(i.isGroup()?t(i.getChildren()):e.push(i.getColumn()))})};return t(this.modelItem.getChildren()),e}onChangeCommon(e){this.refreshAriaLabel(),!this.processingColumnStateChange&&this.modelItemUtils.selectAllChildren(this.modelItem.getChildren(),e,this.eventType)}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumnGroup","Column Group"),s=this.cbSelect.getValue(),i=void 0===s?e("ariaIndeterminate","indeterminate"):s?e("ariaVisible","visible"):e("ariaHidden","hidden"),r=e("ariaToggleVisibility","Press SPACE to toggle visibility");(0,n.PIC)(this.focusWrapper,`${this.displayName} ${t}`),this.cbSelect.setInputAriaLabel(`${r} (${i})`),(0,n.TMe)(this.focusWrapper,this.cbSelect.getInputElement().id)}onColumnStateChanged(){const e=this.workOutSelectedValue(),t=this.workOutReadOnlyValue();this.processingColumnStateChange=!0,this.cbSelect.setValue(e),this.cbSelect.setReadOnly(t),this.addOrRemoveCssClass("ag-column-select-column-group-readonly",t),this.processingColumnStateChange=!1}workOutSelectedValue(){const e=this.columnModel.isPivotMode(),t=this.getVisibleLeafColumns();let s=0,i=0;if(t.forEach(r=>{!e&&r.getColDef().lockVisible||(this.isColumnChecked(r,e)?s++:i++)}),!(s>0&&i>0))return s>0}workOutReadOnlyValue(){const e=this.columnModel.isPivotMode();let t=0;return this.columnGroup.getLeafColumns().forEach(s=>{e?s.isAnyFunctionAllowed()&&t++:s.getColDef().lockVisible||t++}),0===t}isColumnChecked(e,t){if(t){const s=e.isPivotActive(),i=e.isRowGroupActive(),r=e.isValueActive();return s||i||r}return e.isVisible()}onExpandOrContractClicked(){const e=this.modelItem.isExpanded();this.modelItem.setExpanded(!e)}onExpandChanged(){this.setOpenClosedIcons(),this.refreshAriaExpanded()}setOpenClosedIcons(){const e=this.modelItem.isExpanded();(0,n.nl0)(this.eGroupClosedIcon,!e),(0,n.nl0)(this.eGroupOpenedIcon,e)}refreshAriaExpanded(){(0,n.oAJ)(this.focusWrapper,this.modelItem.isExpanded())}getDisplayName(){return this.displayName}onSelectAllChanged(e){const t=this.cbSelect.getValue();!this.cbSelect.isReadOnly()&&(e&&!t||!e&&t)&&this.cbSelect.toggle()}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}setSelected(e){this.cbSelect.setValue(e,!0)}},Or=class extends n.XQb{constructor(e,t){super(),this.comp=e,this.virtualList=t}wireBeans(e){this.columnMoveService=e.columnMoveService,this.columnModel=e.columnModel}postConstruct(){this.createManagedBean(new R.i(this.comp,this.virtualList,{dragSourceType:n.qRA.ToolPanel,listItemDragStartEvent:"columnPanelItemDragStart",listItemDragEndEvent:"columnPanelItemDragEnd",eventSource:this.eventService,getCurrentDragValue:e=>this.getCurrentDragValue(e),isMoveBlocked:e=>this.isMoveBlocked(e),getNumRows:e=>e.getDisplayedColsList().length,moveItem:(e,t)=>this.moveItem(this.getCurrentColumnsBeingMoved(e),t)}))}getCurrentDragValue(e){return e.column}getCurrentColumnsBeingMoved(e){return(0,n.b6I)(e)?e.getLeafColumns():e?[e]:[]}isMoveBlocked(e){return!!this.gos.get("suppressMovableColumns")||!!this.getCurrentColumnsBeingMoved(e).find(r=>{const o=r.getColDef();return!!o.suppressMovable||!!o.lockPosition})}moveItem(e,t){if(!t)return;const{component:s}=t;let i=null,r="top"===t.position;if(s instanceof Kt?(i=s.getColumns()[0],r=!0):s&&(i=s.getColumn()),!i)return;const o=this.getMoveTargetIndex({currentColumns:e,lastHoveredColumn:i,isBefore:r});null!=o&&this.columnMoveService.moveColumns(e,o,"toolPanelUi")}getMoveTargetIndex(e){const{currentColumns:t,lastHoveredColumn:s,isBefore:i}=e;if(!s||!t)return null;const r=this.columnModel.getCols().indexOf(s),o=i?r:r+1;return o-this.getMoveDiff(t,o)}getMoveDiff(e,t){const s=this.columnModel.getCols();if(!e)return 0;const r=e.length;return s.indexOf(e[0])<t?r:0}},Br=class extends n.uAl{constructor(e,t,s,i){super(),this.allowDragging=t,this.groupsExist=s,this.focusWrapper=i,this.eLabel=n.dRA,this.cbSelect=n.dRA,this.processingColumnStateChange=!1,this.column=e.getColumn(),this.columnDept=e.getDept(),this.displayName=e.getDisplayName()}wireBeans(e){this.columnModel=e.columnModel,this.dragAndDropService=e.dragAndDropService,this.modelItemUtils=e.modelItemUtils}postConstruct(){this.setTemplate('<div class="ag-column-select-column">\n                <ag-checkbox data-ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n                <span class="ag-column-select-column-label" data-ref="eLabel"></span>\n            </div>',[n.DXf]),this.eDragHandle=(0,n.asF)("columnDrag",this.gos),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-drag-handle");const e=this.cbSelect.getGui(),t=this.cbSelect.getInputElement();e.insertAdjacentElement("afterend",this.eDragHandle),t.setAttribute("tabindex","-1");const s=(0,n.YR0)(this.displayName);this.eLabel.innerHTML=s;const i=this.columnDept;this.groupsExist&&this.addCssClass("ag-column-select-add-group-indent"),this.addCssClass(`ag-column-select-indent-${i}`),this.getGui().style.setProperty("--ag-indentation-level",String(i)),this.setupDragging();const r=this.onColumnStateChanged.bind(this);this.addManagedEventListeners({columnPivotModeChanged:r}),this.addManagedListeners(this.column,{columnValueChanged:r,columnPivotChanged:r,columnRowGroupChanged:r,visibleChanged:r}),this.addManagedListeners(this.focusWrapper,{keydown:this.handleKeyDown.bind(this),contextmenu:this.onContextMenu.bind(this)}),this.addManagedPropertyListener("functionsReadOnly",this.onColumnStateChanged.bind(this)),this.addManagedListeners(this.cbSelect,{fieldValueChanged:this.onCheckboxChanged.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.onLabelClicked.bind(this)}),this.onColumnStateChanged(),this.refreshAriaLabel(),this.setupTooltip(),(0,n.Xq0)(this.column.getColDef(),this.gos,this.column,null).forEach(l=>this.addOrRemoveCssClass(l,!0))}getColumn(){return this.column}setupTooltip(){let t;"whenTruncated"===this.gos.get("tooltipShowMode")&&(t=()=>this.eLabel.scrollWidth>this.eLabel.clientWidth);const s=()=>{const i=this.column.getColDef().headerTooltip;this.setTooltip({newTooltipText:i,location:"columnToolPanelColumn",shouldDisplayTooltip:t})};s(),this.addManagedEventListeners({newColumnsLoaded:s})}getTooltipParams(){const e=super.getTooltipParams();return e.location="columnToolPanelColumn",e.colDef=this.column.getColDef(),e}onContextMenu(e){const{column:t,gos:s}=this;if(s.get("functionsReadOnly"))return;const i=this.createBean(new zt(t,e,this.focusWrapper));this.addDestroyFunc(()=>{i.isAlive()&&this.destroyBean(i)})}handleKeyDown(e){e.key===n.DDm.SPACE&&(e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected()))}onLabelClicked(){if(this.gos.get("functionsReadOnly"))return;const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}onChangeCommon(e){this.cbSelect.isReadOnly()||(this.refreshAriaLabel(),!this.processingColumnStateChange&&this.modelItemUtils.setColumn(this.column,e,"toolPanelUi"))}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumn","Column"),s=this.cbSelect.getValue()?e("ariaVisible","visible"):e("ariaHidden","hidden"),i=e("ariaToggleVisibility","Press SPACE to toggle visibility");(0,n.PIC)(this.focusWrapper,`${this.displayName} ${t}`),this.cbSelect.setInputAriaLabel(`${i} (${s})`),(0,n.TMe)(this.focusWrapper,this.cbSelect.getInputElement().id)}setupDragging(){if(!this.allowDragging)return void(0,n.nl0)(this.eDragHandle,!1);let e=!this.gos.get("suppressDragLeaveHidesColumns");const t={type:n.qRA.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDefaultIconName:()=>e?"hide":"notAllowed",getDragItem:()=>this.createDragItem(),onDragStarted:()=>{e=!this.gos.get("suppressDragLeaveHidesColumns"),this.eventService.dispatchEvent({type:"columnPanelItemDragStart",column:this.column})},onDragStopped:()=>{this.eventService.dispatchEvent({type:"columnPanelItemDragEnd"})},onGridEnter:s=>{e&&this.modelItemUtils.updateColumns({columns:[this.column],visibleState:s?.visibleState,pivotState:s?.pivotState,eventType:"toolPanelUi"})},onGridExit:()=>{e&&this.onChangeCommon(!1)}};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc(()=>this.dragAndDropService.removeDragSource(t))}createDragItem(){const e=this.column.getColId(),t={[e]:this.column.isVisible()},s={[e]:this.modelItemUtils.createPivotState(this.column)};return{columns:[this.column],visibleState:t,pivotState:s}}onColumnStateChanged(){this.processingColumnStateChange=!0;const e=this.columnModel.isPivotMode();if(e){const i=this.column.isAnyFunctionActive();this.cbSelect.setValue(i)}else this.cbSelect.setValue(this.column.isVisible());let t=!0,s=!0;if(e){const i=this.gos.get("functionsReadOnly"),r=!this.column.isAnyFunctionAllowed();t=!i&&!r,s=t}else{const{enableRowGroup:i,enableValue:r,lockPosition:o,suppressMovable:l,lockVisible:a}=this.column.getColDef();t=!a,s=!!i||!!r||!(o||l)}this.cbSelect.setReadOnly(!t),this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!s),this.addOrRemoveCssClass("ag-column-select-column-readonly",!s&&!t),this.cbSelect.setPassive(!1),this.processingColumnStateChange=!1}getDisplayName(){return this.displayName}onSelectAllChanged(e){e!==this.cbSelect.getValue()&&(this.cbSelect.isReadOnly()||this.cbSelect.toggle())}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}isExpandable(){return!1}setExpanded(e){(0,n.JT7)("can not expand a column item that does not represent a column group header")}},Hr=class{constructor(e){this.items=e}getRowCount(){return this.items.length}getRow(e){return this.items[e]}},zr={selector:"AG-PRIMARY-COLS-LIST",component:class extends n.uAl{constructor(){super('<div class="ag-column-select-list" role="presentation"></div>'),this.destroyColumnItemFuncs=[],this.hasLoadedInitialState=!1,this.isInitialState=!1}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.colDefService=e.toolPanelColDefService,this.modelItemUtils=e.modelItemUtils}destroy(){this.destroyColumnTree(),super.destroy()}destroyColumnTree(){this.allColsTree=[],this.destroyColumnItemFuncs.forEach(e=>e()),this.destroyColumnItemFuncs=[]}init(e,t,s){this.params=e,this.allowDragging=t,this.eventType=s,this.params.suppressSyncLayoutWithGrid||this.addManagedEventListeners({columnMoved:this.onColumnsChanged.bind(this)}),this.addManagedEventListeners({newColumnsLoaded:this.onColumnsChanged.bind(this)});const i=this.fireSelectionChangedEvent.bind(this);this.addManagedEventListeners({columnPivotChanged:i,columnPivotModeChanged:i,columnRowGroupChanged:i,columnValueChanged:i,columnVisible:i,newColumnsLoaded:i}),this.expandGroupsByDefault=!this.params.contractColumnSelection,this.virtualList=this.createManagedBean(new R.wj({cssIdentifier:"column-select",ariaRole:"tree"})),this.appendChild(this.virtualList.getGui()),this.virtualList.setComponentCreator((r,o)=>((0,n.v8T)(o,r.getDept()+1),this.createComponentFromItem(r,o))),this.columnModel.isReady()&&this.onColumnsChanged(),!this.params.suppressColumnMove&&this.createManagedBean(new Or(this,this.virtualList))}createComponentFromItem(e,t){if(e.isGroup()){const i=new Kt(e,this.allowDragging,this.eventType,t);return this.createBean(i),i}const s=new Br(e,this.allowDragging,this.groupsExist,t);return this.createBean(s),s}onColumnsChanged(){this.hasLoadedInitialState||(this.hasLoadedInitialState=!0,this.isInitialState=!!this.params.initialState);const e=this.getExpandedStates(),t=this.columnModel.isPivotMode();this.params.suppressSyncLayoutWithGrid||t?this.buildTreeFromProvidedColumnDefs():this.buildTreeFromWhatGridIsDisplaying(),this.setExpandedStates(e),this.markFilteredColumns(),this.flattenAndFilterModel(),this.isInitialState=!1}getDisplayedColsList(){return this.displayedColsList}getExpandedStates(){const e={};if(this.isInitialState){const{expandedGroupIds:t}=this.params.initialState;return t.forEach(s=>{e[s]=!0}),e}return this.allColsTree?(this.forEachItem(t=>{if(!t.isGroup())return;const s=t.getColumnGroup();s&&(e[s.getId()]=t.isExpanded())}),e):{}}setExpandedStates(e){if(!this.allColsTree)return;const{isInitialState:t}=this;this.forEachItem(s=>{if(!s.isGroup())return;const i=s.getColumnGroup();if(i){const r=e[i.getId()];(null!=r||t)&&s.setExpanded(!!r)}})}buildTreeFromWhatGridIsDisplaying(){this.colDefService.syncLayoutWithGrid(this.setColumnLayout.bind(this))}setColumnLayout(e){const t=this.colDefService.createColumnTree(e);this.buildListModel(t),this.groupsExist=e.some(s=>s&&typeof s.children<"u"),this.markFilteredColumns(),this.flattenAndFilterModel()}buildTreeFromProvidedColumnDefs(){this.buildListModel(this.columnModel.getColDefColTree()),this.groupsExist=this.columnModel.isProvidedColGroupsPresent()}buildListModel(e){const t=this.onColumnExpanded.bind(this),s=l=>{l.addEventListener("expandedChanged",t);const a=l.removeEventListener.bind(l,"expandedChanged",t);this.destroyColumnItemFuncs.push(a)},i=(l,a,d)=>{l.forEach(u=>{(0,n.b6I)(u)?r(u,a,d):o(u,a,d)})},r=(l,a,d)=>{const u=l.getColGroupDef();if(u&&u.suppressColumnsToolPanel)return;if(l.isPadding())return void i(l.getChildren(),a,d);const c=this.columnNameService.getDisplayNameForProvidedColumnGroup(null,l,"columnToolPanel"),p=new _t(c,l,a,!0,this.expandGroupsByDefault);d.push(p),s(p),i(l.getChildren(),a+1,p.getChildren())},o=(l,a,d)=>{if(l.getColDef()&&l.getColDef().suppressColumnsToolPanel)return;const h=this.columnNameService.getDisplayNameForColumn(l,"columnToolPanel");d.push(new _t(h,l,a))};this.destroyColumnTree(),i(e,0,this.allColsTree)}onColumnExpanded(){this.flattenAndFilterModel()}flattenAndFilterModel(){this.displayedColsList=[];const e=s=>{s.isPassesFilter()&&(this.displayedColsList.push(s),s.isGroup()&&s.isExpanded()&&s.getChildren().forEach(e))};this.allColsTree.forEach(e),this.virtualList.setModel(new Hr(this.displayedColsList));const t=this.virtualList.getLastFocusedRow();this.virtualList.refresh(),null!=t&&this.focusRowIfAlive(t),this.notifyListeners(),this.refreshAriaLabel()}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumnPanelList","Column List"),s=e("columns","Columns"),i=this.displayedColsList.length;(0,n.PIC)(this.virtualList.getAriaElement(),`${t} ${i} ${s}`)}focusRowIfAlive(e){window.setTimeout(()=>{this.isAlive()&&this.virtualList.focusRow(e)},0)}forEachItem(e){const t=s=>{s.forEach(i=>{e(i),i.isGroup()&&t(i.getChildren())})};this.allColsTree&&t(this.allColsTree)}doSetExpandedAll(e){this.forEachItem(t=>{t.isGroup()&&t.setExpanded(e)})}setGroupsExpanded(e,t){if(!t)return void this.doSetExpandedAll(e);const s=[];this.forEachItem(r=>{if(!r.isGroup())return;const o=r.getColumnGroup().getId();t.indexOf(o)>=0&&(r.setExpanded(e),s.push(o))});const i=t.filter(r=>!(0,n.dRF)(s,r));i.length>0&&(0,n.JT7)("unable to find group(s) for supplied groupIds:",i)}getExpandState(){let e=0,t=0;return this.forEachItem(s=>{s.isGroup()&&(s.isExpanded()?e++:t++)}),e>0&&t>0?2:t>0?1:0}doSetSelectedAll(e){this.modelItemUtils.selectAllChildren(this.allColsTree,e,this.eventType)}getSelectionState(){let e=0,t=0;const s=this.columnModel.isPivotMode();if(this.forEachItem(i=>{if(i.isGroup()||!i.isPassesFilter())return;const r=i.getColumn(),o=r.getColDef();let l;if(s){if(!r.isAllowPivot()&&!r.isAllowRowGroup()&&!r.isAllowValue())return;l=r.isValueActive()||r.isPivotActive()||r.isRowGroupActive()}else{if(o.lockVisible)return;l=r.isVisible()}l?e++:t++}),!(e>0&&t>0))return!(0===e||t>0)}setFilterText(e){this.filterText=(0,n.Qmv)(e)?e.toLowerCase():null,this.markFilteredColumns(),this.flattenAndFilterModel()}markFilteredColumns(){const e=s=>{if(!(0,n.Qmv)(this.filterText))return!0;const i=s.getDisplayName();return null==i||-1!==i.toLowerCase().indexOf(this.filterText)},t=(s,i)=>{let r=!1;if(s.isGroup()){const l=e(s);s.getChildren().forEach(a=>{const d=t(a,l||i);d&&(r=d)})}const o=!(!i&&!r)||e(s);return s.setPassesFilter(o),o};this.allColsTree.forEach(s=>t(s,!1))}notifyListeners(){this.fireGroupExpandedEvent(),this.fireSelectionChangedEvent()}fireGroupExpandedEvent(){const e=this.getExpandState();this.dispatchLocalEvent({type:"groupExpanded",state:e})}fireSelectionChangedEvent(){if(!this.allColsTree)return;const e=this.getSelectionState();this.dispatchLocalEvent({type:"selectionChanged",state:e})}getExpandedGroups(){const e=[];return this.allColsTree&&this.forEachItem(t=>{t.isGroup()&&t.isExpanded()&&e.push(t.getColumnGroup().getId())}),e}}},$t=class extends n.uAl{constructor(){super('<div class="ag-column-select">\n            <ag-primary-cols-header data-ref="primaryColsHeaderPanel"></ag-primary-cols-header>\n            <ag-primary-cols-list data-ref="primaryColsListPanel"></ag-primary-cols-list>\n        </div>',[Vr,zr]),this.primaryColsHeaderPanel=n.dRA,this.primaryColsListPanel=n.dRA}init(e,t,s){this.allowDragging=e,this.params=t,this.eventType=s,this.primaryColsHeaderPanel.init(this.params),this.params.suppressColumnExpandAll&&this.params.suppressColumnFilter&&this.params.suppressColumnSelectAll&&this.primaryColsHeaderPanel.setDisplayed(!1),this.addManagedListeners(this.primaryColsListPanel,{groupExpanded:this.onGroupExpanded.bind(this),selectionChanged:this.onSelectionChange.bind(this)}),this.primaryColsListPanel.init(this.params,this.allowDragging,this.eventType),this.addManagedListeners(this.primaryColsHeaderPanel,{expandAll:this.onExpandAll.bind(this),collapseAll:this.onCollapseAll.bind(this),selectAll:this.onSelectAll.bind(this),unselectAll:this.onUnselectAll.bind(this),filterChanged:this.onFilterChanged.bind(this)}),this.positionableFeature=new n.qyQ(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature)}toggleResizable(e){this.positionableFeature.setResizable(!!e&&{bottom:!0})}onExpandAll(){this.primaryColsListPanel.doSetExpandedAll(!0)}onCollapseAll(){this.primaryColsListPanel.doSetExpandedAll(!1)}expandGroups(e){this.primaryColsListPanel.setGroupsExpanded(!0,e)}collapseGroups(e){this.primaryColsListPanel.setGroupsExpanded(!1,e)}setColumnLayout(e){this.primaryColsListPanel.setColumnLayout(e)}onFilterChanged(e){this.primaryColsListPanel.setFilterText(e.filterText)}syncLayoutWithGrid(){this.primaryColsListPanel.onColumnsChanged()}onSelectAll(){this.primaryColsListPanel.doSetSelectedAll(!0)}onUnselectAll(){this.primaryColsListPanel.doSetSelectedAll(!1)}onGroupExpanded(e){this.primaryColsHeaderPanel.setExpandState(e.state),this.params.onStateUpdated()}onSelectionChange(e){this.primaryColsHeaderPanel.setSelectionState(e.state)}getExpandedGroups(){return this.primaryColsListPanel.getExpandedGroups()}},Wt=class extends n.uAl{constructor(){super(...arguments),this.cbPivotMode=n.dRA}wireBeans(e){this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}createTemplate(){return'<div class="ag-pivot-mode-panel">\n                <ag-toggle-button data-ref="cbPivotMode" class="ag-pivot-mode-select"></ag-toggle-button>\n            </div>'}postConstruct(){this.setTemplate(this.createTemplate(),[n.OAh]),this.cbPivotMode.setValue(this.columnModel.isPivotMode());const e=this.localeService.getLocaleTextFunc();this.cbPivotMode.setLabel(e("pivotMode","Pivot Mode")),this.addManagedListeners(this.cbPivotMode,{fieldValueChanged:this.onBtPivotMode.bind(this)});const t=this.onPivotModeChanged.bind(this);this.addManagedEventListeners({newColumnsLoaded:t,columnPivotModeChanged:t})}onBtPivotMode(){const e=!!this.cbPivotMode.getValue();e!==this.columnModel.isPivotMode()&&(this.gos.updateGridOptions({options:{pivotMode:e},source:"toolPanelUi"}),this.ctrlsService.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.cbPivotMode.setValue(e)}},jr=(0,n.n9N)({version:"32.3.3",moduleName:n.zsj.ColumnsToolPanelModule,beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="modelItemUtils"}wireBeans(e){this.aggFuncService=e.aggFuncService,this.columnModel=e.columnModel,this.columnApplyStateService=e.columnApplyStateService}selectAllChildren(e,t,s){const i=this.extractAllLeafColumns(e);this.setAllColumns(i,t,s)}setColumn(e,t,s){this.setAllColumns([e],t,s)}setAllColumns(e,t,s){this.columnModel.isPivotMode()?this.setAllPivot(e,t,s):this.setAllVisible(e,t,s)}extractAllLeafColumns(e){const t=[],s=i=>{i.forEach(r=>{r.isPassesFilter()&&(r.isGroup()?s(r.getChildren()):t.push(r.getColumn()))})};return s(e),t}setAllVisible(e,t,s){const i=[];e.forEach(r=>{r.getColDef().lockVisible||r.isVisible()!=t&&i.push({colId:r.getId(),hide:!t})}),i.length>0&&this.columnApplyStateService.applyColumnState({state:i},s)}setAllPivot(e,t,s){this.setAllPivotActive(e,t,s)}setAllPivotActive(e,t,s){const i=[];e.forEach(t?a=>{if(!a.isAnyFunctionActive())if(a.isAllowValue()){const d="string"==typeof a.getAggFunc()?a.getAggFunc():this.aggFuncService?.getDefaultAggFunc(a);i.push({colId:a.getId(),aggFunc:d})}else a.isAllowRowGroup()?i.push({colId:a.getId(),rowGroup:!0}):a.isAllowPivot()&&i.push({colId:a.getId(),pivot:!0})}:a=>{(a.isPivotActive()||a.isRowGroupActive()||a.isValueActive())&&i.push({colId:a.getId(),pivot:!1,rowGroup:!1,aggFunc:null})}),i.length>0&&this.columnApplyStateService.applyColumnState({state:i},s)}updateColumns(e){const{columns:t,visibleState:s,pivotState:i,eventType:r}=e,o=t.map(l=>{const a=l.getColId();if(this.columnModel.isPivotMode()){const d=i?.[a];return{colId:a,pivot:d?.pivot,rowGroup:d?.rowGroup,aggFunc:d?.aggFunc}}return{colId:a,hide:!s?.[a]}});this.columnApplyStateService.applyColumnState({state:o},r)}createPivotState(e){return{pivot:e.isPivotActive(),rowGroup:e.isRowGroupActive(),aggFunc:e.isValueActive()?e.getAggFunc():void 0}}}],userComponents:[{name:"agColumnsToolPanel",classImp:class extends n.uAl{constructor(){super('<div class="ag-column-panel"></div>'),this.initialised=!1,this.childDestroyFuncs=[]}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}init(e){const t=this.gos.addGridCommonParams({suppressColumnMove:!1,suppressColumnSelectAll:!1,suppressColumnFilter:!1,suppressColumnExpandAll:!1,contractColumnSelection:!1,suppressPivotMode:!1,suppressRowGroups:!1,suppressValues:!1,suppressPivots:!1,suppressSyncLayoutWithGrid:!1});if(this.params={...t,...e},this.isRowGroupingModuleLoaded()&&!this.params.suppressPivotMode&&(this.pivotModePanel=this.createBean(new Wt),this.childDestroyFuncs.push(()=>this.destroyBean(this.pivotModePanel)),this.appendChild(this.pivotModePanel)),this.primaryColsPanel=this.createBean(new $t),this.childDestroyFuncs.push(()=>this.destroyBean(this.primaryColsPanel)),this.primaryColsPanel.init(!0,this.params,"toolPanelUi"),this.primaryColsPanel.addCssClass("ag-column-panel-column-select"),this.appendChild(this.primaryColsPanel),this.isRowGroupingModuleLoaded()){this.params.suppressRowGroups||(this.rowGroupDropZonePanel=this.createBean(new _e(!1)),this.childDestroyFuncs.push(()=>this.destroyBean(this.rowGroupDropZonePanel)),this.appendChild(this.rowGroupDropZonePanel)),this.params.suppressValues||(this.valuesDropZonePanel=this.createBean(new kt(!1)),this.childDestroyFuncs.push(()=>this.destroyBean(this.valuesDropZonePanel)),this.appendChild(this.valuesDropZonePanel)),this.params.suppressPivots||(this.pivotDropZonePanel=this.createBean(new Ue(!1)),this.childDestroyFuncs.push(()=>this.destroyBean(this.pivotDropZonePanel)),this.appendChild(this.pivotDropZonePanel)),this.setLastVisible();const[s]=this.addManagedEventListeners({columnPivotModeChanged:()=>{this.resetChildrenHeight(),this.setLastVisible()}});this.childDestroyFuncs.push(()=>s())}this.initialised=!0}setPivotModeSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.pivotModePanel?this.pivotModePanel.setDisplayed(e):e&&(this.pivotModePanel=this.createBean(new Wt),this.getGui().insertBefore(this.pivotModePanel.getGui(),this.getGui().firstChild),this.childDestroyFuncs.push(()=>this.destroyBean(this.pivotModePanel))),this.setLastVisible())}setRowGroupsSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.rowGroupDropZonePanel?this.rowGroupDropZonePanel.setDisplayed(e):e&&(this.rowGroupDropZonePanel=this.createManagedBean(new _e(!1)),this.appendChild(this.rowGroupDropZonePanel)),this.setLastVisible())}setValuesSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.valuesDropZonePanel?this.valuesDropZonePanel.setDisplayed(e):e&&(this.valuesDropZonePanel=this.createManagedBean(new kt(!1)),this.appendChild(this.valuesDropZonePanel)),this.setLastVisible())}setPivotSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.pivotDropZonePanel?this.pivotDropZonePanel.setDisplayed(e):e&&(this.pivotDropZonePanel=this.createManagedBean(new Ue(!1)),this.appendChild(this.pivotDropZonePanel),this.pivotDropZonePanel.setDisplayed(e)),this.setLastVisible())}setResizers(){[this.primaryColsPanel,this.rowGroupDropZonePanel,this.valuesDropZonePanel,this.pivotDropZonePanel].forEach(e=>{if(!e)return;const t=e.getGui();e.toggleResizable(!t.classList.contains("ag-last-column-drop")&&!t.classList.contains("ag-hidden"))})}setLastVisible(){const e=this.getGui();Array.prototype.slice.call(e.querySelectorAll(".ag-column-drop")).forEach(r=>r.classList.remove("ag-last-column-drop"));const s=e.querySelectorAll(".ag-column-drop:not(.ag-hidden)"),i=(0,n.GXs)(s);i&&i.classList.add("ag-last-column-drop"),this.setResizers()}resetChildrenHeight(){const t=this.getGui().children;for(let s=0;s<t.length;s++){const i=t[s];i.style.removeProperty("height"),i.style.removeProperty("flex")}}isRowGroupingModuleLoaded(){return this.gos.assertModuleRegistered(n.zsj.RowGroupingModule,"Row Grouping")}expandColumnGroups(e){this.primaryColsPanel.expandGroups(e)}collapseColumnGroups(e){this.primaryColsPanel.collapseGroups(e)}setColumnLayout(e){this.primaryColsPanel.setColumnLayout(e)}syncLayoutWithGrid(){this.primaryColsPanel.syncLayoutWithGrid()}destroyChildren(){this.childDestroyFuncs.forEach(e=>e()),this.childDestroyFuncs.length=0,(0,n.fDi)(this.getGui())}refresh(e){return this.destroyChildren(),this.init(e),!0}getState(){return{expandedGroupIds:this.primaryColsPanel.getExpandedGroups()}}destroy(){this.destroyChildren(),super.destroy()}}},{name:"agMenuItem",classImp:R.Y0}],dependantModules:[R.bP,pr,Xe]}),jt={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},Yr=e=>Math.round(96*e/72),te=e=>Math.ceil(9525*e),Se=(e,t)=>{if(!t)return;let s;return s="number"==typeof t?t:t({rowIndex:e}),s},L=(e,t)=>{const s=Ct.createHeader({encoding:"UTF-8",standalone:"yes"}),i=Ct.createXml(e);return t?i:`${s}${i}`},se=e=>{const i=String.fromCharCode,r=Math.floor(e/26),o=e%26;return r&&26!==e?o?r<26?i(65+r-1)+i(65+o-1):se(r)+i(65+o-1):se(r-1)+"Z":i(65+e-1)},Ye=e=>{if(null==e)return null;let t="";for(let s=0;s<e.length;s++){const i=e.charCodeAt(s);t+=i>=0&&i<=31&&10!==i?`_x${i.toString(16).toUpperCase().padStart(4,"0")}_`:e[s]}return t},Zr=e=>{const t=[];for(const s of e.keys()){const i=s.toString(),r={name:"t",textNode:(0,n.YR0)(Ye(i),!1)};i.trim().length!==i.length&&(r.properties={rawMap:{"xml:space":"preserve"}}),t.push({name:"si",children:[r]})}return t},to={getTemplate(e){const{name:t,ContentType:s,Extension:i,PartName:r}=e;return{name:t,properties:{rawMap:{Extension:i,PartName:r,ContentType:s}}}}},we=e=>"jpg"===e?"jpeg":e,io={getTemplate(e){const t=new Array(e).fill(void 0).map((h,c)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:`/xl/worksheets/sheet${c+1}.xml`})),s=F.worksheetImages.size,i=F.worksheetHeaderFooterImages.size,r=F.worksheetDataTables.size,o={};F.workbookImageIds.forEach(h=>{o[we(h.type)]=!0});const l=new Array(s).fill(void 0).map((h,c)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:`/xl/drawings/drawing${c+1}.xml`})),a=new Array(r).fill(void 0).map((h,c)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",PartName:`/xl/tables/${F.getTableNameFromIndex(c)}.xml`})),d=Object.keys(o).map(h=>({name:"Default",ContentType:`image/${h}`,Extension:h}));return i&&d.push({name:"Default",Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:[...d,{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"},...t,{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"},...l,...a,{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}].map(h=>to.getTemplate(h))}}},oo={getTemplate(e){const s=(new Date).toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:s},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:s}]}}},Xt=(e,t)=>({name:`xdr:${e}`,children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}),no=e=>{const t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},lo=(e,t)=>({name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:null!=e.altText?e.altText:void 0}},children:[no(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}),Yt=e=>{if(!e.saturation&&!e.tint)return;const t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:1e3*e.saturation}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:1e3*e.tint}}}),t},uo=(e,t)=>{let s;if(e.transparency){const i=Math.min(Math.max(e.transparency,0),100);s=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(1e3*i)}}}]}if(e.recolor)switch(s||(s=[]),e.recolor.toLocaleLowerCase()){case"grayscale":s.push({name:"a:grayscl"});break;case"sepia":s.push(((e,t)=>({name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:e.color}},children:Yt(e)},{name:"a:srgbClr",properties:{rawMap:{val:t.color}},children:Yt(t)}]}))({color:"black"},{color:"D9C3A5",tint:50,saturation:180}));break;case"washout":s.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}})}return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":`rId${t}`,"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:s},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},co=(e,t)=>{const s={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};return e.rotation&&(s.properties={rawMap:{rot:6e4*Math.min(Math.max(e.rotation,0),360)}}),{name:"xdr:spPr",children:[s,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},po=(e,t,s,i)=>({name:"xdr:pic",children:[lo(e,t+1),uo(e,s+1),co(e,i)]}),fo={getTemplate(e){const{sheetIndex:t}=e,s=F.worksheetImages.get(t),i=F.worksheetImageIds.get(t),r=s.map((o,l)=>{const a=(e=>{e.fitCell=!!e.fitCell||!e.width||!e.height;const{position:t={},fitCell:s,width:i=0,height:r=0,totalHeight:o,totalWidth:l}=e,{offsetX:a=0,offsetY:d=0,row:u=1,rowSpan:h=1,column:c=1,colSpan:p=1}=t;return{from:{row:u-1,col:c-1,offsetX:te(a),offsetY:te(d)},to:{row:u-1+(s?1:h-1),col:c-1+(s?1:p-1),offsetX:te(i+a),offsetY:te(r+d)},height:te(o||r),width:te(l||i)}})(o);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[Xt("from",a.from),Xt("to",a.to),po(o,l,i.get(o.id).index,a),{name:"xdr:clientData"}]}});return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:r}}},Co={getTemplate(e){const{Id:t,Type:s,Target:i}=e;return{name:"Relationship",properties:{rawMap:{Id:t,Type:s,Target:i}}}}},ue_getTemplate=e=>({name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:e.map(s=>Co.getTemplate(s))}),wo_getTemplate=e=>({name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.size,uniqueCount:e.size}},children:Zr(e)}),Fo={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot",Continuous:"Continuous"},Ro=["Dashed","DashDot","DashDotDot"],xo={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},Mo={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},Ao={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},K=e=>null==e?e:("#"===e.charAt(0)&&(e=e.substring(1)),6===e.length?"FF"+e:e),ye=(e,t)=>{if(!e)return"thin";const s=(e=>{switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}})(t);if("Continuous"===e)return s;const i=Fo[e];return"medium"===s&&Ro.some(r=>r===i)?`medium${i}`:`${i.charAt(0).toLowerCase()}${i.substring(1)}`},Po=e=>Mo[e]||"general",Eo=e=>Ao[e]||void 0,ce=e=>({name:"color",properties:{rawMap:{rgb:K(e||"#000000")}}}),Do={getTemplate(e){const{left:t,right:s,top:i,bottom:r,diagonal:o}=e,l=t?[ce(t.color)]:void 0,a=s?[ce(s.color)]:void 0,d=i?[ce(i.color)]:void 0,u=r?[ce(r.color)]:void 0,h=o?[ce(o.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:l},{name:"right",properties:{rawMap:{style:s&&s.style}},children:a},{name:"top",properties:{rawMap:{style:i&&i.style}},children:d},{name:"bottom",properties:{rawMap:{style:r&&r.style}},children:u},{name:"diagonal",properties:{rawMap:{style:o&&o.style}},children:h}]}}},Io_getTemplate=e=>({name:"borders",properties:{rawMap:{count:e.length}},children:e.map(t=>Do.getTemplate(t))}),Lo=e=>{const s=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(s,0)},No={getTemplate(e){const{horizontal:t,indent:s,readingOrder:i,rotate:r,shrinkToFit:o,vertical:l,wrapText:a}=e;return{name:"alignment",properties:{rawMap:{horizontal:t&&Po(t),indent:s,readingOrder:i&&Lo(i),textRotation:r,shrinkToFit:o,vertical:l&&Eo(l),wrapText:a}}}}},Oo_getTemplate=e=>({name:"protection",properties:{rawMap:{hidden:!0===e.hideFormula?1:0,locked:!1===e.protected?0:1}}}),Qt={getTemplate(e){const{alignment:t,borderId:s,fillId:i,fontId:r,numFmtId:o,protection:l,quotePrefix:a,xfId:d}=e,u=[];return t&&u.push(No.getTemplate(t)),l&&u.push(Oo_getTemplate(l)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:l?1:void 0,applyBorder:s?1:void 0,applyFill:i?1:void 0,borderId:s,fillId:i,applyFont:r?1:void 0,fontId:r,applyNumberFormat:o?1:void 0,numFmtId:o,quotePrefix:a?1:void 0,xfId:d}},children:u.length?u:void 0}}},Uo_getTemplate=e=>({name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map(t=>Qt.getTemplate(t))}),zo={getTemplate(e){const{builtinId:t,name:s,xfId:i}=e;return{name:"cellStyle",properties:{rawMap:{builtinId:t,name:s,xfId:i}}}}},$o_getTemplate=e=>({name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map(t=>zo.getTemplate(t))}),jo_getTemplate=e=>({name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map(t=>Qt.getTemplate(t))}),Yo={getTemplate(e){const{patternType:t,fgTheme:s,fgTint:i,fgRgb:r,bgRgb:o,bgIndexed:l}=e,a={name:"patternFill",properties:{rawMap:{patternType:t}}};return(s||i||r)&&(a.children=[{name:"fgColor",properties:{rawMap:{theme:s,tint:i,rgb:r}}}]),(l||o)&&(a.children||(a.children=[]),a.children.push({name:"bgColor",properties:{rawMap:{indexed:l,rgb:o}}})),{name:"fill",children:[a]}}},Jo_getTemplate=e=>({name:"fills",properties:{rawMap:{count:e.length}},children:e.map(t=>Yo.getTemplate(t))}),Zo={getTemplate(e){const{size:t,colorTheme:s,color:i="FF000000",fontName:r="Calibri",family:o,scheme:l,italic:a,bold:d,strikeThrough:u,outline:h,shadow:c,underline:p,verticalAlign:g}=e,f=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:s,rgb:i}}},{name:"name",properties:{rawMap:{val:r}}}];return o&&f.push({name:"family",properties:{rawMap:{val:o}}}),l&&f.push({name:"scheme",properties:{rawMap:{val:l}}}),a&&f.push({name:"i"}),d&&f.push({name:"b"}),u&&f.push({name:"strike"}),h&&f.push({name:"outline"}),c&&f.push({name:"shadow"}),p&&f.push({name:"u",properties:{rawMap:{val:p}}}),g&&f.push({name:"vertAlign",properties:{rawMap:{val:g}}}),{name:"font",children:f}}},tn_getTemplate=e=>({name:"fonts",properties:{rawMap:{count:e.length}},children:e.map(t=>Zo.getTemplate(t))}),on={getTemplate(e){let{formatCode:t,numFmtId:s}=e;return t.length&&(t=function sn(e){const t=e.split(/(\[[^\]]*\])/);for(let s=0;s<t.length;s++){let i=t[s];i.length&&(i.startsWith("[")||(i=i.replace(/\$/g,'"$"')),t[s]=(0,n.YR0)(i))}return t.join("")}(t)),{name:"numFmt",properties:{rawMap:{formatCode:t,numFmtId:s}}}}},ln_getTemplate=e=>({name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map(t=>on.getTemplate(t))}),Zt=(e,t)=>(-1!==e.indexOf("mixedStyle")&&t>1&&(e+=`_${t}`),e),es=()=>{Fe={base:0},ie=[],he=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],pe=[{patternType:"none"},{patternType:"gray125"}],ge=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],Jt=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],Re=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],qt=[{builtinId:0,name:"Normal",xfId:0}]},hn=e=>{const{alignment:t,borders:s,font:i,interior:r,numberFormat:o,protection:l,quotePrefix:a}=e;let{id:d}=e,u=0,h=0,c=0,p=0;d&&(d=Zt(d,Qe),null==Fe[d]&&(r&&(u=(e=>{const t=(e=>e?xo[e]||e:"none")(e.pattern),s=K(e.color),i=K(e.patternColor);let r=pe.findIndex(o=>{const{patternType:l,fgRgb:a,bgRgb:d}=o;return!(l!=t||a!=s||d!=i)});return-1===r&&(r=pe.length,pe.push({patternType:t,fgRgb:s,bgRgb:i})),r})(r)),s&&(h=(e=>{const{borderBottom:t,borderTop:s,borderLeft:i,borderRight:r}=e;let o,l,a,d,u,h,c,p;i&&(a=ye(i.lineStyle,i.weight),c=K(i.color)),r&&(d=ye(r.lineStyle,r.weight),p=K(r.color)),t&&(o=ye(t.lineStyle,t.weight),u=K(t.color)),s&&(l=ye(s.lineStyle,s.weight),h=K(s.color));let g=ge.findIndex(f=>{const{left:v,right:y,top:C,bottom:S}=f;if(!v&&(a||c)||!y&&(d||p)||!C&&(l||h)||!S&&(o||u))return!1;const{style:w,color:x}=v||{},{style:M,color:T}=y||{},{style:J,color:oe}=C||{},{style:Y,color:U}=S||{};return!(w!=a||x!=c||M!=d||T!=p||J!=l||oe!=h||Y!=o||U!=u)});return-1===g&&(g=ge.length,ge.push({left:{style:a,color:c},right:{style:d,color:p},top:{style:l,color:h},bottom:{style:o,color:u},diagonal:{style:void 0,color:void 0}})),g})(s)),i&&(c=(e=>{const{fontName:t="Calibri",color:s,size:i,bold:r,italic:o,outline:l,shadow:a,strikeThrough:d,underline:u,family:h,verticalAlign:c}=e,p=K(s),g=(e=>{if(void 0===e)return;const s=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(s,0)})(h),f=u?u.toLocaleLowerCase():void 0,v=c?c.toLocaleLowerCase():void 0;let y=he.findIndex(C=>!(C.fontName!=t||C.color!=p||C.size!=i||C.bold!=r||C.italic!=o||C.outline!=l||C.shadow!=a||C.strikeThrough!=d||C.underline!=f||C.verticalAlign!=v||C.family!=g));return-1===y&&(y=he.length,he.push({fontName:t,color:p,size:i,bold:r,italic:o,outline:l,shadow:a,strikeThrough:d,underline:f,verticalAlign:v,family:g?.toString()})),y})(i)),o&&(p=(e=>{if(jt[e])return jt[e];let t=ie.findIndex(s=>s.formatCode===e);return-1===t?(t=ie.length+164,ie.push({formatCode:e,numFmtId:t})):t=ie[t].numFmtId,t})(o.format)),Fe[d]=Re.length,Re.push({alignment:t,borderId:h||0,fillId:u||0,fontId:c||0,numFmtId:p||0,protection:l,quotePrefix:a,xfId:0})))},gn=(e,t)=>Fe[Zt(e,t)]||0,mn={getTemplate(e){const t=ln_getTemplate(ie),s=tn_getTemplate(he.map(d=>({...d,size:null!=d.size?d.size:e}))),i=Jo_getTemplate(pe),r=Io_getTemplate(ge),o=Uo_getTemplate(Jt),l=jo_getTemplate(Re),a=$o_getTemplate(qt);return es(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,s,i,r,o,l,a,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}}},vn={getTemplate(e,t){const{name:s,columns:i,rowCount:r,displayName:o,headerRowIndex:l,showRowStripes:a,showColumnStripes:d,showFilterButtons:u,highlightFirstColumn:h,highlightLastColumn:c}=e||{};if(!(e&&s&&Array.isArray(i)&&i.length&&r))return{name:"table"};const p=i.map((w,x)=>({name:"filterColumn",properties:{rawMap:{colId:x.toString(),hiddenButton:u[x]?0:1}}})),g=l+1,f=(t+1).toString(),C=`A${g}:${String.fromCharCode(64+i.length)}${g+r}`;return{name:"table",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",name:s,displayName:t?`${o}_${t+1}`:o,ref:C,totalsRowShown:0,id:f}},children:[{name:"autoFilter",properties:{rawMap:{ref:C}},children:p},{name:"tableColumns",properties:{rawMap:{count:i.length}},children:i.map((w,x)=>({name:"tableColumn",properties:{rawMap:{id:(x+1).toString(),name:w,dataCellStyle:"Normal"}}}))},{name:"tableStyleInfo",properties:{rawMap:{name:"TableStyleLight1",showFirstColumn:h?1:0,showLastColumn:c?1:0,showRowStripes:a?1:0,showColumnStripes:d?1:0}}}]}}},N=e=>{const[t,s,i,r]=e;return{name:`a:${t}`,children:[{name:`a:${s}`,properties:{rawMap:{val:i,lastClr:r}}}]}},wn_getTemplate=()=>({name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[N(["dk1","sysClr","windowText","000000"]),N(["lt1","sysClr","window","FFFFFF"]),N(["dk2","srgbClr","44546A"]),N(["lt2","srgbClr","E7E6E6"]),N(["accent1","srgbClr","4472C4"]),N(["accent2","srgbClr","ED7D31"]),N(["accent3","srgbClr","A5A5A5"]),N(["accent4","srgbClr","FFC000"]),N(["accent5","srgbClr","5B9BD5"]),N(["accent6","srgbClr","70AD47"]),N(["hlink","srgbClr","0563C1"]),N(["folHlink","srgbClr","954F72"])]}),m=e=>{const[t,s,i,r]=e;return{name:`a:${t}`,properties:{rawMap:{script:i,typeface:s,panose:r}}}},Fn_getTemplate=()=>({name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[m(["latin","Calibri Light",void 0,"020F0302020204030204"]),m(["ea",""]),m(["cs",""]),m(["font","\u6e38\u30b4\u30b7\u30c3\u30af Light","Jpan"]),m(["font","\ub9d1\uc740 \uace0\ub515","Hang"]),m(["font","\u7b49\u7ebf Light","Hans"]),m(["font","\u65b0\u7d30\u660e\u9ad4","Hant"]),m(["font","Times New Roman","Arab"]),m(["font","Times New Roman","Hebr"]),m(["font","Tahoma","Thai"]),m(["font","Nyala","Ethi"]),m(["font","Vrinda","Beng"]),m(["font","Shruti","Gujr"]),m(["font","MoolBoran","Khmr"]),m(["font","Tunga","Knda"]),m(["font","Raavi","Guru"]),m(["font","Euphemia","Cans"]),m(["font","Plantagenet Cherokee","Cher"]),m(["font","Microsoft Yi Baiti","Yiii"]),m(["font","Microsoft Himalaya","Tibt"]),m(["font","MV Boli","Thaa"]),m(["font","Mangal","Deva"]),m(["font","Gautami","Telu"]),m(["font","Latha","Taml"]),m(["font","Estrangelo Edessa","Syrc"]),m(["font","Kalinga","Orya"]),m(["font","Kartika","Mlym"]),m(["font","DokChampa","Laoo"]),m(["font","Iskoola Pota","Sinh"]),m(["font","Mongolian Baiti","Mong"]),m(["font","Times New Roman","Viet"]),m(["font","Microsoft Uighur","Uigh"]),m(["font","Sylfaen","Geor"]),m(["font","Arial","Armn"]),m(["font","Leelawadee UI","Bugi"]),m(["font","Microsoft JhengHei","Bopo"]),m(["font","Javanese Text","Java"]),m(["font","Segoe UI","Lisu"]),m(["font","Myanmar Text","Mymr"]),m(["font","Ebrima","Nkoo"]),m(["font","Nirmala UI","Olck"]),m(["font","Ebrima","Osma"]),m(["font","Phagspa","Phag"]),m(["font","Estrangelo Edessa","Syrn"]),m(["font","Estrangelo Edessa","Syrj"]),m(["font","Estrangelo Edessa","Syre"]),m(["font","Nirmala UI","Sora"]),m(["font","Microsoft Tai Le","Tale"]),m(["font","Microsoft New Tai Lue","Talu"]),m(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[m(["latin","Calibri",void 0,"020F0502020204030204"]),m(["ea",""]),m(["cs",""]),m(["font","\u6e38\u30b4\u30b7\u30c3\u30af","Jpan"]),m(["font","\ub9d1\uc740 \uace0\ub515","Hang"]),m(["font","\u7b49\u7ebf","Hans"]),m(["font","\u65b0\u7d30\u660e\u9ad4","Hant"]),m(["font","Arial","Arab"]),m(["font","Arial","Hebr"]),m(["font","Tahoma","Thai"]),m(["font","Nyala","Ethi"]),m(["font","Vrinda","Beng"]),m(["font","Shruti","Gujr"]),m(["font","DaunPenh","Khmr"]),m(["font","Tunga","Knda"]),m(["font","Raavi","Guru"]),m(["font","Euphemia","Cans"]),m(["font","Plantagenet Cherokee","Cher"]),m(["font","Microsoft Yi Baiti","Yiii"]),m(["font","Microsoft Himalaya","Tibt"]),m(["font","MV Boli","Thaa"]),m(["font","Mangal","Deva"]),m(["font","Gautami","Telu"]),m(["font","Latha","Taml"]),m(["font","Estrangelo Edessa","Syrc"]),m(["font","Kalinga","Orya"]),m(["font","Kartika","Mlym"]),m(["font","DokChampa","Laoo"]),m(["font","Iskoola Pota","Sinh"]),m(["font","Mongolian Baiti","Mong"]),m(["font","Arial","Viet"]),m(["font","Microsoft Uighur","Uigh"]),m(["font","Sylfaen","Geor"]),m(["font","Arial","Armn"]),m(["font","Leelawadee UI","Bugi"]),m(["font","Microsoft JhengHei","Bopo"]),m(["font","Javanese Text","Java"]),m(["font","Segoe UI","Lisu"]),m(["font","Myanmar Text","Mymr"]),m(["font","Ebrima","Nkoo"]),m(["font","Nirmala UI","Olck"]),m(["font","Ebrima","Osma"]),m(["font","Phagspa","Phag"]),m(["font","Estrangelo Edessa","Syrn"]),m(["font","Estrangelo Edessa","Syrj"]),m(["font","Estrangelo Edessa","Syre"]),m(["font","Nirmala UI","Sora"]),m(["font","Microsoft Tai Le","Tale"]),m(["font","Microsoft New Tai Lue","Talu"]),m(["font","Ebrima","Tfng"])]}]}),B=(e,t,s)=>({name:`a:${e}`,properties:{rawMap:{val:t}},children:s}),Je=e=>{const[t,s,i,r,o,l]=e,a=[];return a.push(B("satMod",i)),r&&a.push(B("lumMod",r)),o&&a.push(B("tint",o)),l&&a.push(B("shade",l)),{name:"a:gs",properties:{rawMap:{pos:t}},children:[{name:"a:schemeClr",properties:{rawMap:{val:s}},children:a}]}},xe=(e,t)=>({name:"a:solidFill",children:[B("schemeClr",e,t)]}),qe=e=>{const[t,s,i,r,o]=e,[l,a]=o;return{name:"a:gradFill",properties:{rawMap:{rotWithShape:t}},children:[{name:"a:gsLst",children:[Je(s),Je(i),Je(r)]},{name:"a:lin",properties:{rawMap:{ang:l,scaled:a}}}]}},Ze=e=>{const[t,s,i,r]=e;return{name:"a:ln",properties:{rawMap:{w:t,cap:s,cmpd:i,algn:r}},children:[xe("phClr"),B("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},et=e=>{const t=[];if(e){const[s,i,r,o,l]=e;t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:s,dist:i,dir:r,algn:o,rotWithShape:l}},children:[B("srgbClr","000000",[B("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},Pn_getTemplate=()=>({name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:fillStyleLst",children:[xe("phClr"),qe(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),qe(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]},{name:"a:lnStyleLst",children:[Ze(["6350","flat","sng","ctr"]),Ze(["12700","flat","sng","ctr"]),Ze(["19050","flat","sng","ctr"])]},{name:"a:effectStyleLst",children:[et(),et(),et(["57150","19050","5400000","ctr","0"])]},{name:"a:bgFillStyleLst",children:[xe("phClr"),xe("phClr",[B("tint","95000"),B("satMod","170000")]),qe(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}]}),Tn_getTemplate=()=>({name:"a:themeElements",children:[wn_getTemplate(),Fn_getTemplate(),Pn_getTemplate()]}),Gn_getTemplate=()=>({name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[Tn_getTemplate(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]}),kn=e=>({name:"v:formulas",children:e.map(t=>({name:"v:f",properties:{rawMap:{eqn:t}}}))}),ts=e=>{const{aspectratio:t,rotation:s}=e||{},i={};return t&&(i.aspectratio="t"),s&&(i.rotation="t"),{name:"o:lock",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}],rawMap:i}}},On=(e,t)=>{let s;const{recolor:i,brightness:r,contrast:o,id:l}=e;if(i&&(s={},("Washout"===i||"Grayscale"===i)&&(s.gain="19661f",s.blacklevel="22938f"),("Black & White"===i||"Grayscale"===i)&&(s.grayscale="t","Black & White"===i&&(s.bilevel="t"))),!i||"Grayscale"===i){if(s||(s={}),null!=o&&50!==o){let a="1";o>=0&&(o<50?a=String(o/50):o<100?a=String(50/(100-o)):100===o&&(a="2147483647f")),s.gain=a}null!=r&&50!==r&&(s.blacklevel=function Vn(e,t,s,i,r){return(e-t)/(s-t)*(r-i)+i}(r,0,100,-.5,.5).toString())}return{name:"v:imagedata",properties:{prefixedAttributes:[{prefix:"o:",map:{relid:`rId${t}`,title:l}}],rawMap:s}}},ss=e=>Math.floor(.74999943307122*(e??0)),_n={getTemplate(e){const t=F.worksheetHeaderFooterImages.get(e.sheetIndex)||[],s=[{name:"o:shapelayout",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}]},children:[{name:"o:idmap",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}],rawMap:{data:"1"}}}]},{name:"v:shapetype",properties:{prefixedAttributes:[{prefix:"o:",map:{spt:"75",preferrelative:"t"}}],rawMap:{coordsize:"21600,21600",filled:"f",id:"_x0000_t75",path:"m@4@5l@4@11@9@11@9@5xe",stroked:"f"}},children:[{name:"v:stroke",properties:{rawMap:{joinstyle:"miter"}}},kn(["if lineDrawn pixelLineWidth 0","sum @0 1 0","sum 0 0 @1","prod @2 1 2","prod @3 21600 pixelWidth","prod @3 21600 pixelHeight","sum @0 0 1","prod @6 1 2","prod @7 21600 pixelWidth","sum @8 21600 0","prod @7 21600 pixelHeight","sum @10 21600 0"]),{name:"v:path",properties:{prefixedAttributes:[{prefix:"o:",map:{connecttype:"rect",extrusionok:"f"}}],rawMap:{gradientshapeok:"t"}}},ts({aspectratio:!0})]},...t.map((i,r)=>((e,t)=>{const{width:s=0,height:i=0,altText:r}=e,o=ss(s),l=ss(i);return{name:"v:shape",properties:{rawMap:{id:e.headerFooterPosition,"o:spid":"_x0000_s1025",style:`position: absolute; margin-left: 0; margin-top: 10in; margin-bottom: 0; margin-right: 0; width: ${o}pt; height: ${l}pt; z-index: ${t+1}`,type:"#_x0000_t75",alt:r}},children:[On(e,t+1),ts({rotation:!0})]}})(i,r))];return{name:"xml",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{v:"urn:schemas-microsoft-com:vml",o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel"}}]},children:s}}},Kn={getTemplate(e,t){const s=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:s,"r:id":`rId${s}`}}}}},Wn_getTemplate=e=>({name:"sheets",children:e.map((t,s)=>Kn.getTemplate(t,s))}),Xn_getTemplate=(e,t)=>({name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[{name:"bookViews",children:[{name:"workbookView",properties:{rawMap:{activeTab:t}}}]},Wn_getTemplate(e)]}),Jn={getTemplate(e){const{min:t,max:s,outlineLevel:i,s:r,width:o,hidden:l,bestFit:a}=e;let d=1,u="0";return o>1&&(d=(e=>Math.ceil((e-12)/7+1))(o),u="1"),{name:"col",properties:{rawMap:{min:t,max:s,outlineLevel:i??void 0,width:d,style:r,hidden:l?"1":"0",bestFit:a?"1":"0",customWidth:u}}}}},Zn_getTemplate=e=>({name:"mergeCell",properties:{rawMap:{ref:e}}}),sl={getTemplate(e,t,s){const{ref:i,data:r,styleId:o}=e,{type:l,value:a}=r||{type:"empty",value:null};let d=l;"f"===l?d="str":l.charAt(0)===l.charAt(0).toUpperCase()&&(d=(e=>{const t=e.charAt(0).toLowerCase();return"s"===t?"inlineStr":t})(l));const u={name:"c",properties:{rawMap:{r:i,t:"empty"===d?void 0:d,s:o?gn(o,s):void 0}}};if("empty"===d)return u;let h;return h="str"===d&&"f"===l?[{name:"f",textNode:(0,n.YR0)(Ye(a),!1)}]:"inlineStr"===d?[{name:"is",children:[{name:"t",textNode:(0,n.YR0)(Ye(a),!1)}]}]:[{name:"v",textNode:a}],Object.assign({},u,{children:h})}},rl=e=>""!==e.data?.value||void 0!==e.styleId,nl={getTemplate(e,t,s){const{collapsed:i,hidden:r,height:o,outlineLevel:l,cells:a=[]}=e;return((e,t)=>{const s=[];let i=0;for(let r=0;r<e.length;r++){const o=e[r];o.mergeAcross&&(s.push({pos:r,excelPos:i}),i+=o.mergeAcross),i++}if(s.length)for(let r=s.length-1;r>=0;r--){const o=[],l=e[s[r].pos];for(let a=1;a<=l.mergeAcross;a++)o.push({ref:`${se(s[r].excelPos+1+a)}${t+1}`,styleId:l.styleId,data:{type:"empty",value:null}});o.length&&e.splice(s[r].pos+1,0,...o)}})(a,t),{name:"row",properties:{rawMap:{r:t+1,collapsed:i?"1":"0",hidden:r?"1":"0",ht:o,customHeight:null!=o?"1":"0",spans:"1:1",outlineLevel:l||void 0}},children:a.filter(rl).map((u,h)=>sl.getTemplate(u,h,s))}}},al=e=>!e||"Portrait"!==e&&"Landscape"!==e?"portrait":e.toLocaleLowerCase(),dl=e=>{if(null==e)return 1;const s=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return-1===s?1:s+1},pl=(e,t,s)=>e.reduce((i,r,o)=>{const l=(e=>"Center"===e?"C":"Right"===e?"R":"L")(r.position),a=((e,t)=>(t&&(e+="&amp;&quot;",e+=t.fontName||"Calibri",e+=t.bold!==t.italic?t.bold?",Bold":",Italic":t.bold?",Bold Italic":",Regular",e+="&quot;",t.size&&(e+=`&amp;${t.size}`),t.strikeThrough&&(e+="&amp;S"),t.underline&&(e+="&amp;"+("Double"===t.underline?"E":"U")),t.color&&(e+=`&amp;K${t.color.replace("#","").toUpperCase()}`)),e))(`${i}&amp;${l}`,r.font);r.position||(r.position=["Left","Center","Right"][o]);const{image:u}=r;return"&[Picture]"===r.value&&u&&F.addHeaderFooterImageToMap(u,`${l}${t}${s}`),`${a}${(0,n.YR0)((e=>((0,n.RhE)({"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F","&[Picture]":"&G"},(s,i)=>{e=e.replace(s,i)}),e))(r.value))}`},""),gl=e=>{const s=[];return["all","first","even"].forEach(i=>{const r=e[i],o="all"===i?"odd":i;if(r)for(const[l,a]of Object.entries(r)){const d=`${l.charAt(0).toUpperCase()}${l.slice(1)}`,u=l[0].toUpperCase();if(a){const h="all"===i?"":i.toUpperCase();s.push({name:`${o}${d}`,properties:{rawMap:{"xml:space":"preserve"}},textNode:pl(a,u,h)})}}}),s},xl=(e=0,t=0)=>{const s=e>0||t>0;return s?[{name:"pane",properties:{rawMap:{state:s?"frozen":void 0,topLeftCell:s?`${se(e+1)}${t+1}`:void 0,xSplit:0===e?void 0:e,ySplit:0===t?void 0:t}}}]:void 0},El={getTemplate(e){const{worksheet:t,currentSheet:s,config:i}=e,{margins:r={},pageSetup:o,headerFooterConfig:l,suppressColumnOutline:a,rightToLeft:d,frozenRowCount:u,frozenColumnCount:h}=i,{table:c}=t,{rows:p,columns:g}=c,f=g&&g.length?((e,t,s)=>{const i=[],r=[];e.forEach((a,d)=>{let c,h=0;a.cells.forEach((p,g)=>{const f=g+h+1,v=se(f),y=d+1;if(p.mergeAcross){h+=p.mergeAcross;const S=se(g+h+1);i.push(`${v}${y}:${S}${y}`)}t[f-1]||(t[f-1]={});const{collapsibleRanges:C}=p;C&&C.forEach(S=>{r.push([f+S[0],f+S[1]])}),c=t[f-1],c.min=f,c.max=f,p.ref=`${v}${y}`})}),r.sort((a,d)=>a[0]!==d[0]?a[0]-d[0]:d[1]-a[1]);const o=new Map,l=new Map;return r.filter(a=>{const d=a.toString();return!o.get(d)&&(o.set(d,!0),!0)}).forEach(a=>{const d=t.find(h=>h.min==a[0]&&h.max==a[1]),u=l.get(a[0]);t.push({min:a[0],max:a[1],outlineLevel:s?void 0:u||1,width:(d||{width:100}).width}),l.set(a[0],(u||0)+1)}),i})(p,g,!!a):[],{worksheetDataTables:v}=F,y=v.get(s),C=(0,n.EAl)(e=>(e.children.push({name:"sheetPr",children:[{name:"outlinePr",properties:{rawMap:{summaryBelow:0}}}]}),e),((e=!1,t,s)=>i=>(i.children.push({name:"sheetViews",children:[{name:"sheetView",properties:{rawMap:{rightToLeft:!0===e?"1":"0",workbookViewId:"0"}},children:xl(t,s)}]}),i))(d,h,u),(e=>t=>{const s=e.reduce((i,r)=>r.outlineLevel&&r.outlineLevel>i?r.outlineLevel:i,0);return t.children.push({name:"sheetFormatPr",properties:{rawMap:{baseColWidth:10,defaultRowHeight:16,outlineLevelRow:s||void 0}}}),t})(p),(e=>t=>(e.length&&t.children.push({name:"cols",children:e.map(s=>Jn.getTemplate(s))}),t))(g),((e,t)=>s=>(e.length&&s.children.push({name:"sheetData",children:e.map((i,r)=>nl.getTemplate(i,r,t))}),s))(p,s+1),(e=>t=>(e.length&&t.children.push({name:"mergeCells",properties:{rawMap:{count:e.length}},children:e.map(s=>Zn_getTemplate(s))}),t))(f),(e=>t=>{const{top:s=.75,right:i=.7,bottom:r=.75,left:o=.7,header:l=.3,footer:a=.3}=e;return t.children.push({name:"pageMargins",properties:{rawMap:{bottom:r,footer:a,header:l,left:o,right:i,top:s}}}),t})(r),(e=>t=>(e&&t.children.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:al(e.orientation),paperSize:dl(e.pageSize)}}}),t))(o),(e=>t=>e?(t.children.push({name:"headerFooter",properties:{rawMap:{differentFirst:null!=e.first?1:0,differentOddEven:null!=e.even?1:0}},children:gl(e)}),t):t)(l),(e=>t=>(F.worksheetImages.get(e)?.length&&t.children.push({name:"drawing",properties:{rawMap:{"r:id":"rId"+ ++t.rIdCounter}}}),t))(s),(e=>t=>(F.worksheetHeaderFooterImages.get(e)&&t.children.push({name:"legacyDrawingHF",properties:{rawMap:{"r:id":"rId"+ ++t.rIdCounter}}}),t))(s),(e=>t=>(e&&t.children.push({name:"tableParts",properties:{rawMap:{count:"1"}},children:[{name:"tablePart",properties:{rawMap:{"r:id":"rId"+ ++t.rIdCounter}}}]}),t))(y)),{children:S}=C({children:[],rIdCounter:0});return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:S}}},V=class xs{static createExcel(t,s,i){this.addSheetName(s),(e=>{1===(Qe=this.sheetNames.length)&&es(),e.forEach(hn)})(t);const r=Object.assign({},i);return i.exportAsExcelTable&&(i.columnModel.isPivotActive()&&(this.showExcelTableNonCompatibleFeaturesWarning("pivot mode"),r.exportAsExcelTable=!1),i.gos.get("masterDetail")&&(this.showExcelTableNonCompatibleFeaturesWarning("master/detail"),r.exportAsExcelTable=!1)),this.processTableConfig(s,r),this.createWorksheet(s,r)}static showExcelTableNonCompatibleFeaturesWarning(t){(0,n.JT7)(`Excel table export does not work with ${t}. The exported Excel file will not contain any Excel tables.\nPlease turn off ${t} to enable Excel table exports.`)}static getTableNameFromIndex(t){return`table${t+1}`}static getSanitizedTableName(t){return t.replace(/^[^a-zA-Z_]+/,"_").replace(/\s/g,"_").replace(/[^a-zA-Z0-9_]/g,"_")}static addTableToSheet(t,s){this.worksheetDataTables.has(t)?(0,n.JT7)("Unable to add data table to Excel sheet: A table already exists."):this.worksheetDataTables.set(t,s)}static processTableConfig(t,s){if(!s.exportAsExcelTable)return;const i="boolean"==typeof s.exportAsExcelTable?{}:s.exportAsExcelTable,{name:r,showColumnStripes:o,showRowStripes:l,showFilterButton:a,highlightFirstColumn:d,highlightLastColumn:u}=i,h=this.getSanitizedTableName(r||xs.defaultTableDisplayName),c=this.sheetNames.length-1,{table:p}=t,{rows:g,columns:f}=p,v=s.columnModel.getHeaderRowCount(),y=v-1,C=g.length,S=f.length,w=[],x=[];for(let M=0;M<S;M++){const T=f[M];w.push(T.displayName||""),x.push("match"===a||void 0===a?T.filterAllowed??!1:a)}w&&w.length&&C&&h?this.addTableToSheet(c,{name:this.getTableNameFromIndex(c),displayName:h,columns:w,showFilterButtons:x,headerRowIndex:y,rowCount:C-v,showRowStripes:l??!0,showColumnStripes:o??!1,highlightFirstColumn:d??!1,highlightLastColumn:u??!1}):(0,n.JT7)("Unable to add data table to Excel sheet: Missing required parameters.")}static addHeaderFooterImageToMap(t,s){const i=this.sheetNames.length-1,r=t;r.headerFooterPosition=s,this.buildImageMap({imageToAdd:r,idx:i});let o=this.worksheetHeaderFooterImages.get(i);o||(o=[],this.worksheetHeaderFooterImages.set(i,o)),o.find(l=>l.id===t.id)||o.push(t)}static addBodyImageToMap(t,s,i,r,o){const l=this.sheetNames.length,{row:a,column:d}=t.position||{},u=t;r&&(null!=s&&null!=i&&(!a||!d)&&(t.position||(t.position={}),t.position=Object.assign({},t.position,{row:s,column:r.indexOf(i)+1})),((e,t)=>{const{colSpan:s,column:i}=e.position;if(e.width)if(s){const r=t.slice(i-1,i+s-1);let o=0;for(let l=0;l<r.length;l++){const a=r[l].getActualWidth();if(e.width<o+a){e.position.colSpan=l+1,e.totalWidth=e.width,e.width=e.totalWidth-o;break}o+=a}}else e.totalWidth=e.width})(u,r),((e,t)=>{const{rowSpan:s,row:i}=e.position;if(e.height)if(s){let r=0,o=0;for(let l=i;l<i+s;l++){const a=Yr(Se(l,t)||20);if(e.height<r+a){e.position.rowSpan=o+1,e.totalHeight=e.height,e.height=e.totalHeight-r;break}r+=a,o++}}else e.totalHeight=e.height})(u,o)),this.buildImageMap({imageToAdd:u,idx:l});let h=this.worksheetImageIds.get(l);h||(h=new Map,this.worksheetImageIds.set(l,h));const c=this.worksheetImages.get(l);c?c.push(u):this.worksheetImages.set(l,[u]),h.get(t.id)||h.set(t.id,{index:h.size,type:t.imageType})}static buildImageMap(t){const{imageToAdd:s,idx:i}=t,r=this.images.get(s.id);if(r){const o=r.find(l=>l.sheetId===i);o?o.image.push(s):r.push({sheetId:i,image:[s]})}else this.images.set(s.id,[{sheetId:i,image:[s]}]),this.workbookImageIds.set(s.id,{type:s.imageType,index:this.workbookImageIds.size})}static addSheetName(t){const s=(0,n.YR0)(t.name)||"";let i="";for(;-1!==this.sheetNames.indexOf(`${s}${i}`);)i=""===i?"_1":`_${parseInt(i.slice(1),10)+1}`;t.name=`${s}${i}`,this.sheetNames.push(t.name)}static getStringPosition(t){return this.sharedStrings.has(t)?this.sharedStrings.get(t):(this.sharedStrings.set(t,this.sharedStrings.size),this.sharedStrings.size-1)}static resetFactory(){this.sharedStrings=new Map,this.images=new Map,this.worksheetImages=new Map,this.worksheetHeaderFooterImages=new Map,this.workbookImageIds=new Map,this.worksheetImageIds=new Map,this.worksheetDataTables=new Map,this.sheetNames=[],this.factoryMode=n.FiP.SINGLE_SHEET}static createWorkbook(t){return L(Xn_getTemplate(this.sheetNames,t))}static createStylesheet(t){return L(mn.getTemplate(t))}static createSharedStrings(){return L(wo_getTemplate(this.sharedStrings))}static createCore(t){return L(oo.getTemplate(t))}static createContentTypes(t){return L(io.getTemplate(t))}static createRels(){const t=ue_getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return L(t)}static createTheme(){return L(Gn_getTemplate())}static createTable(t,s){return L(vn.getTemplate(t,s))}static createWorkbookRels(t){const s=new Array(t).fill(void 0).map((r,o)=>({Id:`rId${o+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:`worksheets/sheet${o+1}.xml`})),i=ue_getTemplate([...s,{Id:`rId${t+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:`rId${t+2}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:`rId${t+3}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}]);return L(i)}static createDrawing(t){return L(fo.getTemplate({sheetIndex:t}))}static createDrawingRel(t){const s=this.worksheetImageIds.get(t)||[],i=[];for(const[r,o]of s){const{index:l,type:a}=o;i.push({Id:`rId${l+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${this.workbookImageIds.get(r).index+1}.${we(a)}`})}return L(ue_getTemplate(i))}static createVmlDrawing(t){return L(_n.getTemplate({sheetIndex:t}),!0)}static createVmlDrawingRel(t){const s=this.worksheetHeaderFooterImages.get(t)||[],i=[];for(let r=0;r<s.length;r++){const l=this.workbookImageIds.get(s[r].id);if(!l)continue;const{index:a,type:d}=l;i.push({Id:`rId${r+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${a+1}.${we(d)}`})}return L(ue_getTemplate(i))}static createRelationships({drawingIndex:t,vmlDrawingIndex:s,tableIndex:i}={}){if(void 0===t&&void 0===s&&void 0===i)return"";const r=[];null!=t&&r.push({Id:`rId${r.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/drawing${t+1}.xml`}),null!=s&&r.push({Id:`rId${r.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Target:`../drawings/vmlDrawing${s+1}.vml`}),null!=i&&r.push({Id:`rId${r.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",Target:`../tables/${this.getTableNameFromIndex(i)}.xml`});const o=ue_getTemplate(r);return L(o)}static createWorksheet(t,s){return L(El.getTemplate({worksheet:t,currentSheet:this.sheetNames.length-1,config:s}))}};V.sharedStrings=new Map,V.sheetNames=[],V.images=new Map,V.worksheetImages=new Map,V.worksheetHeaderFooterImages=new Map,V.workbookImageIds=new Map,V.worksheetImageIds=new Map,V.worksheetDataTables=new Map,V.defaultTableDisplayName="AG-GRID-TABLE",V.factoryMode=n.FiP.SINGLE_SHEET;var F=V,Tl=class extends gt{constructor(e){super(e),this.mixedStyles={},this.mixedStyleCounter=0,this.rows=[],this.frozenRowCount=0,this.skipFrozenRows=!1,this.frozenColumnCount=0,this.skipFrozenColumns=!1,this.config=Object.assign({},e),this.stylesByIds={},this.config.baseExcelStyles.forEach(t=>{this.stylesByIds[t.id]=t}),this.excelStyles=[...this.config.baseExcelStyles,{id:"_quotePrefix",quotePrefix:1}]}addCustomContent(e){e.forEach(t=>{const s=this.rows.length+1;let i;!this.config.suppressRowOutline&&null!=t.outlineLevel&&(i=t.outlineLevel);const r={height:Se(s,t.height||this.config.rowHeight),cells:(t.cells||[]).map((o,l)=>{const a=this.addImage(s,this.columnsToExport[l],o.data?.value);let d=null;o.styleId&&(d="string"==typeof o.styleId?[o.styleId]:o.styleId);const u=this.getStyleId(d);if(a)return this.createCell(u,this.getDataTypeForValue(a.value),null==a.value?"":a.value);const h=o.data?.value??"",c=this.getDataTypeForValue(h);return o.mergeAcross?this.createMergedCell(u,c,h,o.mergeAcross):this.createCell(u,c,h)}),outlineLevel:i};null!=t.collapsed&&(r.collapsed=t.collapsed),null!=t.hidden&&(r.hidden=t.hidden),this.rows.push(r)})}onNewHeaderGroupingRow(){const e=[],{freezeRows:t,headerRowHeight:s}=this.config;return this.rows.push({cells:e,height:Se(this.rows.length+1,s)}),t&&this.frozenRowCount++,{onColumn:(i,r,o,l,a)=>{const d=this.config.styleLinker({rowType:Z.HEADER_GROUPING,rowIndex:1,value:`grouping-${r}`,columnGroup:i});e.push({...this.createMergedCell(this.getStyleId(d),this.getDataTypeForValue("string"),r,l),collapsibleRanges:a})}}}onNewHeaderRow(){const{freezeRows:e,headerRowHeight:t}=this.config;return e&&this.frozenRowCount++,this.onNewRow(this.onNewHeaderColumn,t)}onNewBodyRow(e){const{freezeRows:t,rowHeight:s}=this.config;this.skipFrozenRows||("headersAndPinnedRows"===t&&"top"===e?.rowPinned||"function"==typeof t&&t({...this.gos.getGridCommonParams(),node:e})?this.frozenRowCount++:this.skipFrozenRows=!0);const i=this.onNewRow(this.onNewBodyColumn,s);return e&&this.addRowOutlineIfNecessary(e),i}prepare(e){super.prepare(e),this.columnsToExport=[...e],this.cols=e.map((t,s)=>this.convertColumnToExcel(t,s))}parse(){const e=this.rows.reduce((r,o)=>Math.max(r,o.cells.length),0);for(;this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));const{config:t}=this;let s;if(null!=t.sheetName){const{sheetName:r}=t,o="function"==typeof r?r(this.gos.getGridCommonParams()):r;s=String(o).substring(0,31)}else s="ag-grid";return this.createExcel({name:s,table:{columns:this.cols,rows:this.rows}})}addRowOutlineIfNecessary(e){const{gos:t,suppressRowOutline:s,rowGroupExpandState:i="expanded"}=this.config;if(t.get("groupHideOpenParents")||s||null==e.level)return;const o=e.footer?1:0,l=(0,n.GXs)(this.rows),a=Math.min(e.level+o,7);if(l.outlineLevel=a,"expanded"===i)return;const d="collapsed"===i;e.isExpandable()&&(l.collapsed=!(!d&&e.expanded)),l.hidden=!!e.parent&&-1!==e.parent.level&&(d||this.isAnyParentCollapsed(e.parent))}isAnyParentCollapsed(e){for(;e&&-1!==e.level;){if(!e.expanded)return!0;e=e.parent}return!1}convertColumnToExcel(e,t){const s=this.config.columnWidth,r=(e?this.extractHeaderValue(e):void 0)??"",o=!!e&&e.isFilterAllowed();return s?"number"==typeof s?{width:s,displayName:r,filterAllowed:o}:{width:s({column:e,index:t}),displayName:r,filterAllowed:o}:e?{width:Math.max(e.getActualWidth(),75),displayName:r,filterAllowed:o}:{displayName:r,filterAllowed:o}}onNewHeaderColumn(e,t){return s=>{const i=this.extractHeaderValue(s),r=this.config.styleLinker({rowType:Z.HEADER,rowIndex:e,value:i,column:s});t.push(this.createCell(this.getStyleId(r),this.getDataTypeForValue("string"),i))}}onNewBodyColumn(e,t){let s=0;const{freezeColumns:i,rightToLeft:r}=this.config;return(o,l,a)=>{if(s>0)return void(s-=1);if(!this.skipFrozenColumns){const f=o.getPinned();"pinned"===i&&f&&(!0===f||"left"===f)!==r||"function"==typeof i&&i({...this.gos.getGridCommonParams(),column:o})?this.frozenColumnCount++:this.skipFrozenColumns=!0}const{value:d,valueFormatted:u}=this.extractRowCellValue(o,l,e,"excel",a),h=this.config.styleLinker({rowType:Z.BODY,rowIndex:e,value:d,column:o,node:a}),c=this.getStyleId(h),p=o.getColSpan(a),g=this.addImage(e,o,d);g?t.push(this.createCell(c,this.getDataTypeForValue(g.value),null==g.value?"":g.value)):p>1?(s=p-1,t.push(this.createMergedCell(c,this.getDataTypeForValue(d),d,p-1))):t.push(this.createCell(c,this.getDataTypeForValue(d),d,u))}}onNewRow(e,t){const s=[];return this.rows.push({cells:s,height:Se(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,s)()}}createExcel(e){const{excelStyles:t,config:s}=this;return this.frozenColumnCount&&(s.frozenColumnCount=this.frozenColumnCount),this.frozenRowCount&&(s.frozenRowCount=this.frozenRowCount),F.createExcel(t,e,s)}getDataTypeForValue(e){return void 0===e?"empty":this.isNumerical(e)?"n":"s"}getTypeFromStyle(e,t){if(this.isFormula(t))return"f";if(e&&e.dataType)switch(e.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:(0,n.JT7)(`Unrecognized data type for excel export [${e.id}.dataType=${e.dataType}]`)}return null}addImage(e,t,s){if(!this.config.addImageToCell)return;const i=this.config.addImageToCell(e,t,s);return i?(F.addBodyImageToMap(i.image,e,t,this.columnsToExport,this.config.rowHeight),i):void 0}createCell(e,t,s,i){const r=this.getStyleById(e);!r?.dataType&&"s"===t&&i&&(s=i);const o=this.getTypeFromStyle(r,s)||t,{value:l,escaped:a}=this.getCellValue(o,s),d=[];return r&&d.push(e),a&&d.push("_quotePrefix"),{styleId:e=this.getStyleId(d)||void 0,data:{type:o,value:l}}}createMergedCell(e,t,s,i){const r=s??"";return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:"s"===t?F.getStringPosition(r).toString():s},mergeAcross:i}}getCellValue(e,t){let s=!1;if(null==t||"s"===e&&""===t)return{value:"",escaped:!1};if("s"===e)t&&"'"===t[0]&&(s=!0,t=t.slice(1)),t=F.getStringPosition(t).toString();else if("f"===e)t=t.slice(1);else if("n"===e){const i=Number(t);isNaN(i)?t="":""!==t&&(t=i.toString())}return{value:t,escaped:s}}getStyleId(e){if(!e||!e.length)return null;if(1===e.length)return e[0];const t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID}deepCloneObject(e){return JSON.parse(JSON.stringify(e))}addNewMixedStyle(e){this.mixedStyleCounter+=1;const t=`mixedStyle${this.mixedStyleCounter}`,s={};for(const r of e)for(const o of this.excelStyles)o.id===r&&(0,n.WY6)(s,this.deepCloneObject(o));s.id=t,s.name=t;const i=e.join("-");this.mixedStyles[i]={excelID:t,key:i,result:s},this.excelStyles.push(s),this.stylesByIds[t]=s}isFormula(e){return null!=e&&this.config.autoConvertFormulas&&e.toString().startsWith("=")}isNumerical(e){return"bigint"==typeof e||isFinite(e)&&""!==e&&!isNaN(parseFloat(e))}getStyleById(e){return null==e?null:this.stylesByIds[e]||null}},Il=(e,t)=>{const s="xl/drawings",i=`${s}/drawing${t+1}.xml`;A.addFile(`${s}/_rels/drawing${t+1}.xml.rels`,F.createDrawingRel(e)),A.addFile(i,F.createDrawing(e))},Ll=(e,t)=>{const s="xl/drawings",r=`${s}/_rels/vmlDrawing${t+1}.vml.rels`;A.addFile(`${s}/vmlDrawing${t+1}.vml`,F.createVmlDrawing(e)),A.addFile(r,F.createVmlDrawingRel(e))},is=(e,t={})=>{if(!e||0===e.length)return(0,n.JT7)("Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty."),F.resetFactory(),!1;const{fontSize:s=11,author:i="AG Grid",activeTab:r=0}=t,o=e.length,l=Math.max(Math.min(r,o-1),0);return(()=>{A.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]);const{images:e}=F;if(!e.size)return;A.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);let t=0;e.forEach(s=>{const i=s[0].image[0],{base64:r,imageType:o}=i;A.addFile(`xl/media/image${++t}.${we(o)}`,r,!0)})})(),(()=>{const{worksheetDataTables:e}=F,t=e,s=Array.from(t.keys());for(let i=0;i<s.length;i++){const o=t.get(s[i]);o&&A.addFile(`xl/tables/${o.name}.xml`,F.createTable(o,i))}})(),(e=>{let t=0,s=0,i=0;const{images:r,worksheetDataTables:o,worksheetImages:l,worksheetHeaderFooterImages:a}=F;for(let d=0;d<e.length;d++){A.addFile(`xl/worksheets/sheet${d+1}.xml`,e[d],!1);const h=r.size>0&&l.has(d),c=o.size>0&&o.has(d),p=r.size&&a.has(d);if(!h&&!c&&!p)continue;let g,f,v;h&&(Il(d,t),f=t,t++),p&&(Ll(d,s),v=s,s++),c&&(g=i++),A.addFile(`xl/worksheets/_rels/sheet${d+1}.xml.rels`,F.createRelationships({tableIndex:g,drawingIndex:f,vmlDrawingIndex:v}))}})(e),((e,t,s,i)=>{A.addFile("xl/workbook.xml",F.createWorkbook(i)),A.addFile("xl/styles.xml",F.createStylesheet(e)),A.addFile("xl/sharedStrings.xml",F.createSharedStrings()),A.addFile("xl/theme/theme1.xml",F.createTheme()),A.addFile("xl/_rels/workbook.xml.rels",F.createWorkbookRels(s)),A.addFile("docProps/core.xml",F.createCore(t)),A.addFile("[Content_Types].xml",F.createContentTypes(s)),A.addFile("_rels/.rels",F.createRels())})(s,i,o,l),F.resetFactory(),!0},rs=e=>{const{data:t,fontSize:s,author:i,activeSheetIndex:r}=e,o=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return is(t,{author:i,fontSize:s,activeTab:r})?A.getZipFile(o):Promise.resolve(void 0)},os=e=>{const{data:t,fontSize:s,author:i,activeSheetIndex:r}=e,o=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";if(is(t,{author:i,fontSize:s,activeTab:r}))return A.getUncompressedZipFile(o)};function ns(e){return e.excelCreator?.getFactoryMode()!==n.FiP.MULTI_SHEET||((0,n.JT7)("The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)}var tt="32.3.3",ls=(0,n.n9N)({version:tt,moduleName:`${n.zsj.ExcelExportModule}-core`,beans:[class extends pt{constructor(){super(...arguments),this.beanName="excelCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.stylingService=e.stylingService,this.gridSerializer=e.gridSerializer,this.gos=e.gos}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultExcelExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void(0,n.JT7)("Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),i={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};this.packageCompressedFile(i).then(r=>{if(r){const{fileName:o}=t,l="function"==typeof o?o(this.gos.getGridCommonParams()):o;Le.download(this.getFileName(l),r)}})}exportDataAsExcel(e){this.export(e)}getDataAsExcel(e){const t=this.getMergedParams(e),i={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(i)}setFactoryMode(e){F.factoryMode=e}getFactoryMode(){return F.factoryMode}getSheetDataForExcel(e){const t=this.getMergedParams(e);return this.getData(t)}getMultipleSheetsAsExcel(e){return os(e)}exportMultipleSheetsAsExcel(e){(e=>{const{fileName:t="export.xlsx"}=e;rs(e).then(s=>{if(s){const i="function"==typeof t?t():t;Le.download(i,s)}})})(e)}getDefaultFileExtension(){return"xlsx"}createSerializingSession(e){const{columnModel:t,columnNameService:s,funcColsService:i,valueService:r,gos:o}=this,l={...e,columnModel:t,columnNameService:s,funcColsService:i,valueService:r,gos:o,suppressRowOutline:e.suppressRowOutline||e.skipRowGroups,headerRowHeight:e.headerRowHeight||e.rowHeight,baseExcelStyles:this.gos.get("excelStyles")||[],rightToLeft:e.rightToLeft??this.gos.get("enableRtl"),styleLinker:this.styleLinker.bind(this)};return new Tl(l)}styleLinker(e){const{rowType:t,rowIndex:s,value:i,column:r,columnGroup:o,node:l}=e,a=t===Z.HEADER,d=t===Z.HEADER_GROUPING,u=a?r:o;let h=[];if(a||d)return h.push("header"),d&&h.push("headerGroup"),u&&(h=h.concat((0,n.W_e)(u.getDefinition(),this.gos,r||null,o||null))),h;const c=this.gos.get("excelStyles"),p=["cell"];if(!c||!c.length)return p;const g=c.map(v=>v.id),f=r.getDefinition();return this.stylingService.processAllCellClasses(f,this.gos.addGridCommonParams({value:i,data:l.data,node:l,colDef:f,column:r,rowIndex:s}),v=>{g.indexOf(v)>-1&&p.push(v)}),p.sort((v,y)=>g.indexOf(v)<g.indexOf(y)?-1:1)}isExportSuppressed(){return this.gos.get("suppressExcelExport")}packageCompressedFile(e){return rs(e)}packageFile(e){return os(e)}}],dependantModules:[Ne,R.bP]}),Kl=(0,n.n9N)({version:tt,moduleName:`${n.zsj.ExcelExportModule}-api`,apiFunctions:{getDataAsExcel:function Bl(e,t){if(ns(e))return e.excelCreator?.getDataAsExcel(t)},exportDataAsExcel:function Hl(e,t){ns(e)&&e.excelCreator?.exportDataAsExcel(t)},getSheetDataForExcel:function Ul(e,t){return e.excelCreator?.setFactoryMode(n.FiP.MULTI_SHEET),e.excelCreator?.getSheetDataForExcel(t)},getMultipleSheetsAsExcel:function _l(e,t){return e.excelCreator?.getMultipleSheetsAsExcel(t)},exportMultipleSheetsAsExcel:function zl(e,t){e.excelCreator?.exportMultipleSheetsAsExcel(t)}},dependantModules:[ls]}),$l=(0,n.n9N)({version:tt,moduleName:n.zsj.ExcelExportModule,dependantModules:[ls,Kl]}),jl={selector:"AG-FILTERS-TOOL-PANEL-HEADER",component:class extends n.uAl{constructor(){super(...arguments),this.eExpand=n.dRA,this.eFilterTextField=n.dRA}wireBeans(e){this.columnModel=e.columnModel}postConstruct(){this.setTemplate('<div class="ag-filter-toolpanel-search" role="presentation">\n                <div data-ref="eExpand" class="ag-filter-toolpanel-expand"></div>\n                <ag-input-text-field data-ref="eFilterTextField" class="ag-filter-toolpanel-search-input"></ag-input-text-field>\n            </div>',[n.n1z]);const e=this.localeService.getLocaleTextFunc();this.eFilterTextField.setAutoComplete(!1).setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input")).onValueChange(this.onSearchTextChanged.bind(this)),this.createExpandIcons(),this.setExpandState(0),this.addManagedElementListeners(this.eExpand,{click:this.onExpandClicked.bind(this)}),this.addManagedEventListeners({newColumnsLoaded:this.showOrHideOptions.bind(this)})}init(e){this.params=e,this.columnModel.isReady()&&this.showOrHideOptions()}createExpandIcons(){this.eExpand.appendChild(this.eExpandChecked=(0,n.asF)("columnSelectOpen",this.gos)),this.eExpand.appendChild(this.eExpandUnchecked=(0,n.asF)("columnSelectClosed",this.gos)),this.eExpand.appendChild(this.eExpandIndeterminate=(0,n.asF)("columnSelectIndeterminate",this.gos))}showOrHideOptions(){const e=!this.params.suppressFilterSearch,t=!this.params.suppressExpandAll,s=this.localeService.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(s("searchOoo","Search..."));const r=this.columnModel.getCols().some(o=>o.getOriginalParent()&&o.isFilterAllowed());(0,n.nl0)(this.eFilterTextField.getGui(),e),(0,n.nl0)(this.eExpand,t&&r)}onSearchTextChanged(){this.onSearchTextChangedDebounced||(this.onSearchTextChangedDebounced=(0,n.pkA)(()=>{this.dispatchLocalEvent({type:"searchChanged",searchText:this.eFilterTextField.getValue()})},300)),this.onSearchTextChangedDebounced()}onExpandClicked(){this.dispatchLocalEvent(0===this.currentExpandState?{type:"collapseAll"}:{type:"expandAll"})}setExpandState(e){this.currentExpandState=e,(0,n.nl0)(this.eExpandChecked,0===this.currentExpandState),(0,n.nl0)(this.eExpandUnchecked,1===this.currentExpandState),(0,n.nl0)(this.eExpandIndeterminate,2===this.currentExpandState)}}},as=class extends n.uAl{constructor(e,t){super('\n            <div class="ag-filter-toolpanel-instance">\n                <div class="ag-filter-toolpanel-header ag-filter-toolpanel-instance-header" data-ref="eFilterToolPanelHeader" role="button" aria-expanded="false">\n                    <div data-ref="eExpand" class="ag-filter-toolpanel-expand"></div>\n                    <span data-ref="eFilterName" class="ag-header-cell-text"></span>\n                    <span data-ref="eFilterIcon" class="ag-header-icon ag-filter-icon ag-filter-toolpanel-instance-header-icon" aria-hidden="true"></span>\n                </div>\n                <div class="ag-filter-toolpanel-instance-body ag-filter" data-ref="agFilterToolPanelBody"></div>\n            </div>'),this.expandedCallback=t,this.eFilterToolPanelHeader=n.dRA,this.eFilterName=n.dRA,this.agFilterToolPanelBody=n.dRA,this.eFilterIcon=n.dRA,this.eExpand=n.dRA,this.expanded=!1,this.hideHeader=e}wireBeans(e){this.filterManager=e.filterManager,this.columnNameService=e.columnNameService}postConstruct(){this.eExpandChecked=(0,n.asF)("columnSelectOpen",this.gos),this.eExpandUnchecked=(0,n.asF)("columnSelectClosed",this.gos),this.eExpand.appendChild(this.eExpandChecked),this.eExpand.appendChild(this.eExpandUnchecked)}setColumn(e){this.column=e,this.eFilterName.innerText=this.columnNameService.getDisplayNameForColumn(this.column,"filterToolPanel",!1)||"",this.addManagedListeners(this.eFilterToolPanelHeader,{click:this.toggleExpanded.bind(this),keydown:this.onKeyDown.bind(this)}),this.addManagedEventListeners({filterOpened:this.onFilterOpened.bind(this)}),this.addInIcon("filter",this.eFilterIcon,this.column),(0,n.nl0)(this.eFilterIcon,this.isFilterActive(),{skipAriaHidden:!0}),(0,n.nl0)(this.eExpandChecked,!1),this.hideHeader?((0,n.nl0)(this.eFilterToolPanelHeader,!1),this.eFilterToolPanelHeader.removeAttribute("tabindex")):this.eFilterToolPanelHeader.setAttribute("tabindex","0"),this.addManagedListeners(this.column,{filterChanged:this.onFilterChanged.bind(this)})}onKeyDown(e){const{key:t}=e,{ENTER:s,SPACE:i,LEFT:r,RIGHT:o}=n.DDm;t!==s&&t!==i&&t!==r&&t!==o||(e.preventDefault(),t===s||t===i?this.toggleExpanded():t===n.DDm.LEFT?this.collapse():this.expand())}getColumn(){return this.column}getColumnFilterName(){return this.columnNameService.getDisplayNameForColumn(this.column,"filterToolPanel",!1)}addCssClassToTitleBar(e){this.eFilterToolPanelHeader.classList.add(e)}addInIcon(e,t,s){if(null==t)return;const i=(0,n.asF)(e,this.gos,s);t.appendChild(i)}isFilterActive(){return!!this.filterManager?.isFilterActive(this.column)}onFilterChanged(){(0,n.nl0)(this.eFilterIcon,this.isFilterActive(),{skipAriaHidden:!0}),this.dispatchLocalEvent({type:"filterChanged"})}toggleExpanded(){this.expanded?this.collapse():this.expand()}expand(){this.expanded||(this.expanded=!0,(0,n.oAJ)(this.eFilterToolPanelHeader,!0),(0,n.nl0)(this.eExpandChecked,!0),(0,n.nl0)(this.eExpandUnchecked,!1),this.addFilterElement(),this.expandedCallback())}addFilterElement(e){const t=(0,n.cvw)('<div class="ag-filter-toolpanel-instance-filter"></div>'),s=this.createManagedBean(new n.jfj(this.column,"TOOLBAR"));this.filterWrapperComp=s,s.hasFilter()&&s.getFilter()?.then(i=>{this.underlyingFilter=i,i&&(t.appendChild(s.getGui()),this.agFilterToolPanelBody.appendChild(t),s.afterGuiAttached({container:"toolPanel",suppressFocus:e}))})}collapse(){this.expanded&&(this.expanded=!1,(0,n.oAJ)(this.eFilterToolPanelHeader,!1),this.removeFilterElement(),(0,n.nl0)(this.eExpandChecked,!1),(0,n.nl0)(this.eExpandUnchecked,!0),this.filterWrapperComp?.afterGuiDetached(),this.destroyBean(this.filterWrapperComp),this.expandedCallback())}removeFilterElement(){(0,n.fDi)(this.agFilterToolPanelBody)}isExpanded(){return this.expanded}refreshFilter(e){if(!this.expanded)return;const t=this.underlyingFilter;t&&(e?"function"==typeof t.refreshVirtualList&&t.refreshVirtualList():t.afterGuiDetached?.())}onFilterOpened(e){"COLUMN_MENU"===e.source&&e.column===this.column&&this.expanded&&this.collapse()}},$=class Ms extends n.uAl{constructor(t,s,i,r,o){super(),this.filterGroupComp=n.dRA,this.columnGroup=t,this.childFilterComps=s,this.depth=r,this.expandedCallback=i,this.showingColumn=o}wireBeans(t){this.columnNameService=t.columnNameService}postConstruct(){this.setTemplate('<div class="ag-filter-toolpanel-group-wrapper">\n            <ag-group-component data-ref="filterGroupComp"></ag-group-component>\n        </div>',[R.MU],{filterGroupComp:{cssIdentifier:"filter-toolpanel",direction:"vertical"}}),this.setGroupTitle(),this.filterGroupComp.setAlignItems("stretch"),this.filterGroupComp.addCssClass(`ag-filter-toolpanel-group-level-${this.depth}`),this.filterGroupComp.getGui().style.setProperty("--ag-indentation-level",String(this.depth)),this.filterGroupComp.addCssClassToTitleBar(`ag-filter-toolpanel-group-level-${this.depth}-header`),this.childFilterComps.forEach(s=>{this.filterGroupComp.addItem(s),s.addCssClassToTitleBar(`ag-filter-toolpanel-group-level-${this.depth+1}-header`),s.getGui().style.setProperty("--ag-indentation-level",String(this.depth+1))}),this.refreshFilterClass(),this.addExpandCollapseListeners(),this.addFilterChangedListeners(),this.setupTooltip(),this.addInIcon("filter")}setupTooltip(){if(!this.showingColumn)return;let s;"whenTruncated"===this.gos.get("tooltipShowMode")&&(s=()=>{const o=this.filterGroupComp.getGui().querySelector(".ag-group-title");return!o||o.scrollWidth>o.clientWidth});const i=()=>{const r=this.columnGroup.getColDef().headerTooltip;this.setTooltip({newTooltipText:r,location:"filterToolPanelColumnGroup",shouldDisplayTooltip:s})};i(),this.addManagedEventListeners({newColumnsLoaded:i})}getTooltipParams(){const t=super.getTooltipParams();return t.location="filterToolPanelColumnGroup",t}addCssClassToTitleBar(t){this.filterGroupComp.addCssClassToTitleBar(t)}refreshFilters(t){this.childFilterComps.forEach(s=>{s instanceof Ms?s.refreshFilters(t):s.refreshFilter(t)})}isColumnGroup(){return(0,n.b6I)(this.columnGroup)}isExpanded(){return this.filterGroupComp.isExpanded()}getChildren(){return this.childFilterComps}getFilterGroupName(){return this.filterGroupName?this.filterGroupName:""}getFilterGroupId(){return this.columnGroup.getId()}hideGroupItem(t,s){this.filterGroupComp.hideItem(t,s)}hideGroup(t){this.setDisplayed(!t)}addInIcon(t){const s=(0,n.asF)(t,this.gos);s&&s.classList.add("ag-filter-toolpanel-group-instance-header-icon"),this.filterGroupComp.addTitleBarWidget(s)}forEachToolPanelFilterChild(t){this.childFilterComps.forEach(s=>{s instanceof as&&t(s)})}addExpandCollapseListeners(){const t=this.isColumnGroup()?()=>this.expandedCallback():()=>this.forEachToolPanelFilterChild(i=>i.expand()),s=this.isColumnGroup()?()=>this.expandedCallback():()=>this.forEachToolPanelFilterChild(i=>i.collapse());this.addManagedListeners(this.filterGroupComp,{expanded:t,collapsed:s})}getColumns(){return(0,n.b6I)(this.columnGroup)?this.columnGroup.getLeafColumns():[this.columnGroup]}addFilterChangedListeners(){this.getColumns().forEach(t=>{this.addManagedListeners(t,{filterChanged:()=>this.refreshFilterClass()})}),(0,n.b6I)(this.columnGroup)||this.addManagedEventListeners({filterOpened:this.onFilterOpened.bind(this)})}refreshFilterClass(){const t=this.getColumns();this.filterGroupComp.addOrRemoveCssClass("ag-has-filter",t.some(i=>i.isFilterActive()))}onFilterOpened(t){"COLUMN_MENU"===t.source&&t.column===this.columnGroup&&this.isExpanded()&&this.collapse()}expand(){this.filterGroupComp.toggleGroupExpand(!0)}collapse(){this.filterGroupComp.toggleGroupExpand(!1)}setGroupTitle(){this.filterGroupName=(0,n.b6I)(this.columnGroup)?this.getColumnGroupName(this.columnGroup):this.getColumnName(this.columnGroup),this.filterGroupComp.setTitle(this.filterGroupName||"")}getColumnGroupName(t){return this.columnNameService.getDisplayNameForProvidedColumnGroup(null,t,"filterToolPanel")}getColumnName(t){return this.columnNameService.getDisplayNameForColumn(t,"filterToolPanel",!1)}destroyFilters(){this.childFilterComps=this.destroyBeans(this.childFilterComps),(0,n.fDi)(this.getGui())}destroy(){this.destroyFilters(),super.destroy()}},Yl={selector:"AG-FILTERS-TOOL-PANEL-LIST",component:class extends n.uAl{constructor(){super('<div class="ag-filter-list-panel"></div>'),this.initialised=!1,this.hasLoadedInitialState=!1,this.isInitialState=!1,this.filterGroupComps=[],this.suppressOnColumnsChanged=!1,this.onColumnsChangedPending=!1}wireBeans(e){this.toolPanelColDefService=e.toolPanelColDefService,this.columnModel=e.columnModel}init(e){this.initialised=!0;const t=this.gos.addGridCommonParams({suppressExpandAll:!1,suppressFilterSearch:!1,suppressSyncLayoutWithGrid:!1});(0,n.WY6)(t,e),this.params=t,this.params.suppressSyncLayoutWithGrid||this.addManagedEventListeners({columnMoved:()=>this.onColumnsChanged()}),this.addManagedEventListeners({newColumnsLoaded:()=>this.onColumnsChanged(),toolPanelVisibleChanged:s=>{"filters"===s.key&&this.refreshFilters(s.visible)},dragStarted:()=>{this.suppressOnColumnsChanged=!0},dragStopped:()=>{this.suppressOnColumnsChanged=!1,this.onColumnsChangedPending&&(this.onColumnsChangedPending=!1,this.onColumnsChanged())}}),this.columnModel.isReady()&&this.onColumnsChanged()}onColumnsChanged(){if(this.suppressOnColumnsChanged)return void(this.onColumnsChangedPending=!0);const e=this.columnModel.isPivotMode();this.params.suppressSyncLayoutWithGrid||e?this.buildTreeFromProvidedColumnDefs():this.syncFilterLayout(),this.refreshAriaLabel()}syncFilterLayout(){this.toolPanelColDefService.syncLayoutWithGrid(this.setFiltersLayout.bind(this)),this.refreshAriaLabel()}buildTreeFromProvidedColumnDefs(){const e=this.columnModel.getColDefColTree();this.recreateFilters(e)}setFiltersLayout(e){const t=this.toolPanelColDefService.createColumnTree(e);this.recreateFilters(t)}recreateFilters(e){const t=(0,n.UlD)(this.gos);this.hasLoadedInitialState||(this.hasLoadedInitialState=!0,this.isInitialState=!!this.params.initialState);const s=this.getExpansionState();this.destroyFilters(),this.filterGroupComps=this.recursivelyAddComps(e,0,s);const i=this.filterGroupComps.length;i&&(this.filterGroupComps.forEach(r=>this.appendChild(r)),this.setFirstAndLastVisible(0,i-1)),(0,n.Qmv)(this.searchFilterText)&&this.searchFilters(this.searchFilterText),this.fireExpandedEvent(),this.getGui().contains(t)&&t.focus(),this.isInitialState=!1,this.refreshAriaLabel()}recursivelyAddComps(e,t,s){return(0,n.Q1u)(e.map(i=>{if((0,n.b6I)(i))return(0,n.Q1u)(this.recursivelyAddFilterGroupComps(i,t,s));const r=i;if(!this.shouldDisplayFilter(r))return[];const l=new as(0===t,()=>this.onFilterExpanded());if(this.createBean(l),l.setColumn(r),s.get(r.getId())&&l.expand(),t>0)return l;const a=this.createBean(new $(r,[l],this.onGroupExpanded.bind(this),t,!0));return a.addCssClassToTitleBar("ag-filter-toolpanel-header"),s.get(a.getFilterGroupId())||a.collapse(),a}))}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaFilterPanelList","Filter List"),s=e("filters","Filters"),d=this.getGui().querySelectorAll(".ag-filter-toolpanel-group-item:not(.ag-filter-toolpanel-group-wrapper, .ag-hidden)").length;(0,n.PIC)(this.getAriaElement(),`${t} ${d} ${s}`)}recursivelyAddFilterGroupComps(e,t,s){if(!this.filtersExistInChildren(e.getChildren()))return;const i=e.getColGroupDef();if(i&&i.suppressFiltersToolPanel)return[];const r=e.isPadding()?t:t+1,o=(0,n.Q1u)(this.recursivelyAddComps(e.getChildren(),r,s));if(e.isPadding())return o;const l=new $(e,o,this.onGroupExpanded.bind(this),t,!1);this.createBean(l),l.addCssClassToTitleBar("ag-filter-toolpanel-header");const a=s.get(l.getFilterGroupId());return(this.isInitialState&&!a||!1===a)&&l.collapse(),[l]}filtersExistInChildren(e){return e.some(t=>(0,n.b6I)(t)?this.filtersExistInChildren(t.getChildren()):this.shouldDisplayFilter(t))}shouldDisplayFilter(e){const t=e.getColDef()&&e.getColDef().suppressFiltersToolPanel;return e.isFilterAllowed()&&!t}getExpansionState(){const e=new Map;if(this.isInitialState){const{expandedColIds:s,expandedGroupIds:i}=this.params.initialState;return s.forEach(r=>e.set(r,!0)),i.forEach(r=>e.set(r,!0)),e}const t=s=>{e.set(s.getFilterGroupId(),s.isExpanded()),s.getChildren().forEach(i=>{i instanceof $?t(i):e.set(i.getColumn().getId(),i.isExpanded())})};return this.filterGroupComps.forEach(t),e}refresh(){}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}expandFilterGroups(e,t){const s=[],i=r=>{const o=r.getFilterGroupId();(!t||(0,n.dRF)(t,o))&&(e&&r.isColumnGroup()?r.expand():r.collapse(),s.push(o)),r.getChildren().forEach(a=>{a instanceof $&&i(a)})};if(this.filterGroupComps.forEach(i),this.onGroupExpanded(),t){const r=t.filter(o=>s.indexOf(o)<0);r.length>0&&(0,n.JT7)("unable to find groups for these supplied groupIds:",r)}}expandFilters(e,t){const s=[],i=r=>{if(r instanceof $){let a=!1;return r.getChildren().forEach(d=>{i(d)&&(e?(r.expand(),a=!0):r.isColumnGroup()||r.collapse())}),a}const o=r.getColumn().getColId(),l=!t||(0,n.dRF)(t,o);return l&&(e?r.expand():r.collapse(),s.push(o)),l};if(this.filterGroupComps.forEach(i),this.onGroupExpanded(),t){const r=t.filter(o=>s.indexOf(o)<0);r.length>0&&(0,n.JT7)("unable to find columns for these supplied colIds:"+r)}}onGroupExpanded(){this.fireExpandedEvent()}onFilterExpanded(){this.dispatchLocalEvent({type:"filterExpanded"})}fireExpandedEvent(){let e=0,t=0;const s=r=>{r.isColumnGroup()&&(r.isExpanded()?e++:t++,r.getChildren().forEach(o=>{o instanceof $&&s(o)}))};let i;this.filterGroupComps.forEach(s),i=e>0&&t>0?2:t>0?1:0,this.dispatchLocalEvent({type:"groupExpanded",state:i})}performFilterSearch(e){this.searchFilterText=(0,n.Qmv)(e)?e.toLowerCase():null,this.searchFilters(this.searchFilterText)}searchFilters(e){const t=o=>!(0,n.Qmv)(e)||-1!==o.toLowerCase().indexOf(e),s=(o,l)=>{if(!(o instanceof $))return t(o.getColumnFilterName()||"");const a=o.getChildren(),d=t(o.getFilterGroupName()),u=l||d;if(u){o.hideGroup(!1);for(let c=0;c<a.length;c++)s(a[c],u),o.hideGroupItem(!1,c);return!0}let h=!1;return a.forEach((c,p)=>{const g=s(c,l);o.hideGroupItem(!g,p),g&&(h=!0)}),o.hideGroup(!h),h};let i,r;this.filterGroupComps.forEach((o,l)=>{s(o,!1),void 0===i?o.containsCssClass("ag-hidden")||(i=l,r=l):!o.containsCssClass("ag-hidden")&&r!==l&&(r=l)}),this.setFirstAndLastVisible(i,r),this.refreshAriaLabel()}setFirstAndLastVisible(e,t){this.filterGroupComps.forEach((s,i)=>{s.removeCssClass("ag-first-group-visible"),s.removeCssClass("ag-last-group-visible"),i===e&&s.addCssClass("ag-first-group-visible"),i===t&&s.addCssClass("ag-last-group-visible")})}refreshFilters(e){this.filterGroupComps.forEach(t=>t.refreshFilters(e))}getExpandedFiltersAndGroups(){const e=[],t=new Set,s=i=>{if(i instanceof $){i.getChildren().forEach(o=>s(o));const r=i.getFilterGroupId();i.isExpanded()&&!t.has(r)&&e.push(r)}else i.isExpanded()&&t.add(i.getColumn().getColId())};return this.filterGroupComps.forEach(s),{expandedGroupIds:e,expandedColIds:Array.from(t)}}destroyFilters(){this.filterGroupComps=this.destroyBeans(this.filterGroupComps),(0,n.fDi)(this.getGui())}destroy(){this.destroyFilters(),super.destroy()}}},ql=(0,n.n9N)({version:"32.3.3",moduleName:n.zsj.FiltersToolPanelModule,beans:[],userComponents:[{name:"agFiltersToolPanel",classImp:class extends n.uAl{constructor(){super('<div class="ag-filter-toolpanel">\n            <ag-filters-tool-panel-header data-ref="filtersToolPanelHeaderPanel"></ag-filters-tool-panel-header>\n            <ag-filters-tool-panel-list data-ref="filtersToolPanelListPanel"></ag-filters-tool-panel-list>\n         </div>',[jl,Yl]),this.filtersToolPanelHeaderPanel=n.dRA,this.filtersToolPanelListPanel=n.dRA,this.initialised=!1,this.listenerDestroyFuncs=[]}init(e){this.initialised&&(this.listenerDestroyFuncs.forEach(r=>r()),this.listenerDestroyFuncs=[]),this.initialised=!0;const t=this.gos.addGridCommonParams({suppressExpandAll:!1,suppressFilterSearch:!1,suppressSyncLayoutWithGrid:!1});this.params={...t,...e},this.filtersToolPanelHeaderPanel.init(this.params),this.filtersToolPanelListPanel.init(this.params),this.params.suppressExpandAll&&this.params.suppressFilterSearch&&this.filtersToolPanelHeaderPanel.setDisplayed(!1),this.listenerDestroyFuncs.push(...this.addManagedListeners(this.filtersToolPanelHeaderPanel,{expandAll:this.onExpandAll.bind(this),collapseAll:this.onCollapseAll.bind(this),searchChanged:this.onSearchChanged.bind(this)}),...this.addManagedListeners(this.filtersToolPanelListPanel,{filterExpanded:this.onFilterExpanded.bind(this),groupExpanded:this.onGroupExpanded.bind(this)}))}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}onExpandAll(){this.filtersToolPanelListPanel.expandFilterGroups(!0)}onCollapseAll(){this.filtersToolPanelListPanel.expandFilterGroups(!1)}onSearchChanged(e){this.filtersToolPanelListPanel.performFilterSearch(e.searchText)}setFilterLayout(e){this.filtersToolPanelListPanel.setFiltersLayout(e)}onFilterExpanded(){this.params.onStateUpdated()}onGroupExpanded(e){this.filtersToolPanelHeaderPanel.setExpandState(e.state),this.params.onStateUpdated()}expandFilterGroups(e){this.filtersToolPanelListPanel.expandFilterGroups(!0,e)}collapseFilterGroups(e){this.filtersToolPanelListPanel.expandFilterGroups(!1,e)}expandFilters(e){this.filtersToolPanelListPanel.expandFilters(!0,e)}collapseFilters(e){this.filtersToolPanelListPanel.expandFilters(!1,e)}syncLayoutWithGrid(){this.filtersToolPanelListPanel.syncFilterLayout()}refresh(e){return this.init(e),!0}getState(){return this.filtersToolPanelListPanel.getExpandedFiltersAndGroups()}destroy(){super.destroy()}}}],dependantModules:[Xe,R.bP,n.Sxk]}),ea=class{constructor(e,t,s){this.gos=e,this.chartService=t,this.localeService=s}getMenuItem(){const e=this.localeService.getLocaleTextFunc(),t=(s,i,r,o,l=!1)=>({name:e(s,i),action:()=>this.chartService.createPivotChart({chartType:r}),_key:o,_enterprise:l});return{name:e("pivotChart","Pivot Chart"),_key:"pivotChart",subMenu:[{_key:"pivotColumnChart",name:e("columnChart","Column"),subMenu:[t("groupedColumn","Grouped&lrm;","groupedColumn","pivotGroupedColumn"),t("stackedColumn","Stacked&lrm;","stackedColumn","pivotStackedColumn"),t("normalizedColumn","100% Stacked&lrm;","normalizedColumn","pivotNormalizedColumn")]},{_key:"pivotBarChart",name:e("barChart","Bar"),subMenu:[t("groupedBar","Grouped&lrm;","groupedBar","pivotGroupedBar"),t("stackedBar","Stacked&lrm;","stackedBar","pivotStackedBar"),t("normalizedBar","100% Stacked&lrm;","normalizedBar","pivotNormalizedBar")]},{_key:"pivotPieChart",name:e("pieChart","Pie"),subMenu:[t("pie","Pie&lrm;","pie","pivotPie"),t("donut","Donut&lrm;","donut","pivotDonut")]},t("line","Line&lrm;","line","pivotLineChart"),{_key:"pivotXYChart",name:e("xyChart","X Y (Scatter)"),subMenu:[t("scatter","Scatter&lrm;","scatter","pivotScatter"),t("bubble","Bubble&lrm;","bubble","pivotBubble")]},{_key:"pivotAreaChart",name:e("areaChart","Area"),subMenu:[t("area","Area&lrm;","area","pivotArea"),t("stackedArea","Stacked&lrm;","stackedArea","pivotStackedArea"),t("normalizedArea","100% Stacked&lrm;","normalizedArea","pivotNormalizedArea")]},{_key:"pivotStatisticalChart",_enterprise:!1,name:e("statisticalChart","Statistical"),subMenu:[t("histogramChart","Histogram&lrm;","histogram","pivotHistogram",!1)]},{_key:"pivotHierarchicalChart",_enterprise:!0,name:e("hierarchicalChart","Hierarchical"),subMenu:[t("treemapChart","Treemap&lrm;","treemap","pivotTreemap",!0),t("sunburstChart","Sunburst&lrm;","sunburst","pivotSunburst",!0)]},{_key:"pivotCombinationChart",name:e("combinationChart","Combination"),subMenu:[t("columnLineCombo","Column & Line&lrm;","columnLineCombo","pivotColumnLineCombo"),t("AreaColumnCombo","Area & Column&lrm;","areaColumnCombo","pivotAreaColumnCombo")]}],icon:(0,n.asF)("chart",this.gos,void 0)}}getConfigLookup(){return{columnGroup:{_key:"pivotColumnChart",column:"pivotGroupedColumn",stackedColumn:"pivotStackedColumn",normalizedColumn:"pivotNormalizedColumn"},barGroup:{_key:"pivotBarChart",bar:"pivotGroupedBar",stackedBar:"pivotStackedBar",normalizedBar:"pivotNormalizedBar"},pieGroup:{_key:"pivotPieChart",pie:"pivotPie",donut:"pivotDonut",doughnut:"pivotDonut"},lineGroup:{_key:"pivotLineChart",line:"pivotLineChart"},scatterGroup:{_key:"pivotXYChart",bubble:"pivotBubble",scatter:"pivotScatter"},areaGroup:{_key:"pivotAreaChart",area:"pivotArea",stackedArea:"pivotStackedArea",normalizedArea:"pivotNormalizedArea"},combinationGroup:{_key:"pivotCombinationChart",columnLineCombo:"pivotColumnLineCombo",areaColumnCombo:"pivotAreaColumnCombo",customCombo:null},hierarchicalGroup:{_key:"pivotHierarchicalChart",treemap:"pivotTreemap",sunburst:"pivotSunburst"},statisticalGroup:{_key:"pivotStatisticalChart",histogram:"pivotHistogram",rangeBar:null,rangeArea:null,boxPlot:null},polarGroup:null,specializedGroup:null}}},ta=class{constructor(e,t,s){this.gos=e,this.chartService=t,this.localeService=s}getMenuItem(){const e=this.localeService.getLocaleTextFunc(),t=(s,i,r,o,l=!1)=>({name:e(s,i),action:()=>this.chartService.createChartFromCurrentRange(r),_key:o,_enterprise:l});return{name:e("chartRange","Chart Range"),_key:"chartRange",subMenu:[{name:e("columnChart","Column"),subMenu:[t("groupedColumn","Grouped&lrm;","groupedColumn","rangeGroupedColumn"),t("stackedColumn","Stacked&lrm;","stackedColumn","rangeStackedColumn"),t("normalizedColumn","100% Stacked&lrm;","normalizedColumn","rangeNormalizedColumn")],_key:"rangeColumnChart"},{name:e("barChart","Bar"),subMenu:[t("groupedBar","Grouped&lrm;","groupedBar","rangeGroupedBar"),t("stackedBar","Stacked&lrm;","stackedBar","rangeStackedBar"),t("normalizedBar","100% Stacked&lrm;","normalizedBar","rangeNormalizedBar")],_key:"rangeBarChart"},{name:e("pieChart","Pie"),subMenu:[t("pie","Pie&lrm;","pie","rangePie"),t("donut","Donut&lrm;","donut","rangeDonut")],_key:"rangePieChart"},t("line","Line&lrm;","line","rangeLineChart"),{name:e("xyChart","X Y (Scatter)"),subMenu:[t("scatter","Scatter&lrm;","scatter","rangeScatter"),t("bubble","Bubble&lrm;","bubble","rangeBubble")],_key:"rangeXYChart"},{name:e("areaChart","Area"),subMenu:[t("area","Area&lrm;","area","rangeArea"),t("stackedArea","Stacked&lrm;","stackedArea","rangeStackedArea"),t("normalizedArea","100% Stacked&lrm;","normalizedArea","rangeNormalizedArea")],_key:"rangeAreaChart"},{name:e("polarChart","Polar"),subMenu:[t("radarLine","Radar Line&lrm;","radarLine","rangeRadarLine"),t("radarArea","Radar Area&lrm;","radarArea","rangeRadarArea"),t("nightingale","Nightingale&lrm;","nightingale","rangeNightingale"),t("radialColumn","Radial Column&lrm;","radialColumn","rangeRadialColumn"),t("radialBar","Radial Bar&lrm;","radialBar","rangeRadialBar")],_key:"rangePolarChart",_enterprise:!0},{name:e("statisticalChart","Statistical"),subMenu:[t("boxPlot","Box Plot&lrm;","boxPlot","rangeBoxPlot",!0),t("histogramChart","Histogram&lrm;","histogram","rangeHistogram",!1),t("rangeBar","Range Bar&lrm;","rangeBar","rangeRangeBar",!0),t("rangeArea","Range Area&lrm;","rangeArea","rangeRangeArea",!0)],_key:"rangeStatisticalChart",_enterprise:!1},{name:e("hierarchicalChart","Hierarchical"),subMenu:[t("treemap","Treemap&lrm;","treemap","rangeTreemap"),t("sunburst","Sunburst&lrm;","sunburst","rangeSunburst")],_key:"rangeHierarchicalChart",_enterprise:!0},{name:e("specializedChart","Specialized"),subMenu:[t("heatmap","Heatmap&lrm;","heatmap","rangeHeatmap"),t("waterfall","Waterfall&lrm;","waterfall","rangeWaterfall")],_key:"rangeSpecializedChart",_enterprise:!0},{name:e("combinationChart","Combination"),subMenu:[t("columnLineCombo","Column & Line&lrm;","columnLineCombo","rangeColumnLineCombo"),t("AreaColumnCombo","Area & Column&lrm;","areaColumnCombo","rangeAreaColumnCombo")],_key:"rangeCombinationChart"}],icon:(0,n.asF)("chart",this.gos,void 0)}}getConfigLookup(){return{columnGroup:{_key:"rangeColumnChart",column:"rangeGroupedColumn",stackedColumn:"rangeStackedColumn",normalizedColumn:"rangeNormalizedColumn"},barGroup:{_key:"rangeBarChart",bar:"rangeGroupedBar",stackedBar:"rangeStackedBar",normalizedBar:"rangeNormalizedBar"},pieGroup:{_key:"rangePieChart",pie:"rangePie",donut:"rangeDonut",doughnut:"rangeDonut"},lineGroup:{_key:"rangeLineChart",line:"rangeLineChart"},scatterGroup:{_key:"rangeXYChart",bubble:"rangeBubble",scatter:"rangeScatter"},areaGroup:{_key:"rangeAreaChart",area:"rangeArea",stackedArea:"rangeStackedArea",normalizedArea:"rangeNormalizedArea"},polarGroup:{_key:"rangePolarChart",radarLine:"rangeRadarLine",radarArea:"rangeRadarArea",nightingale:"rangeNightingale",radialColumn:"rangeRadialColumn",radialBar:"rangeRadialBar"},statisticalGroup:{_key:"rangeStatisticalChart",boxPlot:"rangeBoxPlot",histogram:"rangeHistogram",rangeBar:"rangeRangeBar",rangeArea:"rangeRangeArea"},hierarchicalGroup:{_key:"rangeHierarchicalChart",treemap:"rangeTreemap",sunburst:"rangeSunburst"},specializedGroup:{_key:"rangeSpecializedChart",heatmap:"rangeHeatmap",waterfall:"rangeWaterfall"},combinationGroup:{_key:"rangeCombinationChart",columnLineCombo:"rangeColumnLineCombo",areaColumnCombo:"rangeAreaColumnCombo",customCombo:null}}}},re="separator",ds="ag-context-menu-open",na=class extends n.uAl{constructor(e,t,s,i){super('<div class="ag-menu" role="presentation"></div>'),this.menuItems=e,this.column=t,this.node=s,this.value=i,this.menuList=null,this.focusedCell=null}wireBeans(e){this.focusService=e.focusService,this.menuItemMapper=e.menuItemMapper,this.cellPositionUtils=e.cellPositionUtils}postConstruct(){const e=this.createManagedBean(new R.i9(0,{column:this.column,node:this.node,value:this.value})),t=this.menuItemMapper.mapWithStockItems(this.menuItems,null,()=>this.getGui(),"contextMenu");e.addMenuItems(t),this.appendChild(e),this.menuList=e,e.addEventListener("closeMenu",s=>this.dispatchLocalEvent(s))}afterGuiAttached(e){e.hidePopup&&this.addDestroyFunc(e.hidePopup),this.focusedCell=this.focusService.getFocusedCell(),this.menuList&&this.focusService.focusInto(this.menuList.getGui())}restoreFocusedCell(){const e=this.focusService.getFocusedCell();if(e&&this.focusedCell&&this.cellPositionUtils.equals(e,this.focusedCell)){const{rowIndex:t,rowPinned:s,column:i}=this.focusedCell;(0,n.sNX)(this.gos)&&this.focusService.setFocusedCell({rowIndex:t,column:i,rowPinned:s,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!this.focusService.isKeyboardMode()})}}destroy(){this.restoreFocusedCell(),super.destroy()}},W="filterMenuTab",j="generalMenuTab",X="columnsMenuTab",Me=[j,W,X],aa=class extends n.XQb{constructor(e,t,s,i,r){super(),this.column=e,this.restoreFocusParams=t,this.initialSelection=s,this.restrictTo=i,this.sourceElement=r,this.tabFactories={},this.includeChecks={},this.tabFactories[j]=this.createMainPanel.bind(this),this.tabFactories[W]=this.createFilterPanel.bind(this),this.tabFactories[X]=this.createColumnsPanel.bind(this),this.includeChecks[j]=()=>!0,this.includeChecks[W]=()=>!!e&&!!this.filterManager?.isFilterAllowed(e),this.includeChecks[X]=()=>!0}wireBeans(e){this.filterManager=e.filterManager,this.columnChooserFactory=e.columnChooserFactory,this.columnMenuFactory=e.columnMenuFactory,this.menuUtils=e.menuUtils}postConstruct(){const e=this.getTabsToCreate().map(t=>this.createTab(t));this.tabbedLayout=new R.Lf({items:e,cssClass:"ag-menu",onActiveItemClicked:this.onHidePopup.bind(this),onItemClicked:this.onTabItemClicked.bind(this)}),this.createBean(this.tabbedLayout),this.mainMenuList&&this.mainMenuList.setParentComponent(this.tabbedLayout),this.addDestroyFunc(()=>this.destroyBean(this.tabbedLayout))}getTabsToCreate(){return this.restrictTo?this.restrictTo:(this.column?.getColDef().menuTabs??Me).filter(e=>this.isValidMenuTabItem(e)).filter(e=>this.isNotSuppressed(e)).filter(e=>this.isModuleLoaded(e))}isModuleLoaded(e){return e!==X||this.gos.isModuleRegistered(n.zsj.ColumnsToolPanelModule)}isValidMenuTabItem(e){let t=!0,s=Me;return null!=this.restrictTo&&(t=this.restrictTo.indexOf(e)>-1,s=this.restrictTo),t=t&&Me.indexOf(e)>-1,t||(0,n.JT7)(`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of [${s}]`),t}isNotSuppressed(e){return this.includeChecks[e]()}createTab(e){return this.tabFactories[e]()}showTabBasedOnPreviousSelection(){this.showTab(this.initialSelection)}showTab(e){this.tabItemColumns&&e===X?this.tabbedLayout.showItem(this.tabItemColumns):this.tabItemFilter&&e===W?this.tabbedLayout.showItem(this.tabItemFilter):this.tabItemGeneral&&e===j?this.tabbedLayout.showItem(this.tabItemGeneral):this.tabbedLayout.showFirstItem()}onTabItemClicked(e){let t=null;switch(e.item){case this.tabItemColumns:t=X;break;case this.tabItemFilter:t=W;break;case this.tabItemGeneral:t=j}t&&this.activateTab(t)}activateTab(e){this.dispatchLocalEvent({type:"tabSelected",key:e})}createMainPanel(){return this.mainMenuList=this.columnMenuFactory.createMenu(this,this.columnMenuFactory.getMenuItems(this.column),this.column,()=>this.sourceElement??this.getGui()),this.mainMenuList.addEventListener("closeMenu",this.onHidePopup.bind(this)),this.tabItemGeneral={title:(0,n.asF)("menu",this.gos,this.column),titleLabel:j.replace("MenuTab",""),bodyPromise:n.oY$.resolve(this.mainMenuList.getGui()),name:j},this.tabItemGeneral}onHidePopup(e){this.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}createFilterPanel(){const e=this.column?this.createBean(new n.jfj(this.column,"COLUMN_MENU")):null;if(this.filterComp=e,!e?.hasFilter())throw new Error("AG Grid - Unable to instantiate filter");return this.tabItemFilter={title:(0,n.asF)("filter",this.gos,this.column),titleLabel:W.replace("MenuTab",""),bodyPromise:n.oY$.resolve(e?.getGui()),afterAttachedCallback:i=>e.afterGuiAttached(i),afterDetachedCallback:()=>e.afterGuiDetached(),name:W},this.tabItemFilter}createColumnsPanel(){const e=document.createElement("div");e.classList.add("ag-menu-column-select-wrapper");const s=this.columnChooserFactory.createColumnSelectPanel(this,this.column).getGui();return s.classList.add("ag-menu-column-select"),e.appendChild(s),this.tabItemColumns={title:(0,n.asF)("columns",this.gos,this.column),titleLabel:X.replace("MenuTab",""),bodyPromise:n.oY$.resolve(e),name:X},this.tabItemColumns}afterGuiAttached(e){const{container:t,hidePopup:s}=e;this.tabbedLayout.setAfterAttachedParams({container:t,hidePopup:s}),s&&(this.hidePopupFunc=s,this.addDestroyFunc(s))}getGui(){return this.tabbedLayout.getGui()}destroy(){super.destroy(),this.destroyBean(this.filterComp)}},da=class extends n.uAl{constructor(e,t,s,i){super('\n            <div data-ref="eColumnMenu" role="presentation" class="ag-menu ag-column-menu"></div>\n        '),this.menuItems=e,this.column=t,this.restoreFocusParams=s,this.sourceElement=i,this.eColumnMenu=n.dRA}wireBeans(e){this.columnMenuFactory=e.columnMenuFactory,this.menuUtils=e.menuUtils,this.focusService=e.focusService}postConstruct(){this.mainMenuList=this.columnMenuFactory.createMenu(this,this.menuItems,this.column,()=>this.sourceElement??this.getGui()),this.mainMenuList.addEventListener("closeMenu",this.onHidePopup.bind(this)),this.eColumnMenu.appendChild(this.mainMenuList.getGui())}onHidePopup(e){this.menuUtils.closePopupAndRestoreFocusOnSelect(this.hidePopupFunc,this.restoreFocusParams,e)}afterGuiAttached({hidePopup:e}){e&&(this.hidePopupFunc=e,this.addDestroyFunc(e)),this.focusService.focusInto(this.mainMenuList.getGui())}},st="32.3.3",us=(0,n.n9N)({version:st,moduleName:`${n.zsj.MenuModule}-core`,beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="enterpriseMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.visibleColsService=e.visibleColsService,this.filterManager=e.filterManager,this.menuUtils=e.menuUtils,this.menuService=e.menuService,this.columnMenuFactory=e.columnMenuFactory}hideActiveMenu(){this.destroyBean(this.activeMenu)}showMenuAfterMouseEvent(e,t,s,i){const{column:r,columnGroup:o}=this.splitColumnOrGroup(e),l=i?"filterMenuTab":void 0;this.showMenu(r,o,a=>{const d=a.getGui();this.popupService.positionPopupUnderMouseEvent({type:s,column:r,mouseEvent:t,ePopup:d}),l&&a.showTab?.(l),this.dispatchVisibleChangedEvent(!0,!1,r,o,l)},s,l,void 0,t.target)}splitColumnOrGroup(e){const t=e&&(0,n.R39)(e);return{column:t?e:void 0,columnGroup:t?void 0:e}}showMenuAfterButtonClick(e,t,s,i){let r=-1,o="left";this.gos.get("enableRtl")&&(r=1,o="right");const l=i?"filterMenuTab":void 0,a=l?[l]:void 0,d=this.menuService.isLegacyMenuEnabled(),u=(d?9:4)*r,h=d?-23:4,{column:c,columnGroup:p}=this.splitColumnOrGroup(e);this.showMenu(c,p,g=>{const f=g.getGui();this.popupService.positionPopupByComponent({type:s,column:c,eventSource:t,ePopup:f,alignSide:o,nudgeX:u,nudgeY:h,position:"under",keepWithinBounds:!0}),l&&g.showTab?.(l),this.dispatchVisibleChangedEvent(!0,!1,c,p,l)},s,l,a,t)}showMenu(e,t,s,i,r,o,l){const a=this.getMenuParams(e,t,o,l);if(!a)return;const{menu:d,eMenuGui:u,anchorToElement:h,restoreFocusParams:c}=a,p=[];p.push(f=>{const v=d.getGui();this.destroyBean(d),e&&(e.setMenuVisible(!1,"contextMenu"),this.menuUtils.restoreFocusOnClose(c,v,f))});const g=this.localeService.getLocaleTextFunc();if(this.popupService.addPopup({modal:!0,eChild:u,closeOnEsc:!0,closedCallback:f=>{p.forEach(v=>v(f)),this.dispatchVisibleChangedEvent(!1,!1,e,t,r)},afterGuiAttached:f=>d.afterGuiAttached(Object.assign({},{container:i},f)),positionCallback:r?()=>s(d):void 0,ariaLabel:g("ariaLabelColumnMenu","Column Menu")}),r||(d.showTabBasedOnPreviousSelection?.(),s(d)),this.menuService.isColumnMenuAnchoringEnabled()){const f=this.popupService.setPopupPositionRelatedToElement(u,h);f&&e&&this.addStopAnchoring(f,e,p)}d.addEventListener("tabSelected",f=>{this.dispatchVisibleChangedEvent(!1,!0,e),this.lastSelectedTab=f.key,this.dispatchVisibleChangedEvent(!0,!0,e)}),e?.setMenuVisible(!0,"contextMenu"),this.activeMenu=d,d.addEventListener("destroyed",()=>{this.activeMenu===d&&(this.activeMenu=null)})}addStopAnchoring(e,t,s){e.then(i=>{t.addEventListener("leftChanged",i),t.addEventListener("visibleChanged",i),s.push(()=>{t.removeEventListener("leftChanged",i),t.removeEventListener("visibleChanged",i)})})}getMenuParams(e,t,s,i){const r={column:e,headerPosition:this.focusService.getFocusedHeader(),columnIndex:this.visibleColsService.getAllCols().indexOf(e),eventSource:i},o=this.createMenu(e,t,r,s,i);return o?{menu:o,eMenuGui:o.getGui(),anchorToElement:i||this.ctrlsService.getGridBodyCtrl().getGui(),restoreFocusParams:r}:void 0}createMenu(e,t,s,i,r){if(this.menuService.isLegacyMenuEnabled())return this.createBean(new aa(e,s,this.lastSelectedTab,i,r));{const o=this.columnMenuFactory.getMenuItems(e,t);return o.length?this.createBean(new da(o,e,s,r)):void 0}}dispatchVisibleChangedEvent(e,t,s,i,r){this.eventService.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:t,key:this.lastSelectedTab??r??(this.menuService.isLegacyMenuEnabled()?j:"columnMenu"),column:s??null,columnGroup:i??null})}isMenuEnabled(e){if(!this.menuService.isLegacyMenuEnabled())return!0;const t=!this.filterManager?.isFilterAllowed(e),s=e.getColDef().menuTabs??Me;return(t&&s.includes(W)?s.length-1:s.length)>0}showMenuAfterContextMenuEvent(e,t,s){this.menuUtils.onContextMenu(t,s,i=>(this.showMenuAfterMouseEvent(e,i,"columnMenu"),!0))}},class extends n.XQb{constructor(){super(...arguments),this.beanName="contextMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.menuUtils=e.menuUtils,this.rangeService=e.rangeService,this.focusService=e.focusService}hideActiveMenu(){this.destroyBean(this.activeMenu)}getMenuItems(e,t,s){const i=[];if((0,n.Qmv)(e)&&this.gos.isModuleRegistered(n.zsj.ClipboardModule)&&t&&(this.gos.get("suppressCutToClipboard")||i.push("cut"),i.push("copy","copyWithHeaders","copyWithGroupHeaders","paste","separator")),this.gos.get("enableCharts")&&this.gos.isModuleRegistered(n.zsj.GridChartsModule)&&(this.columnModel.isPivotMode()&&i.push("pivotChart"),this.rangeService&&!this.rangeService.isEmpty()&&i.push("chartRange")),(0,n.Qmv)(e)){const a=!this.gos.isModuleRegistered(n.zsj.CsvExportModule),d=!this.gos.isModuleRegistered(n.zsj.ExcelExportModule),u=this.gos.get("suppressExcelExport")||d,h=this.gos.get("suppressCsvExport")||a;!(0,n.TvF)()&&(!u||!h)&&i.push("export")}const r=i.length?i:void 0,o=t?.getColDef().contextMenuItems;if(Array.isArray(o))return o;if("function"==typeof o)return o(this.gos.addGridCommonParams({column:t,node:e,value:s,defaultItems:r}));const l=this.gos.getCallback("getContextMenuItems");return l?l({column:t,node:e,value:s,defaultItems:r}):i}onContextMenu(e,t,s,i,r,o){this.menuUtils.onContextMenu(e,t,l=>this.showMenu(s,i,r,l,o))}showMenu(e,t,s,i,r){const o=this.getMenuItems(e,t,s),l=this.ctrlsService.getGridBodyCtrl().getGui();if(void 0===o||(0,n.Wgl)(o))return!1;const a=new na(o,t,e,s);this.createBean(a);const d=a.getGui();t||this.focusService.clearFocusedCell();const u={column:t,rowNode:e,type:"contextMenu",mouseEvent:i,ePopup:d,nudgeY:1},h=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({modal:!0,eChild:d,closeOnEsc:!0,closedCallback:g=>{l.classList.remove(ds),this.destroyBean(a),this.dispatchVisibleChangedEvent(!1,void 0===g?"api":"ui")},click:i,positionCallback:()=>{const g=this.gos.get("enableRtl");this.popupService.positionPopupUnderMouseEvent({...u,nudgeX:g?-1*(d.offsetWidth+1):1})},anchorToElement:r,ariaLabel:h("ariaLabelContextMenu","Context Menu")});c&&(l.classList.add(ds),a.afterGuiAttached({container:"contextMenu",hidePopup:c.hideFunc})),this.activeMenu&&this.hideActiveMenu(),this.activeMenu=a,a.addEventListener("destroyed",()=>{this.activeMenu===a&&(this.activeMenu=null)}),c&&a.addEventListener("closeMenu",g=>c.hideFunc({mouseEvent:g.mouseEvent??void 0,keyboardEvent:g.keyboardEvent??void 0,forceHide:!0}));const p=i&&i instanceof MouseEvent&&"mousedown"===i.type;return this.dispatchVisibleChangedEvent(!0,p?"api":"ui"),!0}dispatchVisibleChangedEvent(e,t="ui"){this.eventService.dispatchEvent({type:"contextMenuVisibleChanged",visible:e,source:t})}},class extends n.XQb{constructor(){super(...arguments),this.beanName="menuItemMapper"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.columnApplyStateService=e.columnApplyStateService,this.funcColsService=e.funcColsService,this.focusService=e.focusService,this.rowPositionUtils=e.rowPositionUtils,this.chartMenuItemMapper=e.chartMenuItemMapper,this.menuService=e.menuService,this.sortController=e.sortController,this.columnAutosizeService=e.columnAutosizeService,this.expansionService=e.expansionService,this.clipboardService=e.clipboardService,this.aggFuncService=e.aggFuncService,this.csvCreator=e.csvCreator,this.excelCreator=e.excelCreator}mapWithStockItems(e,t,s,i){if(!e)return[];const r=[];return e.forEach(o=>{let l;if(l="string"==typeof o?this.getStockMenuItem(o,t,s,i):{...o},!l)return;const a=l,{subMenu:d}=a;d&&d instanceof Array&&(a.subMenu=this.mapWithStockItems(d,t,s,i)),null!=l&&r.push(l)}),r}getStockMenuItem(e,t,s,i){const r=this.localeService.getLocaleTextFunc(),o=this.gos.get("skipHeaderOnAutoSize");switch(e){case"pinSubMenu":return{name:r("pinColumn","Pin Column"),icon:(0,n.asF)("menuPin",this.gos,null),subMenu:["clearPinned","pinLeft","pinRight"]};case"pinLeft":return{name:r("pinLeft","Pin Left"),action:()=>this.columnModel.setColsPinned([t],"left",i),checked:!!t&&t.isPinnedLeft()};case"pinRight":return{name:r("pinRight","Pin Right"),action:()=>this.columnModel.setColsPinned([t],"right",i),checked:!!t&&t.isPinnedRight()};case"clearPinned":return{name:r("noPin","No Pin"),action:()=>this.columnModel.setColsPinned([t],null,i),checked:!!t&&!t.isPinned()};case"valueAggSubMenu":return this.gos.assertModuleRegistered(n.zsj.RowGroupingModule,"Aggregation from Menu")&&(t?.isPrimary()||t?.getColDef().pivotValueColumn)?{name:r("valueAggregation","Value Aggregation"),icon:(0,n.asF)("menuValue",this.gos,null),subMenu:this.createAggregationSubMenu(t,this.aggFuncService),disabled:this.gos.get("functionsReadOnly")}:null;case"autoSizeThis":return{name:r("autosizeThisColumn","Autosize This Column"),action:()=>this.columnAutosizeService.autoSizeColumn(t,i,o)};case"autoSizeAll":return{name:r("autosizeAllColumns","Autosize All Columns"),action:()=>this.columnAutosizeService.autoSizeAllColumns(i,o)};case"rowGroup":return{name:r("groupBy","Group by")+" "+(0,n.YR0)(this.columnNameService.getDisplayNameForColumn(t,"header")),disabled:this.gos.get("functionsReadOnly")||t?.isRowGroupActive()||!t?.getColDef().enableRowGroup,action:()=>this.funcColsService.addRowGroupColumns([t],i),icon:(0,n.asF)("menuAddRowGroup",this.gos,null)};case"rowUnGroup":{const l=(0,n.asF)("menuRemoveRowGroup",this.gos,null),a=t?.getColDef().showRowGroup,d=this.gos.get("groupLockGroupColumns");if(!0===a)return{name:r("ungroupAll","Un-Group All"),disabled:this.gos.get("functionsReadOnly")||-1===d||d>=this.funcColsService.getRowGroupColumns().length,action:()=>this.funcColsService.setRowGroupColumns(this.funcColsService.getRowGroupColumns().slice(0,d),i),icon:l};if("string"==typeof a){const u=this.columnModel.getColDefCol(a),h=null!=u?(0,n.YR0)(this.columnNameService.getDisplayNameForColumn(u,"header")):a;return{name:r("ungroupBy","Un-Group by")+" "+h,disabled:this.gos.get("functionsReadOnly")||null!=u&&this.columnModel.isColGroupLocked(u),action:()=>this.funcColsService.removeRowGroupColumns([a],i),icon:l}}return{name:r("ungroupBy","Un-Group by")+" "+(0,n.YR0)(this.columnNameService.getDisplayNameForColumn(t,"header")),disabled:this.gos.get("functionsReadOnly")||!t?.isRowGroupActive()||!t?.getColDef().enableRowGroup||this.columnModel.isColGroupLocked(t),action:()=>this.funcColsService.removeRowGroupColumns([t],i),icon:l}}case"resetColumns":return{name:r("resetColumns","Reset Columns"),action:()=>this.columnApplyStateService.resetColumnState(i)};case"expandAll":return{name:r("expandAll","Expand All Row Groups"),action:()=>this.expansionService.expandAll(!0)};case"contractAll":return{name:r("collapseAll","Collapse All Row Groups"),action:()=>this.expansionService.expandAll(!1)};case"copy":return this.gos.assertModuleRegistered(n.zsj.ClipboardModule,"Copy from Menu")?{name:r("copy","Copy"),shortcut:r("ctrlC","Ctrl+C"),icon:(0,n.asF)("clipboardCopy",this.gos,null),action:()=>this.clipboardService.copyToClipboard()}:null;case"copyWithHeaders":return this.gos.assertModuleRegistered(n.zsj.ClipboardModule,"Copy with Headers from Menu")?{name:r("copyWithHeaders","Copy with Headers"),icon:(0,n.asF)("clipboardCopy",this.gos,null),action:()=>this.clipboardService.copyToClipboard({includeHeaders:!0})}:null;case"copyWithGroupHeaders":return this.gos.assertModuleRegistered(n.zsj.ClipboardModule,"Copy with Group Headers from Menu")?{name:r("copyWithGroupHeaders","Copy with Group Headers"),icon:(0,n.asF)("clipboardCopy",this.gos,null),action:()=>this.clipboardService.copyToClipboard({includeHeaders:!0,includeGroupHeaders:!0})}:null;case"cut":if(this.gos.assertModuleRegistered(n.zsj.ClipboardModule,"Cut from Menu")){const l=this.focusService.getFocusedCell(),a=l?this.rowPositionUtils.getRowNode(l):null,d=!!a&&l?.column.isCellEditable(a);return{name:r("cut","Cut"),shortcut:r("ctrlX","Ctrl+X"),icon:(0,n.asF)("clipboardCut",this.gos,null),disabled:!d||this.gos.get("suppressCutToClipboard"),action:()=>this.clipboardService.cutToClipboard(void 0,"contextMenu")}}return null;case"paste":return this.gos.assertModuleRegistered(n.zsj.ClipboardModule,"Paste from Clipboard")?{name:r("paste","Paste"),shortcut:r("ctrlV","Ctrl+V"),disabled:!0,icon:(0,n.asF)("clipboardPaste",this.gos,null),action:()=>this.clipboardService.pasteFromClipboard()}:null;case"export":{const l=[],a=this.gos.isModuleRegistered(n.zsj.CsvExportModule),d=this.gos.isModuleRegistered(n.zsj.ExcelExportModule);return!this.gos.get("suppressCsvExport")&&a&&l.push("csvExport"),!this.gos.get("suppressExcelExport")&&d&&l.push("excelExport"),{name:r("export","Export"),subMenu:l,icon:(0,n.asF)("save",this.gos,null)}}case"csvExport":return{name:r("csvExport","CSV Export"),icon:(0,n.asF)("csvExport",this.gos,null),action:()=>this.csvCreator?.exportDataAsCsv()};case"excelExport":return{name:r("excelExport","Excel Export"),icon:(0,n.asF)("excelExport",this.gos,null),action:()=>this.excelCreator?.exportDataAsExcel()};case"separator":return"separator";case"pivotChart":case"chartRange":return this.chartMenuItemMapper.getChartItems(e)??null;case"columnFilter":return t?{name:r("columnFilter","Column Filter"),icon:(0,n.asF)("filter",this.gos,null),action:()=>this.menuService.showFilterMenu({column:t,buttonElement:s(),containerType:"columnFilter",positionBy:"button"})}:null;case"columnChooser":return this.gos.isModuleRegistered(n.zsj.ColumnsToolPanelModule)?{name:r("columnChooser","Choose Columns"),icon:(0,n.asF)("columns",this.gos,null),action:()=>this.menuService.showColumnChooser({column:t,eventSource:s()})}:null;case"sortAscending":return{name:r("sortAscending","Sort Ascending"),icon:(0,n.asF)("sortAscending",this.gos,null),action:()=>this.sortController.setSortForColumn(t,"asc",!1,i)};case"sortDescending":return{name:r("sortDescending","Sort Descending"),icon:(0,n.asF)("sortDescending",this.gos,null),action:()=>this.sortController.setSortForColumn(t,"desc",!1,i)};case"sortUnSort":return{name:r("sortUnSort","Clear Sort"),icon:(0,n.asF)("sortUnSort",this.gos,null),action:()=>this.sortController.setSortForColumn(t,null,!1,i)};default:return(0,n.JT7)(`unknown menu item type ${e}`),null}}createAggregationSubMenu(e,t){const s=this.localeService.getLocaleTextFunc();let i;if(e.isPrimary())i=e;else{const o=e.getColDef().pivotValueColumn;i=(0,n.Qmv)(o)?o:void 0}const r=[];if(i){const o=i.isValueActive(),l=t.getFuncNames(i);r.push({name:s("noAggregation","None"),action:()=>{this.funcColsService.removeValueColumns([i],"contextMenu"),this.funcColsService.setColumnAggFunc(i,void 0,"contextMenu")},checked:!o}),l.forEach(a=>{r.push({name:s(a,t.getDefaultFuncLabel(a)),action:()=>{this.funcColsService.setColumnAggFunc(i,a,"contextMenu"),this.funcColsService.addValueColumns([i],"contextMenu")},checked:o&&i.getAggFunc()===a})})}return r}},class As extends n.XQb{constructor(){super(...arguments),this.beanName="chartMenuItemMapper"}wireBeans(t){this.chartService=t.chartService}getChartItems(t){if(!this.chartService)return void this.gos.assertModuleRegistered(n.zsj.GridChartsModule,`the Context Menu key "${t}"`);const s="pivotChart"===t?new ea(this.gos,this.chartService,this.localeService):new ta(this.gos,this.chartService,this.localeService),i=this.chartService.isEnterprise();let r=s.getMenuItem();if(r&&r.subMenu&&!i){const l=a=>({...a,subMenu:a.subMenu?.filter(d=>!d._enterprise).map(d=>l(d))});r=l(r)}const o=this.gos.get("chartToolPanelsDef")?.settingsPanel?.chartGroupsDef;return o&&(r=As.filterAndOrderChartMenu(r,o,s.getConfigLookup())),this.cleanInternals(r)}cleanInternals(t){if(!t)return t;const s=i=>(delete i?._key,delete i?._enterprise,i?.subMenu?.forEach(r=>s(r)),i);return s(t)}static buildLookup(t){const s={},i=r=>{s[r._key]=r,r.subMenu&&r.subMenu.forEach(o=>i(o))};return i(t),s}static filterAndOrderChartMenu(t,s,i){const r=this.buildLookup(t),o={...t,subMenu:[]};if(Object.entries(s).forEach(([l,a])=>{const d=i[l];if(null===d)return;if(null==d)return void(0,n.JT7)(`invalid chartGroupsDef config '${l}'`);const u=r[d._key];if(u)if(u.subMenu){const h=a.map(c=>{const p=d[c];if(null!=p)return r[p];(0,n.JT7)(`invalid chartGroupsDef config '${l}.${c}'`)}).filter(c=>void 0!==c);h.length>0&&(u.subMenu=h,o.subMenu?.push(u))}else o.subMenu?.push(u)}),0!=o.subMenu?.length)return o}},class extends n.XQb{constructor(){super(...arguments),this.beanName="columnChooserFactory"}wireBeans(e){this.focusService=e.focusService,this.menuUtils=e.menuUtils,this.visibleColsService=e.visibleColsService}createColumnSelectPanel(e,t,s,i){const r=e.createManagedBean(new $t),o=i??t?.getColDef().columnChooserParams??t?.getColDef().columnsMenuParams??{},{contractColumnSelection:l,suppressColumnExpandAll:a,suppressColumnFilter:d,suppressColumnSelectAll:u,suppressSyncLayoutWithGrid:h,columnLayout:c}=o;return r.init(!!s,this.gos.addGridCommonParams({suppressColumnMove:!1,suppressValues:!1,suppressPivots:!1,suppressRowGroups:!1,suppressPivotMode:!1,contractColumnSelection:!!l,suppressColumnExpandAll:!!a,suppressColumnFilter:!!d,suppressColumnSelectAll:!!u,suppressSyncLayoutWithGrid:!!c||!!h,onStateUpdated:()=>{}}),"columnMenu"),c&&r.setColumnLayout(c),r}showColumnChooser({column:e,chooserParams:t,eventSource:s}){this.hideActiveColumnChooser();const i=this.createColumnSelectPanel(this,e,!0,t),r=this.localeService.getLocaleTextFunc(),o=this.visibleColsService.getAllCols().indexOf(e),l=e?this.focusService.getFocusedHeader():null;this.activeColumnChooserDialog=this.createBean(new R.fN({title:r("chooseColumns","Choose Columns"),component:i,width:300,height:300,resizable:!0,movable:!0,centered:!0,closable:!0,afterGuiAttached:()=>{this.focusService.findNextFocusableElement(i.getGui())?.focus({preventScroll:!0}),this.dispatchVisibleChangedEvent(!0,e)},closedCallback:a=>{const d=this.activeColumnChooser.getGui();this.destroyBean(this.activeColumnChooser),this.activeColumnChooser=void 0,this.activeColumnChooserDialog=void 0,this.dispatchVisibleChangedEvent(!1,e),e&&this.menuUtils.restoreFocusOnClose({column:e,headerPosition:l,columnIndex:o,eventSource:s},d,a,!0)},postProcessPopupParams:{type:"columnChooser",column:e,eventSource:s}})),this.activeColumnChooser=i}hideActiveColumnChooser(){this.activeColumnChooserDialog&&this.destroyBean(this.activeColumnChooserDialog)}dispatchVisibleChangedEvent(e,t){this.eventService.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:"columnChooser",column:t??null})}},class extends n.XQb{constructor(){super(...arguments),this.beanName="columnMenuFactory"}wireBeans(e){this.menuItemMapper=e.menuItemMapper,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.menuService=e.menuService}createMenu(e,t,s,i){const r=e.createManagedBean(new R.i9(0,{column:s??null,node:null,value:null})),o=this.menuItemMapper.mapWithStockItems(t,s??null,i,"columnMenu");return r.addMenuItems(o),r}getMenuItems(e,t){const s=this.getDefaultMenuOptions(e);let i;const r=e?.getColDef().mainMenuItems;if(Array.isArray(r))i=r;else if("function"==typeof r)i=r(this.gos.addGridCommonParams({column:e,defaultItems:s}));else{const o=this.gos.getCallback("getMainMenuItems");i=o&&e?o({column:e,defaultItems:s}):s}return(0,n.vKx)(i,re),i}getDefaultMenuOptions(e){const t=[],s=this.menuService.isLegacyMenuEnabled();if(!e)return s||t.push("columnChooser"),t.push("resetColumns"),t;const i=!e.getColDef().lockPinned,r=this.funcColsService.getRowGroupColumns().length,o=r>0,l=e.isAllowValue(),a=e.isAllowRowGroup(),d=e.isPrimary(),u=this.columnModel.isPivotMode(),h=(0,n.dbY)(this.gos),c=this.gos.get("treeData"),p=d&&o&&l||!d;if(!s&&e.isSortable()){const v=e.getSort();"asc"!==v&&t.push("sortAscending"),"desc"!==v&&t.push("sortDescending"),v&&t.push("sortUnSort"),t.push(re)}return this.menuService.isFilterMenuItemEnabled(e)&&(t.push("columnFilter"),t.push(re)),i&&t.push("pinSubMenu"),p&&t.push("valueAggSubMenu"),(i||p)&&t.push(re),t.push("autoSizeThis"),t.push("autoSizeAll"),t.push(re),e.getColDef().showRowGroup?t.push("rowUnGroup"):a&&e.isPrimary()&&(e.isRowGroupActive()?this.columnModel.isColGroupLocked(e)||t.push("rowUnGroup"):t.push("rowGroup")),t.push(re),s||t.push("columnChooser"),t.push("resetColumns"),h&&(c||r>(u?1:0))&&(t.push("expandAll"),t.push("contractAll")),t}},class extends n.XQb{constructor(){super(...arguments),this.beanName="menuUtils"}wireBeans(e){this.focusService=e.focusService,this.headerNavigationService=e.headerNavigationService,this.visibleColsService=e.visibleColsService}restoreFocusOnClose(e,t,s,i){const{eventSource:r}=e,o=s instanceof KeyboardEvent;if(!i&&!o||!r)return;const l=(0,n.UlD)(this.gos);!t.contains(l)&&!(0,n.sNX)(this.gos)||this.focusHeaderCell(e)}closePopupAndRestoreFocusOnSelect(e,t,s){let i;s&&s.keyboardEvent&&(i=s.keyboardEvent),e(i&&{keyboardEvent:i});const r=this.focusService.getFocusedCell();if((0,n.sNX)(this.gos))if(r){const{rowIndex:o,rowPinned:l,column:a}=r;this.focusService.setFocusedCell({rowIndex:o,column:a,rowPinned:l,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}else this.focusHeaderCell(t)}onContextMenu(e,t,s){if(!(!this.gos.get("allowContextMenuWithControlKey")&&e&&(e.ctrlKey||e.metaKey)||(e&&this.blockMiddleClickScrollsIfNeeded(e),this.gos.get("suppressContextMenu")))&&s(e??t.touches[0])){const r=e??t;r&&r.cancelable&&r.preventDefault()}}focusHeaderCell(e){var t=this;return(0,q.A)(function*(){const{column:s,columnIndex:i,headerPosition:r,eventSource:o}=e,l=yield t.visibleColsService.getAllCols().some(a=>a===s);if(!s||s.isAlive())if(l&&o&&(0,n.K05)(o)){const a=t.focusService.findTabbableParent(o);a&&(s&&t.headerNavigationService.scrollToColumn(s),a.focus())}else if(r&&-1!==i){const a=t.visibleColsService.getAllCols(),d=a[i]||(0,n.GXs)(a);d&&t.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:r.headerRowIndex,column:d}})}})()}blockMiddleClickScrollsIfNeeded(e){this.gos.get("suppressMiddleClickScrolls")&&2===e.which&&e.preventDefault()}}],dependantModules:[R.bP],userComponents:[{name:"agMenuItem",classImp:R.Y0}]}),fa=(0,n.n9N)({version:st,moduleName:`${n.zsj.MenuModule}-api`,apiFunctions:{showContextMenu:function ua(e,t){const{rowNode:s,column:i,value:r,x:o,y:l}=t||{};let{x:a,y:d}=e.menuService.getContextMenuPosition(s,i);null!=o&&(a=o),null!=l&&(d=l),e.menuService.showContextMenu({mouseEvent:new MouseEvent("mousedown",{clientX:a,clientY:d}),rowNode:s,column:i,value:r})},showColumnChooser:function ca(e,t){e.menuService.showColumnChooser({chooserParams:t})},hideColumnChooser:function ha(e){e.menuService.hideColumnChooser()}},dependantModules:[us,n.wn1]}),ma=(0,n.n9N)({version:st,moduleName:n.zsj.MenuModule,dependantModules:[us,fa]});function cs(e){e.rangeService?.removeAllCellRanges()}var hs=class extends n.uAl{constructor(){super(...arguments),this.changedCalculatedValues=!1,this.dragging=!1,this.shouldDestroyOnEndDragging=!1}wireBeans(e){this.dragService=e.dragService,this.rangeService=e.rangeService,this.mouseEventService=e.mouseEventService,this.rowPositionUtils=e.rowPositionUtils,this.cellPositionUtils=e.cellPositionUtils,this.ctrlsService=e.ctrlsService}postConstruct(){this.dragService.addDragSource({dragStartPixels:0,eElement:this.getGui(),onDragStart:this.onDragStart.bind(this),onDragging:e=>{this.dragging=!0,this.rangeService.autoScrollService.check(e),this.changedCalculatedValues&&(this.onDrag(e),this.changedCalculatedValues=!1)},onDragStop:e=>{this.dragging=!1,this.onDragEnd(e),this.clearDragProperties(),this.shouldDestroyOnEndDragging&&this.destroy()},onDragCancel:()=>{this.dragging=!1,this.onDragCancel(),this.clearDragProperties()}}),this.addManagedElementListeners(this.getGui(),{mousedown:this.preventRangeExtension.bind(this)})}isDragging(){return this.dragging}getCellCtrl(){return this.cellCtrl}setCellCtrl(e){this.cellCtrl=e}getCellRange(){return this.cellRange}setCellRange(e){this.cellRange=e}getRangeStartRow(){return this.rangeStartRow}setRangeStartRow(e){this.rangeStartRow=e}getRangeEndRow(){return this.rangeEndRow}setRangeEndRow(e){this.rangeEndRow=e}getLastCellHovered(){return this.lastCellHovered}preventRangeExtension(e){e.stopPropagation()}onDragStart(e){[this.cellHoverListener]=this.addManagedElementListeners(this.ctrlsService.get("gridCtrl").getGui(),{mousemove:this.updateValuesOnMove.bind(this)}),document.body.classList.add(this.getDraggingCssClass())}getDraggingCssClass(){return`ag-dragging-${this.type===n.LIk.FILL?"fill":"range"}-handle`}updateValuesOnMove(e){const t=this.mouseEventService.getCellPositionForEvent(e);!t||this.lastCellHovered&&this.cellPositionUtils.equals(t,this.lastCellHovered)||(this.lastCellHovered=t,this.changedCalculatedValues=!0)}clearDragProperties(){this.clearValues(),this.rangeService.autoScrollService.ensureCleared(),document.body.classList.remove(this.getDraggingCssClass())}getType(){return this.type}refresh(e){const t=this.getCellCtrl(),s=this.getGui(),i=(0,n.GXs)(this.rangeService.getCellRanges()),r=i.startRow,o=i.endRow;if(r&&o&&(this.rowPositionUtils.before(o,r)?(this.setRangeStartRow(o),this.setRangeEndRow(r)):(this.setRangeStartRow(r),this.setRangeEndRow(o))),t!==e||!(0,n.K05)(s)){this.setCellCtrl(e);const l=e.getComp().getParentOfValue();l&&l.appendChild(s)}this.setCellRange(i)}clearValues(){this.lastCellHovered=void 0,this.removeListeners()}removeListeners(){this.cellHoverListener&&(this.cellHoverListener(),this.cellHoverListener=void 0)}destroy(){if(!this.shouldDestroyOnEndDragging&&this.isDragging())return(0,n.nl0)(this.getGui(),!1),void(this.shouldDestroyOnEndDragging=!0);this.shouldDestroyOnEndDragging=!1,super.destroy(),this.removeListeners();const e=this.getGui();e.parentElement&&e.parentElement.removeChild(e)}};function wa(e){const t=e.length;let s=0;if(t<=1)return e;for(let c=0;c<e.length;c++){const p=e[c],g=p.toString().split("e-");g.length>1?s=Math.max(s,parseInt(g[1],10)):Math.floor(p)!==p&&(s=Math.max(s,p.toString().split(".")[1].length))}let i=0,r=0,o=0,l=0,a=0;for(let c=0;c<t;c++)a=e[c],i+=c,r+=a,l+=c*c,o+=c*a;const d=(t*o-i*r)/(t*l-i*i),u=r/t-d*i/t,h=[];for(let c=0;c<=t;c++)h.push(parseFloat((c*d+u).toFixed(s)));return h}var ya=class extends hs{constructor(){super('<div class="ag-fill-handle"></div>'),this.markedCells=[],this.cellValues=[],this.isUp=!1,this.isLeft=!1,this.isReduce=!1,this.type=n.LIk.FILL}wireBeans(e){super.wireBeans(e),this.valueService=e.valueService,this.navigationService=e.navigationService,this.cellNavigationService=e.cellNavigationService,this.visibleColsService=e.visibleColsService}updateValuesOnMove(e){super.updateValuesOnMove(e),this.initialXY||(this.initialXY=this.mouseEventService.getNormalisedPosition(e));const{x:t,y:s}=this.initialXY,{x:i,y:r}=this.mouseEventService.getNormalisedPosition(e),o=Math.abs(t-i),l=Math.abs(s-r),a=this.getFillHandleDirection();let d;d="xy"===a?o>l?"x":"y":a,d!==this.dragAxis&&(this.dragAxis=d,this.changedCalculatedValues=!0)}onDrag(e){if(!this.initialPosition){const s=this.getCellCtrl();if(!s)return;this.initialPosition=s.getCellPosition()}const t=this.getLastCellHovered();t&&this.markPathFrom(this.initialPosition,t)}onDragEnd(e){if(this.initialXY=null,!this.markedCells.length)return;const t="x"===this.dragAxis,s=this.getCellRange(),i=s.columns.length,r=this.getRangeStartRow(),o=this.getRangeEndRow();let l;if(this.isUp||this.isLeft){const a=t?r:this.lastCellMarked;l=this.rangeService.createCellRangeFromCellRangeParams({rowStartIndex:a.rowIndex,rowStartPinned:a.rowPinned,columnStart:t?this.lastCellMarked.column:s.columns[0],rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnEnd:s.columns[i-1]})}else l=this.rangeService.createCellRangeFromCellRangeParams({rowStartIndex:r.rowIndex,rowStartPinned:r.rowPinned,columnStart:s.columns[0],rowEndIndex:t?o.rowIndex:this.lastCellMarked.rowIndex,rowEndPinned:t?o.rowPinned:this.lastCellMarked.rowPinned,columnEnd:t?this.lastCellMarked.column:s.columns[i-1]});l&&(this.eventService.dispatchEvent({type:"fillStart"}),this.handleValueChanged(s,l,e),this.rangeService.setCellRanges([l]),this.eventService.dispatchEvent({type:"fillEnd",initialRange:s,finalRange:l}))}onDragCancel(){this.initialXY=null,this.markedCells.length&&this.clearMarkedPath()}getFillHandleDirection(){const e=(0,n.dK4)(this.gos)?.direction;return e?"x"!==e&&"y"!==e&&"xy"!==e?((0,n.JT7)("valid values for fillHandleDirection are 'x', 'y' and 'xy'. Default to 'xy'."),"xy"):e:"xy"}handleValueChanged(e,t,s){const i=this.rangeService.getRangeEndRow(e),r=this.rangeService.getRangeStartRow(e),o=this.rangeService.getRangeEndRow(t),l=this.rangeService.getRangeStartRow(t),a="y"===this.dragAxis;if(this.isReduce&&!(0,n.dK4)(this.gos)?.suppressClearOnFillReduction){const C=a?e.columns:e.columns.filter(w=>t.columns.indexOf(w)<0),S=a?this.cellNavigationService.getRowBelow(o):l;return void(S&&this.clearCellsInRange(S,i,C))}const d=[],u=[],h=[],c=[];let p=!0,g=0;const f=()=>{d.length=0,u.length=0,h.length=0,c.length=0,g=0},v=(C,S)=>{let w=this.isUp?i:r,x=!1;for(a&&(p=!0,f());!x&&w;){const M=this.rowPositionUtils.getRowNode(w);if(!M)break;a&&C?y(d,C,M,()=>!this.rowPositionUtils.sameRow(w,this.isUp?r:i)):S&&(p=!0,f(),S.forEach(T=>y(d,T,M,()=>T!==(this.isLeft?e.columns[0]:(0,n.GXs)(e.columns))))),x=this.rowPositionUtils.sameRow(w,this.isUp?l:o),w=this.isUp?this.cellNavigationService.getRowAbove(w):this.cellNavigationService.getRowBelow(w)}},y=(C,S,w,x)=>{let M,T=!1;if(p)M=this.valueService.getValue(S,w),u.push(M),h.push(this.valueService.getValue(S,w,void 0,!0)),c.push(this.valueService.formatValue(S,w,M)),p=x();else{const{value:J,fromUserFunction:oe,sourceCol:Y,sourceRowNode:U}=this.processValues({event:s,values:C,initialValues:u,initialNonAggregatedValues:h,initialFormattedValues:c,col:S,rowNode:w,idx:g++});if(M=J,S.isCellEditable(w)){const ne=this.valueService.getValue(S,w);oe||(Y&&!1!==Y.getColDef()?.useValueFormatterForExport&&(M=this.valueService.formatValue(Y,U,M)??M),!1!==S.getColDef().useValueParserForImport&&(M=this.valueService.parseValue(S,w,Y?M:(0,n.qph)(M),ne))),oe&&ne===M?T=!0:w.setDataValue(S,M,"rangeService")}}T||C.push({value:M,column:S,rowNode:w})};if(a)e.columns.forEach(C=>{v(C)});else{const C=this.isLeft?[...t.columns].reverse():t.columns;v(void 0,C)}}clearCellsInRange(e,t,s){this.rangeService.clearCellRangeCellValues({cellRanges:[{startRow:e,endRow:t,columns:s,startColumn:s[0]}]})}processValues(e){const{event:t,values:s,initialValues:i,initialNonAggregatedValues:r,initialFormattedValues:o,col:l,rowNode:a,idx:d}=e,u=(0,n.dK4)(this.gos)?.setFillValue;let c;if(c="y"===this.dragAxis?this.isUp?"up":"down":this.isLeft?"left":"right",u){const f=u(this.gos.addGridCommonParams({event:t,values:s.map(({value:v})=>v),initialValues:i,initialNonAggregatedValues:r,initialFormattedValues:o,currentIndex:d,currentCellValue:this.valueService.getValue(l,a),direction:c,column:l,rowNode:a}));if(!1!==f)return{value:f,fromUserFunction:!0}}const p=!s.some(({value:g})=>{const f=parseFloat(g);return isNaN(f)||f.toString()!==g.toString()});if(t.altKey||!p){if(p&&1===i.length){const y=this.isUp||this.isLeft?-1:1;return{value:parseFloat((0,n.GXs)(s).value)+1*y,fromUserFunction:!1}}const{value:g,column:f,rowNode:v}=s[d%s.length];return{value:g,fromUserFunction:!1,sourceCol:f,sourceRowNode:v}}return{value:(0,n.GXs)(wa(s.map(({value:g})=>Number(g)))),fromUserFunction:!1}}clearValues(){this.clearMarkedPath(),this.clearCellValues(),this.lastCellMarked=void 0,super.clearValues()}clearMarkedPath(){this.markedCells.forEach(e=>{if(!e.isAlive())return;const t=e.getComp();t.addOrRemoveCssClass("ag-selection-fill-top",!1),t.addOrRemoveCssClass("ag-selection-fill-right",!1),t.addOrRemoveCssClass("ag-selection-fill-bottom",!1),t.addOrRemoveCssClass("ag-selection-fill-left",!1)}),this.markedCells.length=0,this.isUp=!1,this.isLeft=!1,this.isReduce=!1}clearCellValues(){this.cellValues.length=0}markPathFrom(e,t){if(this.clearMarkedPath(),this.clearCellValues(),"y"===this.dragAxis){if(this.rowPositionUtils.sameRow(t,e))return;const s=this.rowPositionUtils.before(t,e),i=this.getRangeStartRow(),r=this.getRangeEndRow();s&&(t.rowPinned==i.rowPinned&&t.rowIndex>=i.rowIndex||i.rowPinned!=r.rowPinned&&t.rowPinned==r.rowPinned&&t.rowIndex<=r.rowIndex)?(this.reduceVertical(e,t),this.isReduce=!0):(this.extendVertical(e,t,s),this.isReduce=!1)}else{const s=e.column,i=t.column;if(s===i)return;const r=this.visibleColsService.getAllCols(),o=r.indexOf(s),l=r.indexOf(i);l<=o&&l>=r.indexOf(this.getCellRange().columns[0])?(this.reduceHorizontal(e,t),this.isReduce=!0):(this.extendHorizontal(e,t,l<o),this.isReduce=!1)}this.lastCellMarked=t}extendVertical(e,t,s){const{navigationService:i,rangeService:r}=this;let o=e;do{const l=this.getCellRange(),a=l.columns.length;for(let d=0;d<a;d++){const c={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:l.columns[d]},p=r.isCellInSpecificRange(c,l),g=this.rowPositionUtils.sameRow(o,e);if(s&&(this.isUp=!0),!g){const f=i.getCellByPosition(c);if(f){this.markedCells.push(f);const v=f.getComp();p||(v.addOrRemoveCssClass("ag-selection-fill-left",0===d),v.addOrRemoveCssClass("ag-selection-fill-right",d===a-1)),v.addOrRemoveCssClass(s?"ag-selection-fill-top":"ag-selection-fill-bottom",this.rowPositionUtils.sameRow(o,t))}}}if(this.rowPositionUtils.sameRow(o,t))break}while(o=s?this.cellNavigationService.getRowAbove(o):this.cellNavigationService.getRowBelow(o))}reduceVertical(e,t){let s=e;do{const i=this.getCellRange(),r=i.columns.length,o=this.rowPositionUtils.sameRow(s,t);for(let l=0;l<r;l++){const u=this.navigationService.getCellByPosition({rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:i.columns[l]});u&&(this.markedCells.push(u),u.getComp().addOrRemoveCssClass("ag-selection-fill-bottom",this.rowPositionUtils.sameRow(s,t)))}if(o)break}while(s=this.cellNavigationService.getRowAbove(s))}extendHorizontal(e,t,s){const i=this.visibleColsService.getAllCols(),r=i.indexOf(s?t.column:e.column),o=i.indexOf(s?this.getCellRange().columns[0]:t.column),l=s?0:1,a=i.slice(r+l,o+l),d=this.getRangeStartRow(),u=this.getRangeEndRow();a.forEach(h=>{let c=d,p=!1;do{p=this.rowPositionUtils.sameRow(c,u);const g=this.navigationService.getCellByPosition({rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:h});if(g){this.markedCells.push(g);const f=g.getComp();f.addOrRemoveCssClass("ag-selection-fill-top",this.rowPositionUtils.sameRow(c,d)),f.addOrRemoveCssClass("ag-selection-fill-bottom",this.rowPositionUtils.sameRow(c,u)),s?(this.isLeft=!0,f.addOrRemoveCssClass("ag-selection-fill-left",h===a[0])):f.addOrRemoveCssClass("ag-selection-fill-right",h===(0,n.GXs)(a))}c=this.cellNavigationService.getRowBelow(c)}while(!p)})}reduceHorizontal(e,t){const s=this.visibleColsService.getAllCols(),i=s.indexOf(t.column),r=s.indexOf(e.column),o=s.slice(i,r),l=this.getRangeStartRow(),a=this.getRangeEndRow();o.forEach(d=>{let u=l,h=!1;do{h=this.rowPositionUtils.sameRow(u,a);const c=this.navigationService.getCellByPosition({rowIndex:u.rowIndex,rowPinned:u.rowPinned,column:d});c&&(this.markedCells.push(c),c.getComp().addOrRemoveCssClass("ag-selection-fill-right",d===o[0])),u=this.cellNavigationService.getRowBelow(u)}while(!h)})}refresh(e){const t=this.rangeService.getCellRanges()[0];t.startRow&&t.endRow?super.refresh(e):this.destroy()}},Fa=class extends hs{constructor(){super('<div class="ag-range-handle"></div>'),this.type=n.LIk.RANGE,this.rangeFixed=!1}onDrag(e){const t=this.getLastCellHovered();if(!t)return;const s=this.rangeService.getCellRanges(),i=(0,n.GXs)(s);this.rangeFixed||(this.fixRangeStartEnd(i),this.rangeFixed=!0),this.endPosition={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column},2===s.length&&s[0].type===n.OnL.DIMENSION&&i.type===n.OnL.VALUE&&!this.rowPositionUtils.sameRow(this.endPosition,this.rangeService.getRangeEndRow(i))&&this.rangeService.updateRangeEnd(s[0],{...this.endPosition,column:s[0].columns[0]},!0),this.rangeService.extendLatestRangeToCell(this.endPosition)}onDragEnd(e){const t=(0,n.GXs)(this.rangeService.getCellRanges());this.fixRangeStartEnd(t),this.rangeFixed=!1}onDragCancel(){this.rangeFixed=!1}fixRangeStartEnd(e){const t=this.rangeService.getRangeStartRow(e),s=this.rangeService.getRangeEndRow(e),i=e.columns[0];e.startRow=t,e.endRow=s,e.startColumn=i}},it="32.3.3",ps=(0,n.n9N)({version:it,moduleName:`${n.zsj.RangeSelectionModule}-core`,beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="rangeService",this.cellRanges=[],this.bodyScrollListener=this.onBodyScroll.bind(this),this.dragging=!1,this.intersectionRange=!1}wireBeans(e){this.rowModel=e.rowModel,this.dragService=e.dragService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.cellNavigationService=e.cellNavigationService,this.pinnedRowModel=e.pinnedRowModel,this.rowPositionUtils=e.rowPositionUtils,this.cellPositionUtils=e.cellPositionUtils,this.ctrlsService=e.ctrlsService,this.valueService=e.valueService}postConstruct(){const e=this.onColumnsChanged.bind(this),t=()=>this.removeAllCellRanges(),s=this.refreshLastRangeStart.bind(this);this.addManagedEventListeners({newColumnsLoaded:e,columnVisible:e,columnValueChanged:e,columnPivotModeChanged:t,columnRowGroupChanged:t,columnPivotChanged:t,columnGroupOpened:s,columnMoved:s,columnPinned:s}),this.ctrlsService.whenReady(this,i=>{const r=i.gridBodyCtrl;this.autoScrollService=new n.MSA({scrollContainer:r.getBodyViewportElement(),scrollAxis:"xy",getVerticalPosition:()=>r.getScrollFeature().getVScrollPosition().top,setVerticalPosition:o=>r.getScrollFeature().setVerticalScrollPosition(o),getHorizontalPosition:()=>r.getScrollFeature().getHScrollPosition().left,setHorizontalPosition:o=>r.getScrollFeature().setHorizontalScrollPosition(o),shouldSkipVerticalScroll:()=>!(0,n.yy7)(this.gos,"normal"),shouldSkipHorizontalScroll:()=>!r.getScrollFeature().isHorizontalScrollShowing()})})}onColumnsChanged(){this.refreshLastRangeStart();const e=this.visibleColsService.getAllCols();this.cellRanges.forEach(s=>{const i=s.columns;s.columns=s.columns.filter(o=>o.isVisible()&&-1!==e.indexOf(o)),!(0,n.MpY)(i,s.columns)&&this.dispatchChangedEvent(!1,!0,s.id)});const t=this.cellRanges.length;this.cellRanges=this.cellRanges.filter(s=>s.columns.length>0),t>this.cellRanges.length&&this.dispatchChangedEvent(!1,!0)}refreshLastRangeStart(){const e=(0,n.GXs)(this.cellRanges);e&&this.refreshRangeStart(e)}isContiguousRange(e){const t=e.columns;if(!t.length)return!1;const s=this.visibleColsService.getAllCols(),i=t.map(r=>s.indexOf(r)).sort((r,o)=>r-o);return(0,n.GXs)(i)-i[0]+1===t.length}getRangeStartRow(e){return e.startRow&&e.endRow?this.rowPositionUtils.before(e.startRow,e.endRow)?e.startRow:e.endRow:{rowIndex:0,rowPinned:this.pinnedRowModel.getPinnedTopRowCount()>0?"top":null}}getRangeEndRow(e){if(e.startRow&&e.endRow)return this.rowPositionUtils.before(e.startRow,e.endRow)?e.endRow:e.startRow;const t=this.pinnedRowModel.getPinnedBottomRowCount();return t>0?{rowIndex:t-1,rowPinned:"bottom"}:{rowIndex:this.rowModel.getRowCount()-1,rowPinned:null}}setRangeToCell(e,t=!1){if(!(0,n.Jch)(this.gos))return;const s=this.calculateColumnsBetween(e.column,e.column);if(!s)return;((0,n.q_H)(this.gos)||!t||(0,n.MWY)(this.cellRanges))&&this.removeAllCellRanges(!0);const r={rowIndex:e.rowIndex,rowPinned:e.rowPinned};this.cellRanges.push({startRow:r,endRow:r,columns:s,startColumn:e.column}),this.setNewestRangeStartCell(e),this.onDragStop(),this.dispatchChangedEvent(!0,!0)}extendLatestRangeToCell(e){if(this.isEmpty()||!this.newestRangeStartCell)return;const t=(0,n.GXs)(this.cellRanges);this.updateRangeEnd(t,e)}updateRangeEnd(e,t,s=!1){const r=this.calculateColumnsBetween(e.startColumn,t.column);!r||this.isLastCellOfRange(e,t)||(e.columns=r,e.endRow={rowIndex:t.rowIndex,rowPinned:t.rowPinned},s||this.dispatchChangedEvent(!0,!0,e.id))}refreshRangeStart(e){const{startColumn:t,columns:s}=e,i=(d,u)=>{const h=e.columns.filter(c=>c!==d);d?(e.startColumn=d,e.columns=u?[d,...h]:[...h,d]):e.columns=h},{left:r,right:o}=this.getRangeEdgeColumns(e);t!==s[0]||t===r?t!==(0,n.GXs)(s)||t!==o||i(o,!1):i(r,!0)}getRangeEdgeColumns(e){const t=this.visibleColsService.getAllCols(),s=e.columns.map(i=>t.indexOf(i)).filter(i=>i>-1).sort((i,r)=>i-r);return{left:t[s[0]],right:t[(0,n.GXs)(s)]}}extendLatestRangeInDirection(e){if(this.isEmpty()||!this.newestRangeStartCell)return;const t=e.key,s=e.ctrlKey||e.metaKey,i=(0,n.GXs)(this.cellRanges),r=this.newestRangeStartCell,o=i.columns[0],l=(0,n.GXs)(i.columns),c=this.cellNavigationService.getNextCellToFocus(t,{column:r.column===o?l:o,rowIndex:i.endRow.rowIndex,rowPinned:i.endRow.rowPinned},s);return c?(this.setCellRange({rowStartIndex:r.rowIndex,rowStartPinned:r.rowPinned,rowEndIndex:c.rowIndex,rowEndPinned:c.rowPinned,columnStart:r.column,columnEnd:c.column}),c):void 0}setCellRange(e){(0,n.Jch)(this.gos)&&(this.removeAllCellRanges(!0),this.addCellRange(e))}setCellRanges(e){(0,n.Xdm)(this.cellRanges,e)||(this.removeAllCellRanges(!0),e.forEach(t=>{t.columns&&t.startRow&&this.setNewestRangeStartCell({rowIndex:t.startRow.rowIndex,rowPinned:t.startRow.rowPinned,column:t.columns[0]}),this.cellRanges.push(t)}),this.dispatchChangedEvent(!1,!0))}setNewestRangeStartCell(e){this.newestRangeStartCell=e}clearCellRangeCellValues(e){let{cellRanges:t}=e;const{cellEventSource:s="rangeService",dispatchWrapperEvents:i,wrapperEventSource:r="deleteKey"}=e;i&&(this.eventService.dispatchEvent({type:"cellSelectionDeleteStart",source:r}),this.eventService.dispatchEvent({type:"rangeDeleteStart",source:r})),t||(t=this.cellRanges),t.forEach(o=>{this.forEachRowInRange(o,l=>{const a=this.rowPositionUtils.getRowNode(l);if(a)for(let d=0;d<o.columns.length;d++){const u=this.columnModel.getCol(o.columns[d]);if(!u||!u.isCellEditable(a))continue;const h=this.valueService.getDeleteValue(u,a);a.setDataValue(u,h,s)}})}),i&&(this.eventService.dispatchEvent({type:"cellSelectionDeleteEnd",source:r}),this.eventService.dispatchEvent({type:"rangeDeleteEnd",source:r}))}createCellRangeFromCellRangeParams(e){return this.createPartialCellRangeFromRangeParams(e,!1)}createPartialCellRangeFromRangeParams(e,t){let s,i=!1;if(e.columns)s=e.columns.map(l=>this.columnModel.getCol(l)).filter(l=>l);else{const l=this.columnModel.getCol(e.columnStart),a=this.columnModel.getCol(e.columnEnd);if(!l||!a)return;s=this.calculateColumnsBetween(l,a),s&&s.length&&(i=s[0]!==l)}if(s&&(t||0!==s.length))return{startRow:null!=e.rowStartIndex?{rowIndex:e.rowStartIndex,rowPinned:e.rowStartPinned||null}:void 0,endRow:null!=e.rowEndIndex?{rowIndex:e.rowEndIndex,rowPinned:e.rowEndPinned||null}:void 0,columns:s,startColumn:i?(0,n.GXs)(s):s[0]}}addCellRange(e){const t=this.gos;if(!(0,n.Jch)(t))return;if((0,n.s8J)(t)&&(0,n.q_H)(t)&&this.cellRanges.length>0)return(0,n.JT7)("cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`");const s=this.createCellRangeFromCellRangeParams(e);s&&(s.startRow&&this.setNewestRangeStartCell({rowIndex:s.startRow.rowIndex,rowPinned:s.startRow.rowPinned,column:s.startColumn}),this.cellRanges.push(s),this.dispatchChangedEvent(!1,!0,s.id))}getCellRanges(){return this.cellRanges}isEmpty(){return 0===this.cellRanges.length}isMoreThanOneCell(){const e=this.cellRanges.length;if(0===e)return!1;if(e>1)return!0;const t=this.cellRanges[0],s=this.getRangeStartRow(t),i=this.getRangeEndRow(t);return s.rowPinned!==i.rowPinned||s.rowIndex!==i.rowIndex||1!==t.columns.length}areAllRangesAbleToMerge(){const e=new Map;if(this.cellRanges.length<=1)return!0;let s;this.cellRanges.forEach(i=>{this.forEachRowInRange(i,r=>{const o=`${r.rowPinned||"normal"}_${r.rowIndex}`,l=e.get(o),a=i.columns.map(d=>d.getId());if(l){const d=a.filter(u=>-1===l.indexOf(u));l.push(...d)}else e.set(o,a)})});for(const i of e.values()){const r=i.sort().join();if(void 0!==s){if(s!==r)return!1}else s=r}return!0}forEachRowInRange(e,t){const s=this.getRangeStartRow(e),i=this.getRangeEndRow(e);let r=s;for(;r&&(t(r),!this.rowPositionUtils.sameRow(r,i));)r=this.cellNavigationService.getRowBelow(r)}removeAllCellRanges(e){this.isEmpty()||(this.onDragStop(),this.cellRanges.length=0,e||this.dispatchChangedEvent(!1,!0))}onBodyScroll(){this.dragging&&this.lastMouseEvent&&this.onDragging(this.lastMouseEvent)}isCellInAnyRange(e){return this.getCellRangeCount(e)>0}isCellInSpecificRange(e,t){const s=null!==t.columns&&(0,n.dRF)(t.columns,e.column),i=this.isRowInRange(e.rowIndex,e.rowPinned,t);return s&&i}isLastCellOfRange(e,t){const{startRow:s,endRow:i}=e,r=this.rowPositionUtils.before(s,i)?i:s,o=t.rowIndex===r.rowIndex&&t.rowPinned===r.rowPinned,l=e.columns[0],a=(0,n.GXs)(e.columns);return t.column===(e.startColumn===l?a:l)&&o}isBottomRightCell(e,t){const s=this.visibleColsService.getAllCols(),i=e.columns.map(u=>s.indexOf(u)).sort((u,h)=>u-h),{startRow:r,endRow:o}=e,l=this.rowPositionUtils.before(r,o)?o:r,a=s.indexOf(t.column)===(0,n.GXs)(i),d=t.rowIndex===l.rowIndex&&(0,n.X7E)(t.rowPinned)===(0,n.X7E)(l.rowPinned);return a&&d}getCellRangeCount(e){return this.isEmpty()?0:this.cellRanges.filter(t=>this.isCellInSpecificRange(e,t)).length}isRowInRange(e,t,s){const i=this.getRangeStartRow(s),r=this.getRangeEndRow(s),o={rowIndex:e,rowPinned:t||null};if(o.rowIndex===i.rowIndex&&o.rowPinned==i.rowPinned||o.rowIndex===r.rowIndex&&o.rowPinned==r.rowPinned)return!0;const d=!this.rowPositionUtils.before(o,i),u=this.rowPositionUtils.before(o,r);return d&&u}getDraggingRange(){return this.draggingRange}onDragStart(e){if(!(0,n.Jch)(this.gos))return;const{ctrlKey:t,metaKey:s,shiftKey:i}=e,r=t||s,l=!(0,n.q_H)(this.gos)&&r,a=i&&(0,n.Rer)(this.cellRanges);!l&&(!a||(0,n.Qmv)((0,n.GXs)(this.cellRanges).type))&&this.removeAllCellRanges(!0);const d=this.dragService.getStartTarget();if(d&&this.updateValuesOnMove(d),this.lastCellHovered){if(this.dragging=!0,this.lastMouseEvent=e,this.intersectionRange=l&&this.getCellRangeCount(this.lastCellHovered)>1,a||this.setNewestRangeStartCell(this.lastCellHovered),this.cellRanges.length>0)this.draggingRange=(0,n.GXs)(this.cellRanges);else{const u={rowIndex:this.lastCellHovered.rowIndex,rowPinned:this.lastCellHovered.rowPinned};this.draggingRange={startRow:u,endRow:u,columns:[this.lastCellHovered.column],startColumn:this.newestRangeStartCell.column},this.cellRanges.push(this.draggingRange)}this.ctrlsService.getGridBodyCtrl().addScrollEventListener(this.bodyScrollListener),this.dispatchChangedEvent(!0,!1,this.draggingRange.id)}}intersectLastRange(e){if(e&&this.dragging||(0,n.q_H)(this.gos)||this.isEmpty())return;const t=this.rowPositionUtils,s=(0,n.GXs)(this.cellRanges),i=this.getRangeStartRow(s),r=this.getRangeEndRow(s),o=[];this.cellRanges.slice(0,-1).forEach(l=>{const a=this.getRangeStartRow(l),d=this.getRangeEndRow(l),u=l.columns,h=u.filter(p=>-1===s.columns.indexOf(p));if(h.length===u.length)return void o.push(l);if(t.before(r,a)||t.before(d,i))return void o.push(l);const c=o.length;if(t.before(a,i)){const p={columns:[...u],startColumn:s.startColumn,startRow:{...a},endRow:this.cellNavigationService.getRowAbove(i)};o.push(p)}if(h.length>0){const p={columns:h,startColumn:(0,n.dRF)(h,s.startColumn)?s.startColumn:h[0],startRow:this.rowMax([{...i},{...a}]),endRow:this.rowMin([{...r},{...d}])};o.push(p)}t.before(r,d)&&o.push({columns:[...u],startColumn:s.startColumn,startRow:this.cellNavigationService.getRowBelow(r),endRow:{...d}}),o.length-c==1&&(o[o.length-1].id=l.id)}),this.cellRanges=o,e&&this.dispatchChangedEvent(!1,!0)}rowMax(e){let t;return e.forEach(s=>{(void 0===t||this.rowPositionUtils.before(t,s))&&(t=s)}),t}rowMin(e){let t;return e.forEach(s=>{(void 0===t||this.rowPositionUtils.before(s,t))&&(t=s)}),t}updateValuesOnMove(e){const t=(0,n.Z5C)(this.gos,e,n.wX9.DOM_DATA_KEY_CELL_CTRL),s=t?.getCellPosition();if(this.cellHasChanged=!1,!(!s||this.lastCellHovered&&this.cellPositionUtils.equals(s,this.lastCellHovered))){if(t?.isEditing())return void this.dragService.cancelDrag(e);this.lastCellHovered&&(this.cellHasChanged=!0),this.lastCellHovered=s}}onDragging(e){if(!this.dragging||!e)return;this.updateValuesOnMove(e.target),this.lastMouseEvent=e;const t=this.lastCellHovered,s=o=>t&&t.rowPinned===o&&this.newestRangeStartCell.rowPinned===o,i=s("top")||s("bottom");if(this.autoScrollService.check(e,i),!this.cellHasChanged)return;const r=this.calculateColumnsBetween(this.newestRangeStartCell.column,t.column);r&&(this.draggingRange.endRow={rowIndex:t.rowIndex,rowPinned:t.rowPinned},this.draggingRange.columns=r,this.dispatchChangedEvent(!1,!1,this.draggingRange.id))}onDragStop(){if(!this.dragging)return;const{id:e}=this.draggingRange;this.autoScrollService.ensureCleared(),this.ctrlsService.getGridBodyCtrl().removeScrollEventListener(this.bodyScrollListener),this.lastMouseEvent=null,this.dragging=!1,this.draggingRange=void 0,this.lastCellHovered=void 0,this.intersectionRange&&(this.intersectionRange=!1,this.intersectLastRange()),this.dispatchChangedEvent(!1,!0,e)}dispatchChangedEvent(e,t,s){this.eventService.dispatchEvent({type:"cellSelectionChanged",started:e,finished:t,id:s}),this.eventService.dispatchEvent({type:"rangeSelectionChanged",started:e,finished:t,id:s})}calculateColumnsBetween(e,t){const s=this.visibleColsService.getAllCols(),i=e===t,r=s.indexOf(e),o=h=>(0,n.JT7)(`column ${h.getId()} is not visible`);if(r<0)return void o(e);const l=i?r:s.indexOf(t);if(l<0)return void o(t);if(i)return[e];const a=Math.min(r,l),d=a===r?l:r,u=[];for(let h=a;h<=d;h++)u.push(s[h]);return u}},class extends n.XQb{constructor(){super(...arguments),this.beanName="selectionHandleFactory"}createSelectionHandle(e){return this.createBean(e===n.LIk.RANGE?new Fa:new ya)}}],dependantModules:[R.bP]}),xa=(0,n.n9N)({version:it,moduleName:`${n.zsj.RangeSelectionModule}-api`,apiFunctions:{getCellRanges:function Ca(e){return e.rangeService?.getCellRanges()??null},addCellRange:function va(e,t){e.rangeService?.addCellRange(t)},clearRangeSelection:cs,clearCellSelection:cs},dependantModules:[ps]}),Ma=(0,n.n9N)({version:it,moduleName:n.zsj.RangeSelectionModule,dependantModules:[ps,xa]}),k=(()=>{let e=class{};return e.SELECT_ALL="__AG_SELECT_ALL__",e.ADD_SELECTION_TO_FILTER="__AG_ADD_SELECTION_TO_FILTER__",e})(),Aa={loadingOoo:"Loading...",blanks:"(Blanks)",searchOoo:"Search...",selectAll:"(Select All)",selectAllSearchResults:"(Select All Search Results)",addCurrentSelectionToFilter:"Add current selection to filter",noMatches:"No matches."},ba=class extends n.uAl{constructor(e){super(e.isGroup?'\n            <div class="ag-set-filter-item" aria-hidden="true">\n                <span class="ag-set-filter-group-icons">\n                    <span class="ag-set-filter-group-closed-icon" data-ref="eGroupClosedIcon"></span>\n                    <span class="ag-set-filter-group-opened-icon" data-ref="eGroupOpenedIcon"></span>\n                    <span class="ag-set-filter-group-indeterminate-icon" data-ref="eGroupIndeterminateIcon"></span>\n                </span>\n                <ag-checkbox data-ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n            </div>':'\n            <div class="ag-set-filter-item">\n                <ag-checkbox data-ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n            </div>',[n.DXf]),this.eCheckbox=n.dRA,this.eGroupOpenedIcon=n.dRA,this.eGroupClosedIcon=n.dRA,this.eGroupIndeterminateIcon=n.dRA,this.focusWrapper=e.focusWrapper,this.value=e.value,this.params=e.params,this.translate=e.translate,this.valueFormatter=e.valueFormatter,this.item=e.item,this.isSelected=e.isSelected,this.isTree=e.isTree,this.depth=e.depth??0,this.isGroup=e.isGroup,this.groupsExist=e.groupsExist,this.isExpanded=e.isExpanded,this.hasIndeterminateExpandState=e.hasIndeterminateExpandState}wireBeans(e){this.valueService=e.valueService,this.userComponentFactory=e.userComponentFactory}postConstruct(){this.addDestroyFunc(()=>this.destroyCellRendererComponent?.()),this.render(),this.eCheckbox.setLabelEllipsis(!0).setValue(this.isSelected,!0).setDisabled(!!this.params.readOnly).getInputElement().setAttribute("tabindex","-1"),this.refreshVariableAriaLabels(),this.isTree&&(this.depth>0&&(this.addCssClass("ag-set-filter-indent-"+this.depth),this.getGui().style.setProperty("--ag-indentation-level",String(this.depth))),this.isGroup?this.setupExpansion():this.groupsExist&&this.addCssClass("ag-set-filter-add-group-indent"),(0,n.v8T)(this.getAriaElement(),this.depth+1)),this.refreshAriaChecked(),!this.params.readOnly&&this.eCheckbox.onValueChange(e=>this.onCheckboxChanged(!!e))}getFocusableElement(){return this.focusWrapper}setupExpansion(){this.eGroupClosedIcon.appendChild((0,n.fyk)("setFilterGroupClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild((0,n.fyk)("setFilterGroupOpen",this.gos,null));const e=this.onExpandOrContractClicked.bind(this);this.addManagedElementListeners(this.eGroupClosedIcon,{click:e}),this.addManagedElementListeners(this.eGroupOpenedIcon,{click:e}),this.hasIndeterminateExpandState&&(this.eGroupIndeterminateIcon.appendChild((0,n.fyk)("setFilterGroupIndeterminate",this.gos,null)),this.addManagedElementListeners(this.eGroupIndeterminateIcon,{click:e})),this.setExpandedIcons(),this.refreshAriaExpanded()}onExpandOrContractClicked(){this.setExpanded(!this.isExpanded)}setExpanded(e,t){this.isGroup&&e!==this.isExpanded&&(this.isExpanded=e,t||this.dispatchLocalEvent({type:"expandedChanged",isExpanded:!!e,item:this.item}),this.setExpandedIcons(),this.refreshAriaExpanded())}setExpandedIcons(){(0,n.nl0)(this.eGroupClosedIcon,this.hasIndeterminateExpandState?!1===this.isExpanded:!this.isExpanded),(0,n.nl0)(this.eGroupOpenedIcon,!0===this.isExpanded),this.hasIndeterminateExpandState&&(0,n.nl0)(this.eGroupIndeterminateIcon,void 0===this.isExpanded)}onCheckboxChanged(e){this.isSelected=e,this.dispatchLocalEvent({type:"selectionChanged",isSelected:e,item:this.item}),this.refreshVariableAriaLabels(),this.refreshAriaChecked()}toggleSelected(){this.params.readOnly||this.setSelected(!this.isSelected)}setSelected(e,t){this.isSelected=e,this.eCheckbox.setValue(e,t),this.refreshAriaChecked()}refreshVariableAriaLabels(){if(!this.isTree)return;const e=this.localeService.getLocaleTextFunc(),t=this.eCheckbox.getValue(),s=void 0===t?e("ariaIndeterminate","indeterminate"):t?e("ariaVisible","visible"):e("ariaHidden","hidden"),i=e("ariaToggleVisibility","Press SPACE to toggle visibility");(0,n.F4t)(this.eCheckbox.getInputElement(),void 0),this.eCheckbox.setInputAriaLabel(`${i} (${s})`)}setupFixedAriaLabels(e){if(!this.isTree)return;const s=this.localeService.getLocaleTextFunc()("ariaFilterValue","Filter Value"),i=this.getAriaElement();(0,n.PIC)(i,`${e} ${s}`),(0,n.TMe)(i,this.eCheckbox.getInputElement().id)}refreshAriaChecked(){const e=this.getAriaElement();(0,n.cPC)(e,this.eCheckbox.getValue())}refreshAriaExpanded(){(0,n.oAJ)(this.getAriaElement(),!!this.isExpanded)}refresh(e,t,s){if(this.item=e,t!==this.isSelected&&this.setSelected(t,!0),this.setExpanded(s,!0),this.valueFunction){const i=this.valueFunction();this.setTooltipAndCellRendererParams(i,i),this.cellRendererComponent||this.renderCellWithoutCellRenderer()}if(this.cellRendererComponent&&!this.cellRendererComponent.refresh?.(this.cellRendererParams)){const r=this.cellRendererComponent;this.renderCell(),this.destroyBean(r)}}render(){const{params:{column:e}}=this;let{value:t}=this,s=null;"function"==typeof t?(this.valueFunction=t,s=this.valueFunction(),t=s):s=this.isTree?(0,n.qph)(t):this.getFormattedValue(e,t),this.setTooltipAndCellRendererParams(t,s),this.renderCell()}setTooltipAndCellRendererParams(e,t){const s="whenTruncated"===this.gos.get("tooltipShowMode");if(this.params.showTooltips&&(!s||!this.params.cellRenderer)){const i=t??(0,n.qph)(e);let r;s&&(r=()=>{const o=this.eCheckbox.getGui().querySelector(".ag-label");return!o||o.scrollWidth>o.clientWidth}),this.setTooltip({newTooltipText:i,location:"setFilterValue",getColDef:()=>this.params.colDef,getColumn:()=>this.params.column,shouldDisplayTooltip:r})}this.cellRendererParams=this.gos.addGridCommonParams({value:e,valueFormatted:t,colDef:this.params.colDef,column:this.params.column,setTooltip:(i,r)=>{this.setTooltip({newTooltipText:i,getColDef:()=>this.params.colDef,getColumn:()=>this.params.column,location:"setFilterValue",shouldDisplayTooltip:r})}})}getTooltipParams(){const e=super.getTooltipParams();return e.location="setFilterValue",e.colDef=this.getComponentHolder(),this.isTree&&(e.level=this.depth),e}getFormattedValue(e,t){return this.valueService.formatValue(e,null,t,this.valueFormatter,!1)}renderCell(){const e=this.userComponentFactory.getSetFilterCellRendererDetails(this.params,this.cellRendererParams),t=e?e.newAgStackInstance():void 0;null!=t?t.then(s=>{s&&(this.cellRendererComponent=s,this.eCheckbox.setLabel(s.getGui()),this.destroyCellRendererComponent=()=>this.destroyBean(s))}):this.renderCellWithoutCellRenderer()}renderCellWithoutCellRenderer(){let e=(null==this.cellRendererParams.valueFormatted?this.cellRendererParams.value:this.cellRendererParams.valueFormatted)??this.translate("blanks");"string"!=typeof e&&((0,n.JT7)(`Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects. See ${this.getFrameworkOverrides().getDocLink("filter-set-filter-list/#filter-value-types")}`),e=""),this.eCheckbox.setLabel(e),this.setupFixedAriaLabels(e)}getComponentHolder(){return this.params.column.getColDef()}},gs=class{getModelAsString(e,t){const{values:s}=e||t.getModel()||{},i=t.getValueModel();if(null==s||null==i)return"";const r=s.filter(a=>i.isKeyAvailable(a)),o=r.length;return`(${o}) ${r.slice(0,10).map(a=>t.getFormattedValue(a)).join(",")}${o>10?",...":""}`}};function rt(e,t,s){let i=e;return i?(i=i.map(r=>(0,n.qph)((0,n.X7E)(r))),!t&&s&&i.some(r=>null==r)?null==(0,n.GXs)(i)?null:i.filter(r=>null!=r):i):null}var Pa=class{constructor(e,t,s,i,r,o,l,a,d,u,h){this.rowModel=e,this.filterParams=t,this.createKey=s,this.caseFormat=i,this.funcColsService=r,this.valueService=o,this.treeDataOrGrouping=l,this.treeData=a,this.getDataPath=d,this.groupAllowUnbalanced=u,this.addManagedEventListeners=h}extractUniqueValuesAsync(e,t){return new n.oY$(s=>{if(this.rowModel.isRowDataLoaded())s(this.extractUniqueValues(e,t));else{const[i]=this.addManagedEventListeners({rowCountReady:()=>{i?.(),s(this.extractUniqueValues(e,t))}})}})}extractUniqueValues(e,t){const s=new Map,i=this.extractExistingFormattedKeys(t),r=new Set,o=this.treeData&&!!this.getDataPath,l=this.funcColsService.getRowGroupColumns(),a=(d,u)=>{const h=this.caseFormat(d);if(!r.has(h)){r.add(h);let c=d,p=(0,n.X7E)(u);const g=i?.get(h);null!=g&&(c=g,p=t.get(g)),s.set(c,p)}};return this.rowModel.forEachLeafNode(d=>{if(!d.data||!e(d))return;if(this.treeDataOrGrouping)return void this.addValueForTreeDataOrGrouping(d,o,l,a);const u=this.getValue(d);null!=u&&Array.isArray(u)?(u.forEach(h=>{a(this.createKey(h,d),h)}),0===u.length&&a(null,null)):a(this.createKey(u,d),u)}),s}addValueForTreeDataOrGrouping(e,t,s,i){let r;if(t){if(e.childrenAfterGroup?.length)return;r=this.getDataPath(e.data)}else r=s.map(l=>this.valueService.getKeyForNode(l,e)),r.push(this.getValue(e));const o=rt(r,t,this.groupAllowUnbalanced);i(this.createKey(o),o)}getValue(e){return this.filterParams.getValue(e)}extractExistingFormattedKeys(e){if(!e)return null;const t=new Map;return e.forEach((s,i)=>{t.set(this.caseFormat(i),i)}),t}},Ea=class{constructor({caseFormat:e}){this.filteringKeys=null,this.filteringKeysCaseFormatted=null,this.hasNoAppliedFilteringKeys=!1,this.caseFormat=e}allFilteringKeys(){return this.filteringKeys}allFilteringKeysCaseFormatted(){return this.filteringKeysCaseFormatted}noAppliedFilteringKeys(){return this.hasNoAppliedFilteringKeys}setFilteringKeys(e){this.filteringKeys=new Set(e),this.hasNoAppliedFilteringKeys=!this.filteringKeys||0===this.filteringKeys.size,this.filteringKeysCaseFormatted=new Set,this.filteringKeys.forEach(t=>this.filteringKeysCaseFormatted.add(this.caseFormat(t)))}addFilteringKey(e){null==this.filteringKeys&&(this.filteringKeys=new Set,this.filteringKeysCaseFormatted=new Set),this.filteringKeys.add(e),this.filteringKeysCaseFormatted.add(this.caseFormat(e)),this.hasNoAppliedFilteringKeys&&(this.hasNoAppliedFilteringKeys=!1)}hasCaseFormattedFilteringKey(e){return this.filteringKeysCaseFormatted.has(this.caseFormat(e))}hasFilteringKey(e){return this.filteringKeys.has(e)}reset(){this.filteringKeys=null,this.filteringKeysCaseFormatted=null,this.hasNoAppliedFilteringKeys=!1}},Ta=class{constructor(e,t,s,i){this.valueService=e,this.valueFormatter=t,this.formatter=s,this.column=i,this.displayedKeys=[]}updateDisplayedValuesToAllAvailable(e,t,s){this.displayedKeys=Array.from(s)}updateDisplayedValuesToMatchMiniFilter(e,t,s,i,r){this.displayedKeys=[];for(const o of s)if(null==o)r&&this.displayedKeys.push(o);else{const l=e(o),a=this.valueService.formatValue(this.column,null,l,this.valueFormatter,!1);i(this.formatter(a))&&this.displayedKeys.push(o)}}getDisplayedValueCount(){return this.displayedKeys.length}getDisplayedItem(e){return this.displayedKeys[e]}getSelectAllItem(){return k.SELECT_ALL}getAddSelectionToFilterItem(){return k.ADD_SELECTION_TO_FILTER}getDisplayedKeys(){return this.displayedKeys}forEachDisplayedKey(e){this.displayedKeys.forEach(e)}someDisplayedKey(e){return this.displayedKeys.some(e)}hasGroups(){return!1}refresh(){}},Da=e=>e?[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())]:null,fs=class{constructor(e,t,s,i){this.formatter=e,this.treeListPathGetter=t,this.treeListFormatter=s,this.treeDataOrGrouping=i,this.allDisplayedItemsTree=[],this.activeDisplayedItemsFlat=[],this.selectAllItem={depth:0,filterPasses:!0,available:!0,treeKey:k.SELECT_ALL,children:this.allDisplayedItemsTree,expanded:!0,key:k.SELECT_ALL,parentTreeKeys:[]},this.addSelectionToFilterItem={depth:0,filterPasses:!0,available:!0,treeKey:k.ADD_SELECTION_TO_FILTER,expanded:!0,key:k.ADD_SELECTION_TO_FILTER,parentTreeKeys:[]}}updateOnParamsChange(e){this.treeListFormatter=e}updateDisplayedValuesToAllAvailable(e,t,s,i){"reload"===i?this.generateItemTree(e,t,s):"otherFilter"===i?(this.updateAvailable(s),this.updateExpandAll()):"miniFilter"===i&&(this.resetFilter(),this.updateExpandAll()),this.flattenItems()}updateDisplayedValuesToMatchMiniFilter(e,t,s,i,r,o){"reload"===o?this.generateItemTree(e,t,s):"otherFilter"===o&&this.updateAvailable(s),this.updateFilter(i,r),this.updateExpandAll(),this.flattenItems()}generateItemTree(e,t,s){this.allDisplayedItemsTree=[],this.groupsExist=!1;const i=this.getTreeListPathGetter(e,s);for(const r of t){const l=i(e(r))??[null];l.length>1&&(this.groupsExist=!0);const a=s.has(r);let u,d=this.allDisplayedItemsTree,h=[];l.forEach((c,p)=>{d||(d=[],u.children=d),u=d.find(g=>g.treeKey?.toUpperCase()===c?.toUpperCase()),u||(u={treeKey:c,depth:p,filterPasses:!0,expanded:!1,available:a,parentTreeKeys:h},p===l.length-1&&(u.key=r),d.push(u)),d=u.children,h=[...h,c]})}this.updateAvailable(s),this.selectAllItem.children=this.allDisplayedItemsTree,this.selectAllItem.expanded=!1}getTreeListPathGetter(e,t){if(this.treeListPathGetter)return this.treeListPathGetter;if(this.treeDataOrGrouping)return i=>i;let s=!1;for(const i of t){const r=e(i);if(r instanceof Date){s=!0;break}if(null!=r)break}return s?Da:((0,n.JT7)("property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date."),i=>[String(i)])}flattenItems(){this.activeDisplayedItemsFlat=[];const e=t=>{t.forEach(s=>{!s.filterPasses||!s.available||(this.activeDisplayedItemsFlat.push(s),s.children&&s.expanded&&e(s.children))})};e(this.allDisplayedItemsTree)}resetFilter(){const e=t=>{t.children&&t.children.forEach(s=>{e(s)}),t.filterPasses=!0};this.allDisplayedItemsTree.forEach(t=>e(t))}updateFilter(e,t){const s=i=>!!i.available&&(null==i.treeKey?t:e(this.formatter(this.treeListFormatter?this.treeListFormatter(i.treeKey,i.depth,i.parentTreeKeys):i.treeKey)));this.allDisplayedItemsTree.forEach(i=>this.recursiveItemCheck(i,!1,s,"filterPasses"))}getDisplayedValueCount(){return this.activeDisplayedItemsFlat.length}getDisplayedItem(e){return this.activeDisplayedItemsFlat[e]}getSelectAllItem(){return this.selectAllItem}getAddSelectionToFilterItem(){return this.addSelectionToFilterItem}getDisplayedKeys(){const e=[];return this.forEachDisplayedKey(t=>e.push(t)),e}forEachDisplayedKey(e){const t=(s,i)=>{s.children?(!s.expanded||!i)&&s.children.forEach(r=>{r.filterPasses&&t(r,!1)}):e(s.key)};this.activeDisplayedItemsFlat.forEach(s=>t(s,!0))}someDisplayedKey(e){const t=(s,i)=>s.children?(!s.expanded||!i)&&s.children.some(r=>!!r.filterPasses&&t(r,!1)):e(s.key);return this.activeDisplayedItemsFlat.some(s=>t(s,!0))}hasGroups(){return this.groupsExist}refresh(){this.updateExpandAll(),this.flattenItems()}updateExpandAll(){const e=(s,i,r)=>{for(const o of s){if(!o.filterPasses||!o.available||!o.children)continue;if(r=r||!o.expanded,(i=i||!!o.expanded)&&r)return;const l=e(o.children,i,r);if(void 0===l)return;l?i=!0:r=!0}return i&&r?void 0:i},t=this.getSelectAllItem();t.expanded=e(t.children,!1,!1)}recursiveItemCheck(e,t,s,i){let r=!1;e.children&&e.children.forEach(l=>{const a=this.recursiveItemCheck(l,t||s(e),s,i);r=r||a});const o=t||r||s(e);return e[i]=o,o}updateAvailable(e){const t=s=>e.has(s.key);this.allDisplayedItemsTree.forEach(s=>this.recursiveItemCheck(s,!1,t,"available"))}},Ga=class{constructor(e){this.localEventService=new n.$UK,this.miniFilterText=null,this.addCurrentSelectionToFilter=!1,this.providedValues=null,this.allValues=new Map,this.availableKeys=new Set,this.selectedKeys=new Set,this.initialised=!1;const{usingComplexObjects:t,funcColsService:s,valueService:i,treeDataTreeList:r,groupingTreeList:o,filterParams:l,gos:a,valueFormatter:d,addManagedEventListeners:u}=e,{column:h,colDef:c,textFormatter:p,doesRowPassOtherFilter:g,suppressSorting:f,comparator:v,rowModel:y,values:C,caseSensitive:S,treeList:w,treeListPathGetter:x,treeListFormatter:M}=l;this.filterParams=l,this.gos=a,this.setIsLoading=e.setIsLoading,this.translate=e.translate,this.caseFormat=e.caseFormat,this.createKey=e.createKey,this.usingComplexObjects=!!e.usingComplexObjects,this.formatter=p??(U=>U??null),this.doesRowPassOtherFilters=g,this.suppressSorting=f||!1,this.filteringKeys=new Ea({caseFormat:this.caseFormat});const T=v??c.comparator,J=!!r||!!o;this.compareByValue=!!(t&&T||J||w&&!x),this.entryComparator=J&&!T?this.createTreeDataOrGroupingComparator():!w||x||T?([U,ne],[cd,dt])=>T(ne,dt):([U,ne],[cd,dt])=>(0,n.j0N)(ne,dt),this.keyComparator=T??n.j0N,this.caseSensitive=!!S;const oe=a.get("getDataPath"),Y=a.get("groupAllowUnbalanced");(0,n.dbY)(a)&&(this.clientSideValuesExtractor=new Pa(y,this.filterParams,this.createKey,this.caseFormat,s,i,J,!!r,oe,Y,u)),null==C?this.valuesType=2:(this.valuesType=Array.isArray(C)?0:1,this.providedValues=C),this.displayValueModel=w?new fs(this.formatter,x,M,r||o):new Ta(i,d,this.formatter,h),this.updateAllValues().then(U=>this.resetSelectionState(U||[]))}addEventListener(e,t,s){this.localEventService.addEventListener(e,t,s)}removeEventListener(e,t,s){this.localEventService.removeEventListener(e,t,s)}updateOnParamsChange(e){return new n.oY$(t=>{const{values:s,textFormatter:i,suppressSorting:r,treeListFormatter:o}=e,l=this.providedValues,a=this.suppressSorting;if(this.filterParams=e,this.formatter=i??(d=>d??null),this.suppressSorting=r||!1,this.providedValues=s??null,this.displayValueModel instanceof fs&&this.displayValueModel.updateOnParamsChange(o),this.providedValues!==l||this.suppressSorting!==a){s&&0!==s.length?this.valuesType=Array.isArray(s)?0:1:(this.valuesType=2,this.providedValues=null);const d=this.getModel();this.updateAllValues().then(()=>{this.setModel(d).then(()=>t())})}else t()})}refreshValues(){return new n.oY$(e=>{this.allValuesPromise.then(()=>{const t=this.getModel();this.updateAllValues(),this.setModel(t).then(()=>e())})})}overrideValues(e){return new n.oY$(t=>{this.allValuesPromise.then(()=>{this.valuesType=0,this.providedValues=e,this.refreshValues().then(()=>t())})})}refreshAfterAnyFilterChanged(){return this.showAvailableOnly()?this.allValuesPromise.then(e=>(this.updateAvailableKeys(e??[],"otherFilter"),!0)):n.oY$.resolve(!1)}isInitialised(){return this.initialised}updateAllValues(){return this.allValuesPromise=new n.oY$(e=>{switch(this.valuesType){case 2:this.getValuesFromRowsAsync(!1).then(t=>e(this.processAllValues(t)));break;case 0:e(this.processAllValues(this.uniqueValues(this.validateProvidedValues(this.providedValues))));break;case 1:{this.setIsLoading(!0);const t=this.providedValues,{column:s,colDef:i}=this.filterParams,r=this.gos.addGridCommonParams({success:o=>{this.setIsLoading(!1),e(this.processAllValues(this.uniqueValues(this.validateProvidedValues(o))))},colDef:i,column:s});window.setTimeout(()=>t(r),0);break}default:throw new Error("Unrecognised valuesType")}}),this.allValuesPromise.then(e=>this.updateAvailableKeys(e||[],"reload")).then(()=>this.initialised=!0),this.allValuesPromise}processAllValues(e){const t=this.sortKeys(e);return this.allValues=e??new Map,t}validateProvidedValues(e){if(this.usingComplexObjects&&e?.length){const t=e[0];t&&"object"!=typeof t&&"function"!=typeof t&&(null==this.createKey(t)?(0,n.JT7)("Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See https://www.ag-grid.com/javascript-data-grid/filter-set-filter-list/#filter-value-types"):(0,n.JT7)("Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?"))}return e}setValuesType(e){this.valuesType=e}getValuesType(){return this.valuesType}isKeyAvailable(e){return this.availableKeys.has(e)}showAvailableOnly(){return 2===this.valuesType}updateAvailableKeys(e,t){const s=this.showAvailableOnly()?this.sortKeys(this.getValuesFromRows(!0)):e;this.availableKeys=new Set(s),this.localEventService.dispatchEvent({type:"availableValuesChanged"}),this.updateDisplayedValues(t,e)}sortKeys(e){const t=e??new Map;if(this.suppressSorting)return Array.from(t.keys());let s;return s=this.compareByValue?Array.from(t.entries()).sort(this.entryComparator).map(([i])=>i):Array.from(t.keys()).sort(this.keyComparator),this.filterParams.excelMode&&t.has(null)&&(s=s.filter(i=>null!=i),s.push(null)),s}getParamsForValuesFromRows(e=!1){return this.clientSideValuesExtractor?{predicate:i=>!e||this.doesRowPassOtherFilters(i),existingValues:e&&!this.caseSensitive?this.allValues:void 0}:((0,n.D1O)("Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values"),null)}getValuesFromRows(e=!1){const t=this.getParamsForValuesFromRows(e);return t?this.clientSideValuesExtractor.extractUniqueValues(t.predicate,t.existingValues):null}getValuesFromRowsAsync(e=!1){const t=this.getParamsForValuesFromRows(e);return t?this.clientSideValuesExtractor.extractUniqueValuesAsync(t.predicate,t.existingValues):n.oY$.resolve(null)}setMiniFilter(e){return e=(0,n.X7E)(e),this.miniFilterText!==e&&(null===e&&this.setAddCurrentSelectionToFilter(!1),this.miniFilterText=e,this.updateDisplayedValues("miniFilter"),!0)}getMiniFilter(){return this.miniFilterText}updateDisplayedValues(e,t){if("expansion"===e)return void this.displayValueModel.refresh();if(null==this.miniFilterText)return void this.displayValueModel.updateDisplayedValuesToAllAvailable(o=>this.getValue(o),t,this.availableKeys,e);const s=this.caseFormat(this.formatter(this.miniFilterText)||""),i=o=>null!=o&&this.caseFormat(o).indexOf(s)>=0,r=!!this.filterParams.excelMode&&i(this.translate("blanks"));this.displayValueModel.updateDisplayedValuesToMatchMiniFilter(o=>this.getValue(o),t,this.availableKeys,i,r,e)}getDisplayedValueCount(){return this.displayValueModel.getDisplayedValueCount()}getDisplayedItem(e){return this.displayValueModel.getDisplayedItem(e)}getSelectAllItem(){return this.displayValueModel.getSelectAllItem()}getAddSelectionToFilterItem(){return this.displayValueModel.getAddSelectionToFilterItem()}hasSelections(){return this.filterParams.defaultToNothingSelected?this.selectedKeys.size>0:this.allValues.size!==this.selectedKeys.size}getKeys(){return Array.from(this.allValues.keys())}getValues(){return Array.from(this.allValues.values())}getValue(e){return this.allValues.get(e)}setAddCurrentSelectionToFilter(e){this.addCurrentSelectionToFilter=e}isInWindowsExcelMode(){return"windows"===this.filterParams.excelMode}isAddCurrentSelectionToFilterChecked(){return this.isInWindowsExcelMode()&&this.addCurrentSelectionToFilter}showAddCurrentSelectionToFilter(){return this.isInWindowsExcelMode()&&(0,n.Qmv)(this.miniFilterText)&&this.miniFilterText.length>0}selectAllMatchingMiniFilter(e=!1){null==this.miniFilterText?this.selectedKeys=new Set(this.allValues.keys()):(e&&this.selectedKeys.clear(),this.displayValueModel.forEachDisplayedKey(t=>this.selectedKeys.add(t)))}deselectAllMatchingMiniFilter(){null==this.miniFilterText?this.selectedKeys.clear():this.displayValueModel.forEachDisplayedKey(e=>this.selectedKeys.delete(e))}selectKey(e){this.selectedKeys.add(e)}deselectKey(e){this.filterParams.excelMode&&this.isEverythingVisibleSelected()&&this.resetSelectionState(this.displayValueModel.getDisplayedKeys()),this.selectedKeys.delete(e)}isKeySelected(e){return this.selectedKeys.has(e)}isEverythingVisibleSelected(){return!this.displayValueModel.someDisplayedKey(e=>!this.isKeySelected(e))}isNothingVisibleSelected(){return!this.displayValueModel.someDisplayedKey(e=>this.isKeySelected(e))}getModel(){if(!this.hasSelections())return null;const e=this.isAddCurrentSelectionToFilterChecked()?this.filteringKeys.allFilteringKeys():null;if(e&&e.size>0){if(this.selectedKeys){const t=new Set([...Array.from(e),...Array.from(this.selectedKeys).filter(s=>!e.has(s))]);return Array.from(t)}return Array.from(e)}return Array.from(this.selectedKeys)}setModel(e){return this.allValuesPromise.then(t=>{if(null==e)this.resetSelectionState(t??[]);else{this.selectedKeys.clear();const s=new Map;this.allValues.forEach((i,r)=>{s.set(this.caseFormat(r),r)}),e.forEach(i=>{const r=this.caseFormat((0,n.X7E)(i)),o=s.get(r);void 0!==o&&this.selectKey(o)})}})}uniqueValues(e){const t=new Map,s=new Set;return(e??[]).forEach(i=>{const r=(0,n.X7E)(i),o=this.createKey(r),l=this.caseFormat(o);s.has(l)||(s.add(l),t.set(o,r))}),t}resetSelectionState(e){this.filterParams.defaultToNothingSelected?this.selectedKeys.clear():this.selectedKeys=new Set(e)}hasGroups(){return this.displayValueModel.hasGroups()}createTreeDataOrGroupingComparator(){return([e,t],[s,i])=>{if(null==t)return null==i?0:-1;if(null==i)return 1;for(let r=0;r<t.length;r++){if(r>=i.length)return 1;const o=(0,n.j0N)(t[r],i[r]);if(0!==o)return o}return 0}}setAppliedModelKeys(e){this.filteringKeys.setFilteringKeys(e)}addToAppliedModelKeys(e){this.filteringKeys.addFilteringKey(e)}getAppliedModelKeys(){return this.filteringKeys.allFilteringKeys()}getCaseFormattedAppliedModelKeys(){return this.filteringKeys.allFilteringKeysCaseFormatted()}hasAppliedModelKey(e){return this.filteringKeys.hasCaseFormattedFilteringKey(e)}hasAnyAppliedModelKey(){return!this.filteringKeys.noAppliedFilteringKeys()}},ms=class extends n.Q5x{constructor(){super("setFilter"),this.eMiniFilter=n.dRA,this.eFilterLoading=n.dRA,this.eSetFilterList=n.dRA,this.eFilterNoMatches=n.dRA,this.valueModel=null,this.setFilterParams=null,this.virtualList=null,this.caseSensitive=!1,this.treeDataTreeList=!1,this.groupingTreeList=!1,this.hardRefreshVirtualList=!1,this.noValueFormatterSupplied=!1,this.filterModelFormatter=new gs,this.updateSetFilterOnParamsChange=e=>{this.setFilterParams=e,this.caseSensitive=!!e.caseSensitive;const t=e.keyCreator??e.colDef.keyCreator;this.setValueFormatter(e.valueFormatter,t,!!e.treeList,!!e.colDef.refData);const s=e.column.getId().startsWith(n.JPk);this.treeDataTreeList=this.gos.get("treeData")&&!!e.treeList&&s,this.getDataPath=this.gos.get("getDataPath"),this.groupingTreeList=!!this.funcColsService.getRowGroupColumns().length&&!!e.treeList&&s,this.createKey=this.generateCreateKey(t,this.treeDataTreeList||this.groupingTreeList)}}wireBeans(e){super.wireBeans(e),this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.dataTypeService=e.dataTypeService}postConstruct(){super.postConstruct()}updateUiVisibility(){}createBodyTemplate(){return`\n            <div class="ag-set-filter">\n                <div data-ref="eFilterLoading" class="ag-filter-loading ag-hidden">${this.translateForSetFilter("loadingOoo")}</div>\n                <ag-input-text-field class="ag-mini-filter" data-ref="eMiniFilter"></ag-input-text-field>\n                <div data-ref="eFilterNoMatches" class="ag-filter-no-matches ag-hidden">${this.translateForSetFilter("noMatches")}</div>\n                <div data-ref="eSetFilterList" class="ag-set-filter-list" role="presentation"></div>\n            </div>`}getAgComponents(){return[n.n1z]}handleKeyDown(e){if(super.handleKeyDown(e),!e.defaultPrevented)switch(e.key){case n.DDm.SPACE:this.handleKeySpace(e);break;case n.DDm.ENTER:this.handleKeyEnter(e);break;case n.DDm.LEFT:this.handleKeyLeft(e);break;case n.DDm.RIGHT:this.handleKeyRight(e)}}handleKeySpace(e){this.getComponentForKeyEvent(e)?.toggleSelected()}handleKeyEnter(e){if(!this.setFilterParams)return;const{excelMode:t,readOnly:s}=this.setFilterParams||{};!t||s||(e.preventDefault(),this.onBtApply(!1,!1,e),"mac"===this.setFilterParams.excelMode&&this.eMiniFilter.getInputElement().select())}handleKeyLeft(e){this.getComponentForKeyEvent(e)?.setExpanded(!1)}handleKeyRight(e){this.getComponentForKeyEvent(e)?.setExpanded(!0)}getComponentForKeyEvent(e){if(!this.eSetFilterList.contains((0,n.UlD)(this.gos))||!this.virtualList)return;const t=this.virtualList.getLastFocusedRow();if(null==t)return;const s=this.virtualList.getComponentAt(t);if(null==s)return;e.preventDefault();const{readOnly:i}=this.setFilterParams??{};return i?void 0:s}getCssIdentifier(){return"set-filter"}setModel(e){return null==e&&null==this.valueModel?.getModel()?(this.setMiniFilter(null),n.oY$.resolve()):super.setModel(e)}refresh(e){if(this.applyExcelModeOptions(e),!super.refresh(e))return!1;const t=this.setFilterParams;return!["treeList","treeListPathGetter","caseSensitive","comparator","excelMode"].some(i=>e[i]!==t?.[i])&&!this.haveColDefParamsChanged(e)&&(super.updateParams(e),this.updateSetFilterOnParamsChange(e),this.updateMiniFilter(),e.suppressSelectAll!==t?.suppressSelectAll&&this.createVirtualListModel(e),this.valueModel?.updateOnParamsChange(e).then(()=>{this.refreshFilterValues()}),!0)}haveColDefParamsChanged(e){const{colDef:t,keyCreator:s}=e,{colDef:i,keyCreator:r}=this.setFilterParams??{},o=s??t.keyCreator,l=r??i?.keyCreator,a=t.filterValueGetter!==i?.filterValueGetter,d=o!==l,u=!!this.dataTypeService&&!!o&&this.dataTypeService.getFormatValue(t.cellDataType)===o&&t.valueFormatter!==i?.valueFormatter;return a||d||u}setModelAndRefresh(e){return this.valueModel?this.valueModel.setModel(e).then(()=>{this.isAlive()&&this.checkAndRefreshVirtualList()}):n.oY$.resolve()}resetUiToDefaults(){return this.setMiniFilter(null),this.setModelAndRefresh(null)}setModelIntoUi(e){return this.setMiniFilter(null),this.setModelAndRefresh(null==e?null:e.values)}getModelFromUi(){if(!this.valueModel)throw new Error("Value model has not been created.");const e=this.valueModel.getModel();return e?{values:e,filterType:this.getFilterType()}:null}getFilterType(){return"set"}getValueModel(){return this.valueModel}areModelsEqual(e,t){return null==e&&null==t||null!=e&&null!=t&&(0,n.MpY)(e.values,t.values)}setParams(e){this.applyExcelModeOptions(e),super.setParams(e),this.updateSetFilterOnParamsChange(e),this.valueModel=new Ga({filterParams:e,setIsLoading:s=>this.setIsLoading(s),translate:s=>this.translateForSetFilter(s),caseFormat:s=>this.caseFormat(s),createKey:this.createKey,valueFormatter:this.valueFormatter,usingComplexObjects:!!(e.keyCreator??e.colDef.keyCreator),gos:this.gos,funcColsService:this.funcColsService,valueService:this.valueService,treeDataTreeList:this.treeDataTreeList,groupingTreeList:this.groupingTreeList,addManagedEventListeners:s=>this.addManagedEventListeners(s)}),this.initialiseFilterBodyUi(),this.addEventListenersForDataChanges()}onAddCurrentSelectionToFilterChange(e){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setAddCurrentSelectionToFilter(e)}setValueFormatter(e,t,s,i){let r=e;if(!r){if(t&&!s)throw new Error("AG Grid: Must supply a Value Formatter in Set Filter params when using a Key Creator");this.noValueFormatterSupplied=!0,i||(r=o=>(0,n.qph)(o.value))}this.valueFormatter=r}generateCreateKey(e,t){if(t&&!e)throw new Error("AG Grid: Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.");return e?(s,i=null)=>{const r=this.getKeyCreatorParams(s,i);return(0,n.X7E)(e(r))}:s=>(0,n.X7E)((0,n.qph)(s))}getFormattedValue(e){let t=this.valueModel.getValue(e);return this.noValueFormatterSupplied&&(this.treeDataTreeList||this.groupingTreeList)&&Array.isArray(t)&&(t=(0,n.GXs)(t)),this.valueService.formatValue(this.setFilterParams.column,null,t,this.valueFormatter,!1)??(0,n.qph)(t)??this.translateForSetFilter("blanks")}applyExcelModeOptions(e){"windows"===e.excelMode?(e.buttons||(e.buttons=["apply","cancel"]),null==e.closeOnApply&&(e.closeOnApply=!0)):"mac"===e.excelMode&&(e.buttons||(e.buttons=["reset"]),null==e.applyMiniFilterWhileTyping&&(e.applyMiniFilterWhileTyping=!0),null==e.debounceMs&&(e.debounceMs=500)),e.excelMode&&e.defaultToNothingSelected&&(e.defaultToNothingSelected=!1,(0,n.JT7)('The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.'))}addEventListenersForDataChanges(){this.isValuesTakenFromGrid()&&(this.addManagedEventListeners({cellValueChanged:e=>{this.setFilterParams&&e.column===this.setFilterParams.column&&this.syncAfterDataChange()}}),this.addManagedPropertyListeners(["treeData","getDataPath","groupAllowUnbalanced"],()=>{this.syncAfterDataChange()}))}syncAfterDataChange(){if(!this.valueModel)throw new Error("Value model has not been created.");return this.valueModel.refreshValues().then(()=>{this.checkAndRefreshVirtualList(),(!this.applyActive||this.areModelsEqual(this.getModel(),this.getModelFromUi()))&&this.onBtApply(!1,!0)})}setIsLoading(e){(0,n.nl0)(this.eFilterLoading,e),e||(this.hardRefreshVirtualList=!0)}initialiseFilterBodyUi(){this.initVirtualList(),this.initMiniFilter()}initVirtualList(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const t=this.localeService.getLocaleTextFunc()("ariaFilterList","Filter List"),s=!!this.setFilterParams.treeList,i=this.virtualList=this.createBean(new R.wj({cssIdentifier:"filter",ariaRole:s?"tree":"listbox",listName:t})),r=this.eSetFilterList;s&&r.classList.add("ag-set-filter-tree-list"),r&&r.appendChild(i.getGui());const{cellHeight:o}=this.setFilterParams;null!=o&&i.setRowHeight(o),i.setComponentCreator((d,u)=>this.createSetListItem(d,s,u)),i.setComponentUpdater((d,u)=>this.updateSetListItem(d,u)),this.createVirtualListModel(this.setFilterParams)}createVirtualListModel(e){if(!this.valueModel)return;let t;t=e.suppressSelectAll?new Ia(this.valueModel):new La(this.valueModel,()=>this.isSelectAllSelected()),e.treeList&&(t=new ka(t)),this.virtualList?.setModel(t)}getSelectAllLabel(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const e=null!=this.valueModel.getMiniFilter()&&this.setFilterParams.excelMode?"selectAllSearchResults":"selectAll";return this.translateForSetFilter(e)}getAddSelectionToFilterLabel(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");return this.translateForSetFilter("addCurrentSelectionToFilter")}createSetListItem(e,t,s){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const i=this.valueModel.hasGroups(),{isSelected:r,isExpanded:o}=this.isSelectedExpanded(e),{value:l,depth:a,isGroup:d,hasIndeterminateExpandState:u,selectedListener:h,expandedListener:c}=this.newSetListItemAttributes(e),g=this.createBean(new ba({focusWrapper:s,value:l,params:this.setFilterParams,translate:f=>this.translateForSetFilter(f),valueFormatter:this.valueFormatter,item:e,isSelected:r,isTree:t,depth:a,groupsExist:i,isGroup:d,isExpanded:o,hasIndeterminateExpandState:u}));return g.addEventListener("selectionChanged",h),c&&g.addEventListener("expandedChanged",c),g}newSetTreeItemAttributes(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const t=this.valueModel.hasGroups();return e.key===k.SELECT_ALL?{value:()=>this.getSelectAllLabel(),isGroup:t,depth:e.depth,hasIndeterminateExpandState:!0,selectedListener:s=>this.onSelectAll(s.isSelected),expandedListener:s=>this.onExpandAll(s.item,s.isExpanded)}:e.key===k.ADD_SELECTION_TO_FILTER?{value:()=>this.getAddSelectionToFilterLabel(),depth:e.depth,isGroup:!1,hasIndeterminateExpandState:!1,selectedListener:s=>{this.onAddCurrentSelectionToFilterChange(s.isSelected)}}:e.children?{value:this.setFilterParams.treeListFormatter?.(e.treeKey,e.depth,e.parentTreeKeys)??e.treeKey,depth:e.depth,isGroup:!0,selectedListener:s=>this.onGroupItemSelected(s.item,s.isSelected),expandedListener:s=>this.onExpandedChanged(s.item,s.isExpanded)}:{value:this.setFilterParams.treeListFormatter?.(e.treeKey,e.depth,e.parentTreeKeys)??e.treeKey,depth:e.depth,selectedListener:s=>this.onItemSelected(s.item.key,s.isSelected)}}newSetListItemAttributes(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");return this.isSetFilterModelTreeItem(e)?this.newSetTreeItemAttributes(e):e===k.SELECT_ALL?{value:()=>this.getSelectAllLabel(),selectedListener:t=>this.onSelectAll(t.isSelected)}:e===k.ADD_SELECTION_TO_FILTER?{value:()=>this.getAddSelectionToFilterLabel(),selectedListener:t=>{this.onAddCurrentSelectionToFilterChange(t.isSelected)}}:{value:this.valueModel.getValue(e),selectedListener:t=>this.onItemSelected(t.item,t.isSelected)}}updateSetListItem(e,t){const{isSelected:s,isExpanded:i}=this.isSelectedExpanded(e);t.refresh(e,s,i)}isSelectedExpanded(e){let t,s;return this.isSetFilterModelTreeItem(e)?(s=e.expanded,t=e.key===k.SELECT_ALL?this.isSelectAllSelected():e.key===k.ADD_SELECTION_TO_FILTER?this.valueModel.isAddCurrentSelectionToFilterChecked():e.children?this.areAllChildrenSelected(e):this.valueModel.isKeySelected(e.key)):t=e===k.SELECT_ALL?this.isSelectAllSelected():e===k.ADD_SELECTION_TO_FILTER?this.valueModel.isAddCurrentSelectionToFilterChecked():this.valueModel.isKeySelected(e),{isSelected:t,isExpanded:s}}isSetFilterModelTreeItem(e){return void 0!==e?.treeKey}initMiniFilter(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{eMiniFilter:e,localeService:t}=this,s=t.getLocaleTextFunc();e.setDisplayed(!this.setFilterParams.suppressMiniFilter),e.setValue(this.valueModel.getMiniFilter()),e.onValueChange(()=>this.onMiniFilterInput()),e.setInputAriaLabel(s("ariaSearchFilterValues","Search filter values")),this.addManagedElementListeners(e.getInputElement(),{keydown:i=>this.onMiniFilterKeyDown(i)})}updateMiniFilter(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{eMiniFilter:e}=this;e.isDisplayed()!==!this.setFilterParams.suppressMiniFilter&&e.setDisplayed(!this.setFilterParams.suppressMiniFilter);const t=this.valueModel.getMiniFilter();e.getValue()!==t&&e.setValue(t)}afterGuiAttached(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");super.afterGuiAttached(e),this.resetExpansion(),this.refreshVirtualList();const{eMiniFilter:t}=this;t.setInputPlaceholder(this.translateForSetFilter("searchOoo")),(!e||!e.suppressFocus)&&(t.isDisplayed()?t.getFocusableElement().focus():this.virtualList?.awaitStable(()=>this.virtualList?.focusRow(0)))}afterGuiDetached(){super.afterGuiDetached(),this.setFilterParams?.excelMode&&this.resetMiniFilter();const e=this.getModel();(this.setFilterParams?.excelMode||!this.areModelsEqual(e,this.getModelFromUi()))&&(this.resetUiToActiveModel(e),this.showOrHideResults())}applyModel(e="api"){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");this.setFilterParams.excelMode&&"rowDataUpdated"!==e&&this.valueModel.isEverythingVisibleSelected()&&this.valueModel.selectAllMatchingMiniFilter();const t=this.valueModel.showAddCurrentSelectionToFilter()&&this.valueModel.isAddCurrentSelectionToFilterChecked();if(t&&!this.getModel())return!1;const s=super.applyModel(e),i=this.getModel();return i?(t||this.valueModel.setAppliedModelKeys(new Set),i.values.forEach(r=>{this.valueModel.addToAppliedModelKeys(r)})):t||this.valueModel.setAppliedModelKeys(null),s}isModelValid(e){return!this.setFilterParams||!this.setFilterParams.excelMode||null==e||e.values.length>0}doesFilterPass(e){if(!this.setFilterParams||!this.valueModel||!this.valueModel.getCaseFormattedAppliedModelKeys())return!0;if(!this.valueModel.hasAnyAppliedModelKey())return!1;const{node:t,data:s}=e;if(this.treeDataTreeList)return this.doesFilterPassForTreeData(t,s);if(this.groupingTreeList)return this.doesFilterPassForGrouping(t);const i=this.getValueFromNode(t);return null!=i&&Array.isArray(i)?0===i.length?this.valueModel.hasAppliedModelKey(null):i.some(r=>this.isInAppliedModel(this.createKey(r,t))):this.isInAppliedModel(this.createKey(i,t))}doesFilterPassForTreeData(e,t){return!e.childrenAfterGroup?.length&&this.isInAppliedModel(this.createKey(rt(this.getDataPath(t),!0,this.gos.get("groupAllowUnbalanced"))))}doesFilterPassForGrouping(e){const t=this.funcColsService.getRowGroupColumns().map(s=>this.valueService.getKeyForNode(s,e));return t.push(this.getValueFromNode(e)),this.isInAppliedModel(this.createKey(rt(t,!1,this.gos.get("groupAllowUnbalanced"))))}isInAppliedModel(e){return this.valueModel.hasAppliedModelKey(e)}getValueFromNode(e){return this.setFilterParams.getValue(e)}getKeyCreatorParams(e,t=null){return{value:e,colDef:this.setFilterParams.colDef,column:this.setFilterParams.column,node:t,data:t?.data,api:this.setFilterParams.api,context:this.setFilterParams.context}}onNewRowsLoaded(){this.isValuesTakenFromGrid()&&this.syncAfterDataChange()}isValuesTakenFromGrid(){return!!this.valueModel&&2===this.valueModel.getValuesType()}setFilterValues(e){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.overrideValues(e).then(()=>{this.checkAndRefreshVirtualList(),this.onUiChanged()})}resetFilterValues(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setValuesType(2),this.syncAfterDataChange()}refreshFilterValues(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.isInitialised()&&this.valueModel.refreshValues().then(()=>{this.hardRefreshVirtualList=!0,this.checkAndRefreshVirtualList(),this.onUiChanged()})}onAnyFilterChanged(){setTimeout(()=>{if(this.isAlive()){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.refreshAfterAnyFilterChanged().then(e=>{e&&(this.checkAndRefreshVirtualList(),this.showOrHideResults())})}},0)}onMiniFilterInput(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.valueModel.setMiniFilter(this.eMiniFilter.getValue()))return;const{applyMiniFilterWhileTyping:e,readOnly:t}=this.setFilterParams||{};!t&&e?this.filterOnAllVisibleValues(!1):this.updateUiAfterMiniFilterChange()}updateUiAfterMiniFilterChange(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{excelMode:e,readOnly:t}=this.setFilterParams||{};null==e||t?this.checkAndRefreshVirtualList():null==this.valueModel.getMiniFilter()?this.resetUiToActiveModel(this.getModel()):(this.valueModel.selectAllMatchingMiniFilter(!0),this.checkAndRefreshVirtualList(),this.onUiChanged()),this.showOrHideResults()}showOrHideResults(){if(!this.valueModel)throw new Error("Value model has not been created.");const e=null!=this.valueModel.getMiniFilter()&&this.valueModel.getDisplayedValueCount()<1;(0,n.nl0)(this.eFilterNoMatches,e),(0,n.nl0)(this.eSetFilterList,!e)}resetMiniFilter(){this.eMiniFilter.setValue(null,!0),this.valueModel?.setMiniFilter(null)}resetUiToActiveModel(e,t){this.setModelAndRefresh(null==e?null:e.values).then(()=>{this.onUiChanged(!1,"prevent"),t?.()})}handleCancelEnd(e){this.setMiniFilter(null),super.handleCancelEnd(e)}onMiniFilterKeyDown(e){const{excelMode:t,readOnly:s}=this.setFilterParams||{};e.key===n.DDm.ENTER&&!t&&!s&&this.filterOnAllVisibleValues()}filterOnAllVisibleValues(e=!0){const{readOnly:t}=this.setFilterParams||{};if(!this.valueModel)throw new Error("Value model has not been created.");if(t)throw new Error("Unable to filter in readOnly mode.");this.valueModel.selectAllMatchingMiniFilter(!0),this.checkAndRefreshVirtualList(),this.onUiChanged(!1,e?"immediately":"debounce"),this.showOrHideResults()}focusRowIfAlive(e){null!=e&&window.setTimeout(()=>{if(!this.virtualList)throw new Error("Virtual list has not been created.");this.isAlive()&&this.virtualList.focusRow(e)},0)}onSelectAll(e){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");e?this.valueModel.selectAllMatchingMiniFilter():this.valueModel.deselectAllMatchingMiniFilter(),this.refreshAfterSelection()}onGroupItemSelected(e,t){const s=i=>{i.children?i.children.forEach(r=>s(r)):this.selectItem(i.key,t)};s(e),this.refreshAfterSelection()}onItemSelected(e,t){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");this.selectItem(e,t),this.refreshAfterSelection()}selectItem(e,t){t?this.valueModel.selectKey(e):this.valueModel.deselectKey(e)}onExpandAll(e,t){const s=i=>{i.filterPasses&&i.available&&i.children&&(i.children.forEach(r=>s(r)),i.expanded=t)};s(e),this.refreshAfterExpansion()}onExpandedChanged(e,t){e.expanded=t,this.refreshAfterExpansion()}refreshAfterExpansion(){const e=this.virtualList.getLastFocusedRow();this.valueModel.updateDisplayedValues("expansion"),this.checkAndRefreshVirtualList(),this.focusRowIfAlive(e)}refreshAfterSelection(){const e=this.virtualList.getLastFocusedRow();this.checkAndRefreshVirtualList(),this.onUiChanged(),this.focusRowIfAlive(e)}setMiniFilter(e){this.eMiniFilter.setValue(e),this.onMiniFilterInput()}getMiniFilter(){return this.valueModel?this.valueModel.getMiniFilter():null}checkAndRefreshVirtualList(){if(!this.virtualList)throw new Error("Virtual list has not been created.");this.virtualList.refresh(!this.hardRefreshVirtualList),this.hardRefreshVirtualList&&(this.hardRefreshVirtualList=!1)}getFilterKeys(){return this.valueModel?this.valueModel.getKeys():[]}getFilterValues(){return this.valueModel?this.valueModel.getValues():[]}getValues(){return this.getFilterKeys()}refreshVirtualList(){this.setFilterParams&&this.setFilterParams.refreshValuesOnOpen?this.refreshFilterValues():this.checkAndRefreshVirtualList()}translateForSetFilter(e){return this.localeService.getLocaleTextFunc()(e,Aa[e])}isSelectAllSelected(){if(!this.setFilterParams||!this.valueModel)return!1;if(this.setFilterParams.defaultToNothingSelected){if(this.valueModel.hasSelections()&&this.valueModel.isEverythingVisibleSelected())return!0;if(this.valueModel.isNothingVisibleSelected())return!1}else{if(this.valueModel.hasSelections()&&this.valueModel.isNothingVisibleSelected())return!1;if(this.valueModel.isEverythingVisibleSelected())return!0}}areAllChildrenSelected(e){const t=s=>{if(s.children){let i=!1,r=!1;return s.children.some(l=>{if(!l.filterPasses||!l.available)return!1;const a=t(l);return void 0===a||(a?i=!0:r=!0,i&&r)})?void 0:i}return this.valueModel.isKeySelected(s.key)};return this.setFilterParams.defaultToNothingSelected?this.valueModel.hasSelections()&&t(e):t(e)}destroy(){null!=this.virtualList&&(this.virtualList.destroy(),this.virtualList=null),super.destroy()}caseFormat(e){return null==e||"string"!=typeof e||this.caseSensitive?e:e.toUpperCase()}resetExpansion(){if(!this.setFilterParams?.treeList)return;const e=this.valueModel?.getSelectAllItem();if(this.isSetFilterModelTreeItem(e)){const t=s=>{s.children&&(s.children.forEach(i=>t(i)),s.expanded=!1)};t(e),this.valueModel.updateDisplayedValues("expansion")}}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e,this)}getPositionableElement(){return this.eSetFilterList}},Ia=class{constructor(e){this.model=e}getRowCount(){return this.model.getDisplayedValueCount()}getRow(e){return this.model.getDisplayedItem(e)}areRowsEqual(e,t){return e===t}},La=class{constructor(e,t){this.model=e,this.isSelectAllSelected=t}getRowCount(){const t=this.model.showAddCurrentSelectionToFilter()?2:1;return this.model.getDisplayedValueCount()+t}getRow(e){if(0===e)return this.model.getSelectAllItem();const t=this.model.showAddCurrentSelectionToFilter(),s=t?2:1;return 1===e&&t?this.model.getAddSelectionToFilterItem():this.model.getDisplayedItem(e-s)}areRowsEqual(e,t){return e===t}},ka=class{constructor(e){this.model=e}getRowCount(){return this.model.getRowCount()}getRow(e){return this.model.getRow(e)}areRowsEqual(e,t){return null==e&&null==t||null!=e&&null!=t&&e.treeKey===t.treeKey&&e.depth===t.depth}},ot="32.3.3",Cs=(0,n.n9N)({version:ot,moduleName:`${n.zsj.SetFilterModule}-core`,userComponents:[{name:"agSetColumnFilter",classImp:ms}],dependantModules:[R.bP,n.Sxk]}),Va=(0,n.n9N)({version:ot,moduleName:"@ag-grid-enterprise/set-floating-filter",userComponents:[{name:"agSetColumnFloatingFilter",classImp:class extends n.uAl{constructor(){super('\n            <div class="ag-floating-filter-input ag-set-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eFloatingFilterText"></ag-input-text-field>\n            </div>',[n.n1z]),this.eFloatingFilterText=n.dRA,this.availableValuesListenerAdded=!1,this.filterModelFormatter=new gs}wireBeans(e){this.columnNameService=e.columnNameService}destroy(){super.destroy()}init(e){this.params=e,this.eFloatingFilterText.setDisabled(!0).addGuiEventListener("click",()=>this.params.showParentFilter()),this.setParams(e)}setParams(e){const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),s=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setInputAriaLabel(`${t} ${s("ariaFilterInput","Filter Input")}`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}onParentModelChanged(e){this.updateFloatingFilterText(e)}parentSetFilterInstance(e){this.params.parentFilterInstance(t=>{if(!(t instanceof ms))throw new Error("AG Grid - SetFloatingFilter expects SetFilter as its parent");e(t)})}addAvailableValuesListener(){this.parentSetFilterInstance(e=>{const t=e.getValueModel();t&&this.addManagedListeners(t,{availableValuesChanged:()=>this.updateFloatingFilterText()})}),this.availableValuesListenerAdded=!0}updateFloatingFilterText(e){this.availableValuesListenerAdded||this.addAvailableValuesListener(),this.parentSetFilterInstance(t=>{this.eFloatingFilterText.setValue(this.filterModelFormatter.getModelAsString(e,t))})}}}],dependantModules:[Cs,n.O1X]}),Oa=(0,n.n9N)({version:ot,moduleName:n.zsj.SetFilterModule,dependantModules:[Cs,Va]}),fe=class extends n.uAl{constructor(){super('<div class="ag-status-name-value">\n            <span data-ref="eLabel"></span>:&nbsp;\n            <span data-ref="eValue" class="ag-status-name-value-value"></span>\n        </div>'),this.eLabel=n.dRA,this.eValue=n.dRA}setLabel(e,t){this.setDisplayed(!1);const s=this.localeService.getLocaleTextFunc();this.eLabel.innerHTML=s(e,t)}setValue(e){this.eValue.innerHTML=e}},Ba={selector:"AG-NAME-VALUE",component:fe},ja={selector:"AG-STATUS-BAR",component:class extends n.uAl{constructor(){super('<div class="ag-status-bar">\n            <div data-ref="eStatusBarLeft" class="ag-status-bar-left" role="status"></div>\n            <div data-ref="eStatusBarCenter" class="ag-status-bar-center" role="status"></div>\n            <div data-ref="eStatusBarRight" class="ag-status-bar-right" role="status"></div>\n        </div>'),this.updateQueued=!1,this.panelsPromise=n.oY$.resolve(),this.eStatusBarLeft=n.dRA,this.eStatusBarCenter=n.dRA,this.eStatusBarRight=n.dRA,this.compDestroyFunctions={}}wireBeans(e){this.userComponentFactory=e.userComponentFactory,this.statusBarService=e.statusBarService}postConstruct(){this.processStatusPanels(new Map),this.addManagedPropertyListeners(["statusBar"],this.handleStatusBarChanged.bind(this))}processStatusPanels(e){const t=this.gos.get("statusBar")?.statusPanels;if(t){const s=t.filter(o=>"left"===o.align),i=t.filter(o=>"center"===o.align),r=t.filter(o=>!o.align||"right"===o.align);this.panelsPromise=n.oY$.all([this.createAndRenderComponents(s,this.eStatusBarLeft,e),this.createAndRenderComponents(i,this.eStatusBarCenter,e),this.createAndRenderComponents(r,this.eStatusBarRight,e)])}else this.setDisplayed(!1)}handleStatusBarChanged(){this.updateQueued||(this.updateQueued=!0,this.panelsPromise.then(()=>{this.updateStatusBar(),this.updateQueued=!1}))}updateStatusBar(){const e=this.gos.get("statusBar")?.statusPanels,t=Array.isArray(e)&&e.length>0;this.setDisplayed(t);const s=new Map;t&&e.forEach(i=>{const r=i.key??i.statusPanel,o=this.statusBarService.getStatusPanel(r);if(o?.refresh){const l=this.gos.addGridCommonParams(i.statusPanelParams??{});o.refresh(l)&&(s.set(r,o),delete this.compDestroyFunctions[r],(0,n.MwW)(o.getGui()))}}),this.resetStatusBar(),t&&this.processStatusPanels(s)}resetStatusBar(){this.eStatusBarLeft.innerHTML="",this.eStatusBarCenter.innerHTML="",this.eStatusBarRight.innerHTML="",this.destroyComponents(),this.statusBarService.unregisterAllComponents()}destroy(){this.destroyComponents(),super.destroy()}destroyComponents(){Object.values(this.compDestroyFunctions).forEach(e=>e()),this.compDestroyFunctions={}}createAndRenderComponents(e,t,s){const i=[];return e.forEach(r=>{const o=r.key||r.statusPanel,l=s.get(o);let a;if(l)a=n.oY$.resolve(l);else if(a=this.userComponentFactory.getStatusPanelCompDetails(r,{}).newAgStackInstance(),null==a)return;i.push({key:o,promise:a})}),n.oY$.all(i.map(r=>r.promise)).then(()=>{i.forEach(r=>{r.promise.then(o=>{const l=()=>{this.destroyBean(o)};this.isAlive()?(this.statusBarService.registerStatusPanel(r.key,o),t.appendChild(o.getGui()),this.compDestroyFunctions[r.key]=l):l()})})})}}},nt="32.3.3",vs=(0,n.n9N)({version:nt,moduleName:`${n.zsj.StatusBarModule}-core`,beans:[class extends n.XQb{constructor(){super(),this.beanName="statusBarService",this.allComponents=new Map}registerStatusPanel(e,t){this.allComponents.set(e,t)}unregisterStatusPanel(e){this.allComponents.delete(e)}unregisterAllComponents(){this.allComponents.clear()}getStatusPanel(e){return this.allComponents.get(e)}getStatusPanelSelector(){return ja}destroy(){this.unregisterAllComponents(),super.destroy()}}],userComponents:[{name:"agAggregationComponent",classImp:class extends n.uAl{constructor(){super('<div class="ag-status-panel ag-status-panel-aggregations">\n            <ag-name-value data-ref="avgAggregationComp"></ag-name-value>\n            <ag-name-value data-ref="countAggregationComp"></ag-name-value>\n            <ag-name-value data-ref="minAggregationComp"></ag-name-value>\n            <ag-name-value data-ref="maxAggregationComp"></ag-name-value>\n            <ag-name-value data-ref="sumAggregationComp"></ag-name-value>\n        </div>',[Ba]),this.sumAggregationComp=n.dRA,this.countAggregationComp=n.dRA,this.minAggregationComp=n.dRA,this.maxAggregationComp=n.dRA,this.avgAggregationComp=n.dRA}wireBeans(e){this.valueService=e.valueService,this.cellNavigationService=e.cellNavigationService,this.cellPositionUtils=e.cellPositionUtils,this.rowPositionUtils=e.rowPositionUtils,this.rangeService=e.rangeService}destroy(){super.destroy()}postConstruct(){(0,n.dbY)(this.gos)||(0,n.TiQ)(this.gos)?(this.avgAggregationComp.setLabel("avg","Average"),this.countAggregationComp.setLabel("count","Count"),this.minAggregationComp.setLabel("min","Min"),this.maxAggregationComp.setLabel("max","Max"),this.sumAggregationComp.setLabel("sum","Sum"),this.addManagedEventListeners({cellSelectionChanged:this.onCellSelectionChanged.bind(this),modelUpdated:this.onCellSelectionChanged.bind(this)})):(0,n.JT7)("agAggregationComponent should only be used with the client and server side row model.")}init(e){this.refresh(e)}refresh(e){return this.params=e,this.onCellSelectionChanged(),!0}setAggregationComponentValue(e,t,s){const i=this.getAllowedAggregationValueComponent(e);if((0,n.Qmv)(i)&&i){const r=this.localeService.getLocaleTextFunc(),o=r("thousandSeparator",","),l=r("decimalSeparator",".");i.setValue((0,n.Q0l)(t,o,l)),i.setDisplayed(s)}else this.getAggregationValueComponent(e)?.setDisplayed(!1)}getAllowedAggregationValueComponent(e){const{aggFuncs:t}=this.params;return!t||t.includes(e)?this.getAggregationValueComponent(e):null}getAggregationValueComponent(e){return this[`${e}AggregationComp`]}onCellSelectionChanged(){const e=this.rangeService?.getCellRanges();let t=0,s=0,i=0,r=null,o=null;const l={};if(e&&!(0,n.Wgl)(e)&&this.rangeService)for(let u=0;u<e.length;u++){const h=e[u];let c=this.rangeService.getRangeStartRow(h);const p=this.rangeService.getRangeEndRow(h);for(;!(0,n.MWY)(c)&&c&&!this.rowPositionUtils.before(p,c)&&c&&h.columns;)h.columns.forEach(f=>{if(null===c)return;const v=this.cellPositionUtils.createId({rowPinned:c.rowPinned,column:f,rowIndex:c.rowIndex});if(l[v])return;l[v]=!0;const y=this.rowPositionUtils.getRowNode(c);if((0,n.MWY)(y))return;let C=this.valueService.getValue(f,y);(0,n.MWY)(C)||""===C||(s++,("object"!=typeof C||!("value"in C)||(C=C.value,""!==C))&&("string"==typeof C&&(C=Number(C)),"number"==typeof C&&!isNaN(C)&&(t+=C,(null===o||C>o)&&(o=C),(null===r||C<r)&&(r=C),i++)))}),c=this.cellNavigationService.getRowBelow(c)}const d=i>1;this.setAggregationComponentValue("count",s,s>1),this.setAggregationComponentValue("sum",t,d),this.setAggregationComponentValue("min",r,d),this.setAggregationComponentValue("max",o,d),this.setAggregationComponentValue("avg",t/i,d)}}},{name:"agSelectedRowCountComponent",classImp:class extends fe{wireBeans(e){this.selectionService=e.selectionService}postConstruct(){if(!(0,n.dbY)(this.gos)&&!(0,n.TiQ)(this.gos))return void(0,n.JT7)("agSelectedRowCountComponent should only be used with the client and server side row model.");this.setLabel("selectedRows","Selected"),this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-selected-row-count"),this.onRowSelectionChanged();const e=this.onRowSelectionChanged.bind(this);this.addManagedEventListeners({modelUpdated:e,selectionChanged:e})}onRowSelectionChanged(){const e=this.selectionService.getSelectionCount();if(e<0)return this.setValue("?"),void this.setDisplayed(!0);const t=this.localeService.getLocaleTextFunc(),s=t("thousandSeparator",","),i=t("decimalSeparator",".");this.setValue((0,n.wdz)(e,s,i)),this.setDisplayed(e>0)}init(){}refresh(){return!0}destroy(){super.destroy()}}},{name:"agTotalRowCountComponent",classImp:class extends fe{wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.setLabel("totalRows","Total Rows"),(0,n.dbY)(this.gos)?(this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-total-row-count"),this.setDisplayed(!0),this.addManagedEventListeners({modelUpdated:this.onDataChanged.bind(this)}),this.onDataChanged()):(0,n.JT7)("agTotalRowCountComponent should only be used with the client side row model.")}onDataChanged(){const e=this.localeService.getLocaleTextFunc(),t=e("thousandSeparator",","),s=e("decimalSeparator",".");this.setValue((0,n.wdz)(this.getRowCountValue(),t,s))}getRowCountValue(){let e=0;return this.rowModel.forEachLeafNode(()=>e+=1),e}init(){}refresh(){return!0}destroy(){super.destroy()}}},{name:"agFilteredRowCountComponent",classImp:class extends fe{wireBeans(e){this.rowModel=e.rowModel}postConstruct(){if(this.setLabel("filteredRows","Filtered"),!(0,n.dbY)(this.gos))return void(0,n.JT7)("agFilteredRowCountComponent should only be used with the client side row model.");this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-filtered-row-count"),this.setDisplayed(!0);const e=this.onDataChanged.bind(this);this.addManagedEventListeners({modelUpdated:e}),e()}onDataChanged(){const e=this.getTotalRowCountValue(),t=this.getFilteredRowCountValue(),s=this.localeService.getLocaleTextFunc(),i=s("thousandSeparator",","),r=s("decimalSeparator",".");this.setValue((0,n.wdz)(t,i,r)),this.setDisplayed(e!==t)}getTotalRowCountValue(){let e=0;return this.rowModel.forEachNode(()=>e+=1),e}getFilteredRowCountValue(){let e=0;return this.rowModel.forEachNodeAfterFilter(t=>{t.group||(e+=1)}),e}init(){}refresh(){return!0}destroy(){super.destroy()}}},{name:"agTotalAndFilteredRowCountComponent",classImp:class extends fe{wireBeans(e){this.rowModel=e.rowModel}postConstruct(){(0,n.dbY)(this.gos)?(this.setLabel("totalAndFilteredRows","Rows"),this.addCssClass("ag-status-panel"),this.addCssClass("ag-status-panel-total-and-filtered-row-count"),this.setDisplayed(!0),this.addManagedEventListeners({modelUpdated:this.onDataChanged.bind(this)}),this.onDataChanged()):(0,n.JT7)("agTotalAndFilteredRowCountComponent should only be used with the client side row model.")}onDataChanged(){const e=this.localeService.getLocaleTextFunc(),t=e("thousandSeparator",","),s=e("decimalSeparator","."),i=(0,n.wdz)(this.getFilteredRowCountValue(),t,s),r=(0,n.wdz)(this.getTotalRowCount(),t,s);if(i===r)this.setValue(i);else{const o=this.localeService.getLocaleTextFunc();this.setValue(`${i} ${o("of","of")} ${r}`)}}getFilteredRowCountValue(){let e=0;return this.rowModel.forEachNodeAfterFilter(t=>{t.group||e++}),e}getTotalRowCount(){let e=0;return this.rowModel.forEachNode(t=>{t.group||e++}),e}init(){}refresh(){return!0}destroy(){super.destroy()}}}],dependantModules:[R.bP]}),Ya=(0,n.n9N)({version:nt,moduleName:`${n.zsj.StatusBarModule}-api`,apiFunctions:{getStatusPanel:function $a(e,t){const s=e.statusBarService.getStatusPanel(t);return(0,n.nnr)(s)}},dependantModules:[vs]}),Qa=(0,n.n9N)({version:nt,moduleName:n.zsj.StatusBarModule,dependantModules:[vs,Ya]}),Ss=class extends n.XQb{constructor(){super(...arguments),this.loadRowDataVersion=0}wireBeans(e){this.focusService=e.focusService,this.rowPositionUtils=e.rowPositionUtils,this.environment=e.environment}init(e,t){this.params=t,this.comp=e,null==t.pinned&&(this.setAutoHeightClasses(),this.setupRefreshStrategy(),this.addThemeToDetailGrid(),this.createDetailGrid(),this.loadRowData(),this.addManagedEventListeners({fullWidthRowFocused:this.onFullWidthRowFocused.bind(this)}))}onFullWidthRowFocused(e){const t=this.params;this.rowPositionUtils.sameRow({rowIndex:t.node.rowIndex,rowPinned:t.node.rowPinned},{rowIndex:e.rowIndex,rowPinned:e.rowPinned})&&this.focusService.focusInto(this.comp.getGui(),e.fromBelow)}setAutoHeightClasses(){const e=this.gos.get("detailRowAutoHeight"),s=e?"ag-details-grid-auto-height":"ag-details-grid-fixed-height";this.comp.addOrRemoveCssClass(e?"ag-details-row-auto-height":"ag-details-row-fixed-height",!0),this.comp.addOrRemoveDetailGridCssClass(s,!0)}setupRefreshStrategy(){const e=this.params.refreshStrategy;"everything"!=e&&"nothing"!=e&&"rows"!=e?(null!=e&&(0,n.JT7)("invalid cellRendererParams.refreshStrategy = '"+e+"' supplied, defaulting to refreshStrategy = 'rows'."),this.refreshStrategy="rows"):this.refreshStrategy=e}addThemeToDetailGrid(){for(const e of this.environment.getThemeClasses())this.comp.addOrRemoveDetailGridCssClass(e,!0)}createDetailGrid(){if((0,n.MWY)(this.params.detailGridOptions))return void(0,n.JT7)("could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions");const e={...this.params.detailGridOptions};this.gos.get("detailRowAutoHeight")&&(e.domLayout="autoHeight"),e.theme||(e.theme=this.gos.get("theme")),this.comp.setDetailGrid(e)}registerDetailWithMaster(e){const t=this.params.node.id,s=this.params.api,i={id:t,api:e},r=this.params.node;s.isDestroyed()||(s.addDetailGridInfo(t,i),r.detailGridInfo=i,this.addDestroyFunc(()=>{r.detailGridInfo===i&&(s.isDestroyed()||s.removeDetailGridInfo(t),r.detailGridInfo=null)}))}loadRowData(){this.loadRowDataVersion++;const e=this.loadRowDataVersion;if("serverSide"===this.params.detailGridOptions?.rowModelType)return void this.params.node.detailGridInfo?.api?.refreshServerSide({purge:!0});const t=this.params.getDetailRowData;t?t({node:this.params.node,data:this.params.node.data,successCallback:r=>{this.loadRowDataVersion===e&&this.comp.setRowData(r)},context:this.gos.getGridCommonParams().context}):(0,n.JT7)("could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData")}refresh(){switch(this.refreshStrategy){case"nothing":return!0;case"everything":return!1}return this.loadRowData(),!0}},Ja=class{constructor(e){this.parentWrapper=e}wrap(e,t,s,i){return this.parentWrapper.wrap(e,t,s,i)}},lt="32.3.3",ws=(0,n.n9N)({version:lt,moduleName:`${n.zsj.MasterDetailModule}-core`,userComponents:[{name:"agGroupRowRenderer",classImp:R.H_},{name:"agGroupCellRenderer",classImp:R.H_},{name:"agDetailCellRenderer",classImp:class extends n.uAl{constructor(){super(...arguments),this.eDetailGrid=n.dRA}wireBeans(e){this.context=e.context}init(e){this.params=e,this.selectAndSetTemplate();const t={addOrRemoveCssClass:(s,i)=>this.addOrRemoveCssClass(s,i),addOrRemoveDetailGridCssClass:(s,i)=>this.eDetailGrid.classList.toggle(s,i),setDetailGrid:s=>this.setDetailGrid(s),setRowData:s=>this.setRowData(s),getGui:()=>this.eDetailGrid};this.ctrl=this.createManagedBean(new Ss),this.ctrl.init(t,e)}refresh(){return this.ctrl&&this.ctrl.refresh()}destroy(){super.destroy()}selectAndSetTemplate(){if(this.params.pinned)return void this.setTemplate('<div class="ag-details-row"></div>');const e=()=>{this.setTemplate('<div class="ag-details-row" role="gridcell">\n                <div data-ref="eDetailGrid" class="ag-details-grid" role="presentation"></div>\n            </div>')};if((0,n.MWY)(this.params.template))e();else if("string"==typeof this.params.template)this.setTemplate(this.params.template,[]);else if("function"==typeof this.params.template){const s=(0,this.params.template)(this.params);this.setTemplate(s,[])}else(0,n.JT7)("detailCellRendererParams.template should be function or string"),e();null==this.eDetailGrid&&(0,n.JT7)('Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.')}setDetailGrid(e){if(!this.eDetailGrid)return;const t=this.context.getBean("frameworkComponentWrapper"),s=new Ja(t),i=this.getFrameworkOverrides(),r=(0,n.Dvw)(this.eDetailGrid,e,{frameworkOverrides:i,providedBeanInstances:{frameworkComponentWrapper:s},modules:n.syG.__getGridRegisteredModules(this.params.api.getGridId())});this.detailApi=r,this.ctrl.registerDetailWithMaster(r),this.addDestroyFunc(()=>{r?.destroy()})}setRowData(e){this.detailApi&&this.detailApi.setGridOption("rowData",e)}}}],controllers:[{name:"detailCellRenderer",classImp:Ss},{name:"groupCellRendererCtrl",classImp:R.ih}],dependantModules:[R.bP]}),rd=(0,n.n9N)({version:lt,moduleName:`${n.zsj.MasterDetailModule}-api`,beans:[class extends n.XQb{constructor(){super(...arguments),this.beanName="detailGridApiService",this.detailGridInfoMap={}}addDetailGridInfo(e,t){this.detailGridInfoMap[e]=t}removeDetailGridInfo(e){delete this.detailGridInfoMap[e]}getDetailGridInfo(e){return this.detailGridInfoMap[e]}forEachDetailGridInfo(e){let t=0;(0,n.RhE)(this.detailGridInfoMap,(s,i)=>{(0,n.Qmv)(i)&&(e(i,t),t++)})}destroy(){this.detailGridInfoMap={},super.destroy()}}],apiFunctions:{addDetailGridInfo:function ed(e,t,s){e.detailGridApiService?.addDetailGridInfo(t,s)},removeDetailGridInfo:function td(e,t){e.detailGridApiService?.removeDetailGridInfo(t)},getDetailGridInfo:function sd(e,t){return e.detailGridApiService?.getDetailGridInfo(t)},forEachDetailGridInfo:function id(e,t){e.detailGridApiService?.forEachDetailGridInfo(t)}},dependantModules:[ws]}),od=(0,n.n9N)({version:lt,moduleName:n.zsj.MasterDetailModule,dependantModules:[ws,rd]}),ys=class extends n.yGC{constructor(){super('<div class="ag-cell-edit-wrapper"></div>')}init(e){this.params=e;const{cellStartedEdit:t,values:s}=e;(0,n.MWY)(s)&&(0,n.JT7)("agRichSelectCellEditor requires cellEditorParams.values to be set");const{params:i,valuesPromise:r}=this.buildRichSelectParams();this.richSelect=this.createManagedBean(new R.pN(i)),this.richSelect.addCssClass("ag-cell-editor"),this.appendChild(this.richSelect),r&&r.then(o=>{this.richSelect.setValueList({valueList:o,refresh:!0});const l=this.getSearchStringCallback(o);l&&this.richSelect.setSearchStringCreator(l)}),this.addManagedListeners(this.richSelect,{fieldPickerValueSelected:this.onEditorPickerValueSelected.bind(this)}),this.focusAfterAttached=t}onEditorPickerValueSelected(e){setTimeout(()=>this.params.stopEditing(!e.fromEnterKey))}buildRichSelectParams(){const{cellRenderer:e,cellHeight:t,value:s,values:i,formatValue:r,searchDebounceDelay:o,valueListGap:l,valueListMaxHeight:a,valueListMaxWidth:d,allowTyping:u,filterList:h,searchType:c,highlightMatch:p,valuePlaceholder:g,eventKey:f,multiSelect:v,suppressDeselectAll:y,suppressMultiSelectPillRenderer:C}=this.params,S={value:s,cellRenderer:e,cellRowHeight:t,searchDebounceDelay:o,valueFormatter:r,pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"virtual-list",pickerGap:l,allowTyping:u,filterList:h,searchType:c,highlightMatch:p,maxPickerHeight:a,maxPickerWidth:d,placeholder:g,initialInputValue:1===f?.length?f:void 0,multiSelect:v,suppressDeselectAll:y,suppressMultiSelectPillRenderer:C};let w,x;return w="function"==typeof i?i(this.params):i??[],Array.isArray(w)?(S.valueList=w,S.searchStringCreator=this.getSearchStringCallback(w)):x=w,v&&u&&(this.params.allowTyping=S.allowTyping=!1,(0,n.JT7)("agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.")),{params:S,valuesPromise:x}}getSearchStringCallback(e){const{colDef:t}=this.params;if("object"==typeof e[0]&&t.keyCreator)return s=>s.map(i=>{const r=this.gos.addGridCommonParams({value:i,colDef:this.params.colDef,column:this.params.column,node:this.params.node,data:this.params.data});return t.keyCreator(r)})}afterGuiAttached(){const{focusAfterAttached:e,params:t}=this;setTimeout(()=>{if(!this.isAlive())return;if(e){const i=this.richSelect.getFocusableElement();i.focus();const{allowTyping:r,eventKey:o}=this.params;r&&(!o||1!==o.length)&&i.select()}this.richSelect.showPicker();const{eventKey:s}=t;s&&1===s?.length&&this.richSelect.searchTextFromString(s)})}focusIn(){this.richSelect.getFocusableElement().focus()}getValue(){return this.richSelect.getValue()}isPopup(){return!1}},ld=(0,n.n9N)({version:"32.3.3",moduleName:n.zsj.RichSelectModule,beans:[],userComponents:[{name:"agRichSelect",classImp:ys},{name:"agRichSelectCellEditor",classImp:ys}],dependantModules:[R.bP,n.hyn]}),at=P(3914),b=P(4438),ad=P(6160);const dd=["grid"];let ud=(()=>{class e extends Q.oV{constructor(s,i){super(),this.cd=i,this.gridSettings={useFlatPickrDatePicker:!0,animateGridRows:!0,highlightSearchResultsText:!0,displayDateFormat:at.Em.MM_DD_YYYY},this.modules=[ks,R.bP,oi,jr,$l,ql,ma,Ma,Oa,Xe,Qa,od,ld],this.gridOptions={rowSelection:{mode:"singleRow",checkboxes:!1},getRowId:r=>r.data.id,onGridReady:()=>this.initGrid()},this.colDefs=[],this.createColumns()}ngOnInit(){}ngAfterViewInit(){super.ngAfterViewInit(),this.cd.markForCheck()}initGrid(){this.grid?.api?.setGridOption("rowData",[{id:"1",name:"Testing 123",date:new Date}])}createColumns(){let s=new Q.Jz(this.getGridName(),this.gridSettings);s.addColumn("Name","name",200).addColumn("Date","date",200,Q.Jz.DATE_FILTER),s.addCellRenderer("date",i=>at.Em.convert(i.data.date,at.Em.MM_DD_YYYY)),s.getAllColumnIds().forEach(i=>{s.addCellClassRule(i,"stringSearchMatchedCell",r=>Q.fv.hookCellCssRule(r,this.getGridId()))}),this.colDefs=s.getColumns()}doRefresh(){}getGridName(){return"agTestGrid"}hookObservables(){}nodeSelectedFromRightClick(s){}selectionChanged(s){}cellClicked(s){}getGrid(){return this.grid}getGridSettings(){return this.gridSettings}static{this.\u0275fac=function(i){return new(i||e)(b.rXU("WEB_FONTS"),b.rXU(b.gRc))}}static{this.\u0275cmp=b.VBU({type:e,selectors:[["BasicGrid"]],viewQuery:function(i,r){if(1&i&&b.GBs(dd,5),2&i){let o;b.mGM(o=b.lsd())&&(r.grid=o.first)}},features:[b.Jv_([]),b.Vt3],decls:4,vars:4,consts:[["grid",""],[2,"width","1000px","height","200px"],[1,"ag-theme-alpine-dark",2,"width","100%","height","100%",3,"selectionChanged","cellClicked","id","gridOptions","modules","columnDefs"]],template:function(i,r){if(1&i){const o=b.RV6();b.j41(0,"div",1)(1,"InlineSearchableGrid")(2,"ag-grid-angular",2,0),b.bIt("selectionChanged",function(a){return b.eBV(o),b.Njj(r.selectionChanged(a))})("cellClicked",function(a){return b.eBV(o),b.Njj(r.cellClicked(a))}),b.k0s()()()}2&i&&(b.R7$(2),b.Y8G("id",r.getGridId())("gridOptions",r.gridOptions)("modules",r.modules)("columnDefs",r.colDefs))},dependencies:[Q.a,ad.xs],encapsulation:2,changeDetection:0})}}return e})()}}]);